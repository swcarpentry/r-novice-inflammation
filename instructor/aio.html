<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Programming with R: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/swc/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicons/swc/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicons/swc/favicon-16x16.png">
<link rel="manifest" href="../favicons/swc/site.webmanifest">
<link rel="mask-icon" href="../favicons/swc/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav software"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="swc-logo" alt="Software Carpentry" src="../assets/images/software-logo.svg">
</div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav software" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Software Carpentry" src="../assets/images/software-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Programming with R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Programming with R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Basic Operation</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Programming with R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress software">
    <div class="progress-bar software" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-starting-with-data.html">1. Analyzing Patient Data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-func-R.html">2. Creating Functions</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-loops-R.html">3. Analyzing Multiple Data Sets</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-cond.html">4. Making Choices</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-cmdline.html">5. Command-Line Programs</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-best-practices-R.html">6. Best Practices for Writing R Code</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-knitr-R.html">7. Dynamic Reports with knitr</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-making-packages-R.html">8. Making Packages in R</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-supp-intro-rstudio.html">9. Introduction to RStudio</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-supp-addressing-data.html">10. Addressing Data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="11-supp-read-write-csv.html">11. Reading and Writing CSV Files</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="12-supp-factors.html">12. Understanding Factors</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="13-supp-data-structures.html">13. Data Types and Structures</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="14-supp-call-stack.html">14. The Call Stack</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="15-supp-loops-in-depth.html">15. Loops in R</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Basic Operation</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-starting-with-data"><p>Content from <a href="01-starting-with-data.html">Analyzing Patient Data</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/01-starting-with-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 55 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I read data into R?</li>
<li>How do I assign variables?</li>
<li>What is a data frame?</li>
<li>How do I access subsets of a data frame?</li>
<li>How do I calculate simple statistics like mean and median?</li>
<li>Where can I get help?</li>
<li>How can I plot my data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Read tabular data from a file into a program.</li>
<li>Assign values to variables.</li>
<li>Select individual values and subsections from data.</li>
<li>Perform operations on a data frame of data.</li>
<li>Display simple graphs.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We are studying inflammation in patients who have been given a new
treatment for arthritis, and need to analyze the first dozen data sets
(here is a link to <a href="../data/r-novice-inflammation-data.zip">download the data for this
lesson</a>). The data sets are stored in <a href="reference.html#comma-separated-values-csv">comma-separated
values</a> (CSV) format. Each row holds the observations for just one
patient. Each column holds the inflammation measured in a day, so we
have a set of values in successive days. The first few rows of our first
file look like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0,0,1,3,1,2,4,7,8,3,3,3,10,5,7,4,7,7,12,18,6,13,11,11,7,7,4,6,8,8,4,4,5,7,3,4,2,3,0,0
0,1,2,1,2,1,3,2,2,6,10,11,5,9,4,4,7,16,8,6,18,4,12,5,12,7,11,5,11,3,3,5,4,4,5,5,1,1,0,1
0,1,1,3,3,2,6,2,5,9,5,7,4,5,4,15,5,11,9,10,19,14,12,17,7,12,11,7,4,2,10,5,4,2,2,3,2,2,1,1
0,0,2,0,4,2,2,1,6,7,10,7,9,13,8,8,15,10,10,7,17,4,4,7,6,15,6,4,9,11,3,5,6,3,3,4,2,3,2,1
0,1,1,3,3,1,3,5,2,4,4,7,6,5,3,10,8,10,6,17,9,14,9,7,13,9,12,6,7,7,9,6,3,2,2,4,2,0,1,1</code></pre>
</div>
<p>We want to:</p>
<ul>
<li>Load data into memory,</li>
<li>Calculate the average value of inflammation per day across all
patients, and</li>
<li>Plot the results.</li>
</ul>
<p>To do all that, we’ll have to learn a little bit about
programming.</p>
<section><h2 class="section-heading" id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<hr class="half-width">
<p>Since we want to import the file called
<code>inflammation-01.csv</code> into our R environment, we need to be
able to tell our computer where the file is. To do this, we will create
a “Project” with RStudio that contains the data we want to work with.
The “Projects” interface in RStudio not only creates a working directory
for you, but also remembers its location (allowing you to quickly
navigate to it). The interface also (optionally) preserves custom
settings and open files to make it easier to resume work after a
break.</p>
<div class="section level3">
<h3 id="create-a-new-project">Create a new project<a class="anchor" aria-label="anchor" href="#create-a-new-project"></a>
</h3>
<ul>
<li>Under the <code>File</code> menu in RStudio, click on
<code>New project</code>, choose <code>New directory</code>, then
<code>New project</code>
</li>
<li>Enter a name for this new folder (or “directory”) and choose a
convenient location for it. This will be your <strong>working
directory</strong> for the rest of the day (e.g.,
<code>~/Desktop/r-novice-inflammation</code>).</li>
<li>Click on <code>Create project</code>
</li>
<li>Create a new file where we will type our scripts. Go to File &gt;
New File &gt; R script. Click the save icon on your toolbar and save
your script as “<code>script.R</code>”.</li>
<li>Make sure you copy the data for the lesson into this folder, if
they’re not there already.</li>
</ul>
</div>
<div class="section level3">
<h3 id="loading-data">Loading Data<a class="anchor" aria-label="anchor" href="#loading-data"></a>
</h3>
<p>Now that we are set up with an Rstudio project, we are sure that the
data and scripts we are using are all in our working directory. The data
files should be located in the directory <code>data</code>, inside the
working directory. Now we can load the data into R using
<code>read.csv</code>:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/inflammation-01.csv"</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>The expression <code>read.csv(...)</code> is a <a href="reference.html#function-call">function call</a> that asks R to run
the function <code>read.csv</code>.</p>
<p><code>read.csv</code> has two <a href="reference.html#argument">arguments</a>: the name of the file we
want to read, and whether the first line of the file contains names for
the columns of data. The filename needs to be a character string (or <a href="reference.html#string">string</a>for short), so we put it in
quotes. Assigning the second argument, <code>header</code>, to be
<code>FALSE</code> indicates that the data file does not have column
headers. We’ll talk more about the value <code>FALSE</code>, and its
converse <code>TRUE</code>, in lesson 04. In case of our
<code>inflammation-01.csv</code> example, R auto-generates column names
in the sequence <code>V1</code> (for “variable 1”), <code>V2</code>, and
so on, until <code>V40</code>.</p>
<div id="other-options-for-reading-csv-files" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="other-options-for-reading-csv-files" class="callout-inner">
<h3 class="callout-title">Other Options for Reading CSV Files</h3>
<div class="callout-content">
<p><code>read.csv</code> actually has many more arguments that you may
find useful when importing your own data in the future. You can learn
more about these options in this supplementary <a href="11-supp-read-write-csv.html">lesson</a>.</p>
</div>
</div>
</div>
<div id="loading-data-with-headers" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="loading-data-with-headers" class="callout-inner">
<h3 class="callout-title">Loading Data with Headers</h3>
<div class="callout-content">
<p>What happens if you forget to put <code>header = FALSE</code>? The
default value is <code>header = TRUE</code>, which you can check with
<code>?read.csv</code> or <code>help(read.csv)</code>. What do you
expect will happen if you leave the default value of
<code>header</code>? Before you run any code, think about what will
happen to the first few rows of your data frame, and its overall size.
Then run the following code and see if your expectations agree:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/inflammation-01.csv"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>R will construct column headers from values in your first row of
data, resulting in <code>X0 X0.1 X1 X3 X1.1 X2 ...</code>.</p>
<p>Note that the character <code>X</code> is prepended: a standalone
number would not be a valid variable name. Because column headers are
variables, the same naming rules apply. Appending <code>.1</code>,
<code>.2</code> etc. is necessary to avoid duplicate column headers.</p>
</div>
</div>
</div>
</div>
<div id="reading-different-decimal-point-formats" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="reading-different-decimal-point-formats" class="callout-inner">
<h3 class="callout-title">Reading Different Decimal Point Formats</h3>
<div class="callout-content">
<p>Depending on the country you live in, your standard can use the “dot”
or the “comma” as decimal mark. Also, different devices or software can
generate data with different kinds of decimal marks. Take a look at
<code>?read.csv</code> and write the code to load a file called
<code>commadec.txt</code> that has numeric values with commas as decimal
mark, separated by semicolons.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/commadec.txt"</span>, sep <span class="op">=</span> <span class="st">";"</span>, dec <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span></code></pre>
</div>
<p>or the built-in shortcut:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">read.csv2</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/commadec.txt"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>A function will perform its given action on whatever value is passed
to the argument(s). For example, in this case if we provided the name of
a different file to the argument <code>file</code>,
<code>read.csv</code> would read that instead. We’ll learn more about
the details of functions and their arguments in the next lesson.</p>
<p>Since we didn’t tell it to do anything else with the function’s
output, the console will display the full contents of the file
<code>inflammation-01.csv</code>. Try it out.</p>
<p><code>read.csv</code> reads the file, but we can’t use the data
unless we assign it to a variable. We can think of a variable as a
container with a name, such as <code>x</code>,
<code>current_temperature</code>, or <code>subject_id</code> that
contains one or more values. We can create a new variable and assign a
value to it using <code>&lt;-</code>.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_kg</span> <span class="op">&lt;-</span> <span class="fl">55</span></span></code></pre>
</div>
<p>Once a variable is created, we can use the variable name to refer to
the value it was assigned. The variable name now acts as a tag. Whenever
R reads that tag (<code>weight_kg</code>), it substitutes the value
(<code>55</code>).</p>
<figure><img src="../fig/tag-variables.svg" alt="Variables as Tags" class="figure mx-auto d-block"></figure><p>To see the value of a variable, we can print it by typing the name of
the variable and hitting <kbd>CTRL + Return</kbd> (or <kbd>CTRL +
Enter</kbd>) while working in the “<code>script.R</code>” file in the
editor which is recommended. If we are working in the console directly,
we need to hit<kbd>Return</kbd> (or <kbd>Enter</kbd>). In general, R
will print to the console any object returned by a function or operation
<em>unless</em> we assign it to a variable.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_kg</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 55</code></pre>
</div>
<p>We can treat our variable like a regular number, and do arithmetic
with it:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># weight in pounds:</span></span>
<span><span class="fl">2.2</span> <span class="op">*</span> <span class="va">weight_kg</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 121</code></pre>
</div>
<figure><img src="../fig/arithmetic-variables.svg" alt="Variables as Tags" class="figure mx-auto d-block"></figure><div id="commenting" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="commenting" class="callout-inner">
<h3 class="callout-title">Commenting</h3>
<div class="callout-content">
<p>We can add comments to our code using the <code>#</code> character.
It is useful to document our code in this way so that others (and us the
next time we read it) have an easier time following what the code is
doing.</p>
</div>
</div>
</div>
<p>We can also change a variable’s value by assigning it a new
value:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_kg</span> <span class="op">&lt;-</span> <span class="fl">57.5</span></span>
<span><span class="co"># weight in kilograms is now</span></span>
<span><span class="va">weight_kg</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 57.5</code></pre>
</div>
<div id="variable-naming-conventions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="variable-naming-conventions" class="callout-inner">
<h3 class="callout-title">Variable Naming Conventions</h3>
<div class="callout-content">
<p>Historically, R programmers have used a variety of conventions for
naming variables. The <code>.</code> character in R can be a valid part
of a variable name; thus the above assignment could have easily been
<code>weight.kg &lt;- 57.5</code>. This is often confusing to R
newcomers who have programmed in languages where <code>.</code> has a
more significant meaning. Today, most R programmers 1) start variable
names with lower case letters, 2) separate words in variable names with
underscores, and 3) use only lowercase letters, underscores, and numbers
in variable names. The<em>Tidyverse Style Guide</em> includes a <a href="https://style.tidyverse.org/syntax.html" class="external-link">section</a> on this and
other style considerations.</p>
</div>
</div>
</div>
<figure><img src="../fig/reassign-variables.svg" alt="Reassigning Variables" class="figure mx-auto d-block"></figure><p>Assigning a new value to a variable breaks the connection with the
old value; R forgets that number and applies the variable name to the
new value.</p>
<p>When you assign a value to a variable, R only stores the value, not
the calculation you used to create it. This is an important point if
you’re used to the way a spreadsheet program automatically updates
linked cells. Let’s look at an example.</p>
<p>First, we’ll convert <code>weight_kg</code> into pounds, and store
the new value in the variable <code>weight_lb</code>:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_lb</span> <span class="op">&lt;-</span> <span class="fl">2.2</span> <span class="op">*</span> <span class="va">weight_kg</span></span>
<span><span class="co"># weight in kg...</span></span>
<span><span class="va">weight_kg</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 57.5</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ...and in pounds</span></span>
<span><span class="va">weight_lb</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 126.5</code></pre>
</div>
<p>In words, we’re asking R to look up the value we tagged
<code>weight_kg</code>, multiply it by 2.2, and tag the result with the
name <code>weight_lb</code>:</p>
<figure><img src="../fig/new-variables.svg" alt="Creating Another Variable" class="figure mx-auto d-block"></figure><p>If we now change the value of <code>weight_kg</code>:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight_kg</span> <span class="op">&lt;-</span> <span class="fl">100.0</span></span>
<span><span class="co"># weight in kg now...</span></span>
<span><span class="va">weight_kg</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 100</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ...and weight in pounds still</span></span>
<span><span class="va">weight_lb</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 126.5</code></pre>
</div>
<figure><img src="../fig/memory-variables.svg" alt="Updating a Variable" class="figure mx-auto d-block"></figure><p>Since <code>weight_lb</code> doesn’t “remember” where its value came
from, it isn’t automatically updated when <code>weight_kg</code>
changes. This is different from the way spreadsheets work.</p>
<div id="printing-with-parentheses" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="printing-with-parentheses" class="callout-inner">
<h3 class="callout-title">Printing with Parentheses</h3>
<div class="callout-content">
<p>An alternative way to print the value of a variable is to use
<code>(</code> parentheses <code>)</code> around the assignment
statement. As an example:
<code>(total_weight &lt;- weight_kg*2.2 + weight_lb)</code> adds the
values of <code>weight_kg*2.2</code> and <code>weight_lb</code>, assigns
the result to the <code>total_weight</code>, and finally prints the
assigned value of the variable <code>total_weight</code>.</p>
</div>
</div>
</div>
<p>Now that we know how to assign things to variables, let’s re-run
<code>read.csv</code> and save its result into a variable called
<code>dat</code>:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/inflammation-01.csv"</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>This statement doesn’t produce any output because the assignment
doesn’t display anything. If we want to check if our data has been
loaded, we can print the variable’s value by typing the name of the
variable <code>dat</code>. However, for large data sets it is convenient
to use the function<code>head</code> to display only the first few rows
of data.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  V1 V2 V3 V4 V5 V6 V7 V8 V9 V10 V11 V12 V13 V14 V15 V16 V17 V18 V19 V20 V21
1  0  0  1  3  1  2  4  7  8   3   3   3  10   5   7   4   7   7  12  18   6
2  0  1  2  1  2  1  3  2  2   6  10  11   5   9   4   4   7  16   8   6  18
3  0  1  1  3  3  2  6  2  5   9   5   7   4   5   4  15   5  11   9  10  19
4  0  0  2  0  4  2  2  1  6   7  10   7   9  13   8   8  15  10  10   7  17
5  0  1  1  3  3  1  3  5  2   4   4   7   6   5   3  10   8  10   6  17   9
6  0  0  1  2  2  4  2  1  6   4   7   6   6   9   9  15   4  16  18  12  12
  V22 V23 V24 V25 V26 V27 V28 V29 V30 V31 V32 V33 V34 V35 V36 V37 V38 V39 V40
1  13  11  11   7   7   4   6   8   8   4   4   5   7   3   4   2   3   0   0
2   4  12   5  12   7  11   5  11   3   3   5   4   4   5   5   1   1   0   1
3  14  12  17   7  12  11   7   4   2  10   5   4   2   2   3   2   2   1   1
4   4   4   7   6  15   6   4   9  11   3   5   6   3   3   4   2   3   2   1
5  14   9   7  13   9  12   6   7   7   9   6   3   2   2   4   2   0   1   1
6   5  18   9   5   3  10   3  12   7   8   4   7   3   5   4   4   3   2   1</code></pre>
</div>
<div id="assigning-values-to-variables" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="assigning-values-to-variables" class="callout-inner">
<h3 class="callout-title">Assigning Values to Variables</h3>
<div class="callout-content">
<p>Draw diagrams showing what variables refer to what values after each
statement in the following program:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fl">47.5</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">122</span></span>
<span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="va">mass</span> <span class="op">*</span> <span class="fl">2.0</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">-</span> <span class="fl">20</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fl">47.5</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">122</span></span></code></pre>
</div>
<figure><img src="../fig/mass-age-assign-1.svg" alt="Assigning Variables" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="va">mass</span> <span class="op">*</span> <span class="fl">2.0</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">-</span> <span class="fl">20</span></span></code></pre>
</div>
<figure><img src="../fig/mass-age-assign-2.svg" alt="Assigning Variables" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="manipulating-data">Manipulating Data<a class="anchor" aria-label="anchor" href="#manipulating-data"></a>
</h2>
<hr class="half-width">
<p>Now that our data are loaded into R, we can start doing things with
them. First, let’s ask what type of thing <code>dat</code> is:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "data.frame"</code></pre>
</div>
<p>The output tells us that it’s a data frame. Think of this structure
as a spreadsheet in MS Excel that many of us are familiar with. Data
frames are very useful for storing data and you will use them frequently
when programming in R. A typical data frame of experimental data
contains individual observations in rows and variables in columns.</p>
<p>We can see the shape, or <a href="reference.html#dimensions-of-an-array">dimensions</a>, of the data
frame with the function <code>dim</code>:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 60 40</code></pre>
</div>
<p>This tells us that our data frame, <code>dat</code>, has 60 rows and
40 columns.</p>
<p>If we want to get a single value from the data frame, we can provide
an <a href="reference.html#index">index</a>in square brackets. The first
number specifies the row and the second the column:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first value in dat, row 1, column 1</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># middle value in dat, row 30, column 20</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="fl">30</span>, <span class="fl">20</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 16</code></pre>
</div>
<p>The first value in a data frame index is the row, the second value is
the column. If we want to select more than one row or column, we can use
the function <code>c</code>, which <strong>c</strong>ombines the values
you give it into one vector or list. For example, to pick columns 10 and
20 from rows 1, 3, and 5, we can do this:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  V10 V20
1   3  18
3   9  10
5   4  17</code></pre>
</div>
<p>We frequently want to select contiguous rows or columns, such as the
first ten rows, or columns 3 through 7. You can use <code>c</code> for
this, but it’s more convenient to use the <code>:</code> operator. This
special function generates sequences of numbers:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span><span class="op">:</span><span class="fl">12</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  3  4  5  6  7  8  9 10 11 12</code></pre>
</div>
<p>For example, we can select the first ten columns of values for the
first four rows like this:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  V1 V2 V3 V4 V5 V6 V7 V8 V9 V10
1  0  0  1  3  1  2  4  7  8   3
2  0  1  2  1  2  1  3  2  2   6
3  0  1  1  3  3  2  6  2  5   9
4  0  0  2  0  4  2  2  1  6   7</code></pre>
</div>
<p>or the first ten columns of rows 5 to 10 like this:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   V1 V2 V3 V4 V5 V6 V7 V8 V9 V10
5   0  1  1  3  3  1  3  5  2   4
6   0  0  1  2  2  4  2  1  6   4
7   0  0  2  2  4  2  2  5  5   8
8   0  0  1  2  3  1  2  3  5   3
9   0  0  0  3  1  5  6  5  5   8
10  0  1  1  2  1  3  5  3  5   8</code></pre>
</div>
<p>If you want to select all rows or all columns, leave that index value
empty.</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All columns from row 5</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="fl">5</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  V1 V2 V3 V4 V5 V6 V7 V8 V9 V10 V11 V12 V13 V14 V15 V16 V17 V18 V19 V20 V21
5  0  1  1  3  3  1  3  5  2   4   4   7   6   5   3  10   8  10   6  17   9
  V22 V23 V24 V25 V26 V27 V28 V29 V30 V31 V32 V33 V34 V35 V36 V37 V38 V39 V40
5  14   9   7  13   9  12   6   7   7   9   6   3   2   2   4   2   0   1   1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All rows from column 16-18</span></span>
<span><span class="va">dat</span><span class="op">[</span>, <span class="fl">16</span><span class="op">:</span><span class="fl">18</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   V16 V17 V18
1    4   7   7
2    4   7  16
3   15   5  11
4    8  15  10
5   10   8  10
6   15   4  16
7   13   5  12
8    9  15  11
9   11   9  10
10   6  13   8
11   3   7  13
12   8  14  11
13  12   4  17
14   3  10  13
15   5   7  17
16  10   7   8
17  11  12   5
18   4  14   7
19  11  15  17
20  13   6   5
21  15  13   6
22   5  12  12
23  14   5   5
24  13   7  14
25   4  12   9
26   9   5  16
27  13   4  13
28   6  15   6
29   7   6  11
30   6   8   7
31  14  12   8
32   3   8  10
33  15  15  10
34   4  12   9
35  15   9  17
36  11   5   7
37   7   4   7
38  10   6   7
39  15  12  13
40   6   8  15
41   5   7   5
42   6  10  13
43  15  11  12
44  11   6  10
45  15  12  15
46   6   7  11
47  11  16  12
48  15   5  15
49  14   4   6
50   4   7   9
51  10  13   6
52  15  15  12
53  11  15  13
54   6  11  12
55  13   8   9
56   8   8  16
57   4  16  11
58  13  13   9
59  12  15   5
60   9  14  11</code></pre>
</div>
<p>If you leave both index values empty (i.e., <code>dat[,]</code>), you
get the entire data frame.</p>
<div id="addressing-columns-by-name" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="addressing-columns-by-name" class="callout-inner">
<h3 class="callout-title">Addressing Columns by Name</h3>
<div class="callout-content">
<p>Columns can also be addressed by name, with either the <code>$</code>
operator (ie. <code>dat$V16</code>) or square brackets (ie.
<code>dat[, 'V16']</code>). You can learn more about subsetting by
column name in this supplementary <a href="10-supp-addressing-data.html">lesson</a>.</p>
</div>
</div>
</div>
<p>Now let’s perform some common mathematical operations to learn more
about our inflammation data. When analyzing data we often want to
calculate statistics for specific subsets or groups of the data frame,
such as the maximum value per patient or the average value per day. One
way to do this is to select the data we want to create a new temporary
data frame, and then perform the calculation on this subset:</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first row, all of the columns</span></span>
<span><span class="va">patient_1</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="co"># max inflammation for patient 1</span></span>
<span><span class="fu">max</span><span class="op">(</span><span class="va">patient_1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 18</code></pre>
</div>
<!--
    OUCH!! The following may be true, but it will vary by R version, not by
    installation! There shouldn't be an issue with a data frame where all
    columns are numeric without missing values. Under those circumstances,
    coercion should do what you expect. You'll get problems with mixed
    types (factors, character etc), or with missing values. If this is
    actually a problem, we need to change the example - we should be able
    to come up with an example that doesn't require this ugliness in the
    very first lesson.

    Also, columns always work as expected because by definition a column
    contains a vector of values of the same type. Rows include values from
    different columns, which of course can be different types. This doesn't
    need to be confusing, and if we're careful in our presentation here we
    can avoid this until the students know enough to cope rationally.
-->
<!--
> ## Forcing Conversion
>
> The code above may give you an error in some R installations,
> since R does not automatically convert a row from a `data.frame` to a vector.
> (Confusingly, subsetted columns are automatically converted.)
> If this happens, you can use the `as.numeric` command to convert the row of data to a numeric vector:
>
> `patient_1 <- as.numeric(dat[1, ])`
>
> `max(patient_1)`
>
> You can also check the `class` of each object:
>
> `class(dat[1, ])`
>
> `class(as.numeric(dat[1, ]))`
{: .callout}
-->
<p>We don’t actually need to store the row in a variable of its own.
Instead, we can combine the selection and the function call:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># max inflammation for patient 2</span></span>
<span><span class="fu">max</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 18</code></pre>
</div>
<p>R also has functions for other common calculations, e.g. finding the
minimum, mean, median, and standard deviation of the data:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># minimum inflammation on day 7</span></span>
<span><span class="fu">min</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># mean inflammation on day 7</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.8</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># median inflammation on day 7</span></span>
<span><span class="fu">median</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># standard deviation of inflammation on day 7</span></span>
<span><span class="fu">sd</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.725187</code></pre>
</div>
<div id="forcing-conversion" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="forcing-conversion" class="callout-inner">
<h3 class="callout-title">Forcing Conversion</h3>
<div class="callout-content">
<p>Note that R may return an error when you attempt to perform similar
calculations on subsetted <em>rows</em>of data frames. This is because
some functions in R automatically convert the object type to a numeric
vector, while others do not (e.g. <code>max(dat[1, ])</code> works as
expected, while <code>mean(dat[1, ])</code> returns <code>NA</code> and
a warning). You get the expected output by including an explicit call to
<code>as.numeric()</code>, e.g. <code>mean(as.numeric(dat[1, ]))</code>.
By contrast, calculations on subsetted <em>columns</em> always work as
expected, since columns of data frames are already defined as
vectors.</p>
</div>
</div>
</div>
<p>R also has a function that summaries the previous common
calculations:</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize function</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       V1          V2             V3              V4
 Min.   :0   Min.   :0.00   Min.   :0.000   Min.   :0.00
 1st Qu.:0   1st Qu.:0.00   1st Qu.:1.000   1st Qu.:1.00
 Median :0   Median :0.00   Median :1.000   Median :2.00
 Mean   :0   Mean   :0.45   Mean   :1.117   Mean   :1.75
 3rd Qu.:0   3rd Qu.:1.00   3rd Qu.:2.000   3rd Qu.:3.00
 Max.   :0   Max.   :1.00   Max.   :2.000   Max.   :3.00  </code></pre>
</div>
<p>For every column in the data frame, the function “summary”
calculates: the minimum value, the first quartile, the median, the mean,
the third quartile and the max value, giving helpful details about the
sample distribution.</p>
<p>What if we need the maximum inflammation for all patients, or the
average for each day? As the diagram below shows, we want to perform the
operation across a margin of the data frame:</p>
<figure><img src="../fig/r-operations-across-margins.svg" alt="Operations Across Margins" class="figure mx-auto d-block"></figure><p>To support this, we can use the <code>apply</code> function.</p>
<div id="getting-help" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="getting-help" class="callout-inner">
<h3 class="callout-title">Getting Help</h3>
<div class="callout-content">
<p>To learn about a function in R, e.g. <code>apply</code>, we can read
its help documentation by running <code>help(apply)</code> or
<code>?apply</code>.</p>
</div>
</div>
</div>
<p><code>apply</code> allows us to repeat a function on all of the rows
(<code>MARGIN = 1</code>) or columns (<code>MARGIN = 2</code>) of a data
frame.</p>
<p>Thus, to obtain the average inflammation of each patient we will need
to calculate the mean of all of the rows (<code>MARGIN = 1</code>) of
the data frame.</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avg_patient_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span></code></pre>
</div>
<p>And to obtain the average inflammation of each day we will need to
calculate the mean of all of the columns (<code>MARGIN = 2</code>) of
the data frame.</p>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avg_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span></code></pre>
</div>
<p>Since the second argument to <code>apply</code> is
<code>MARGIN</code>, the above command is equivalent to
<code>apply(dat, MARGIN = 2, mean)</code>. We’ll learn why this is so in
the next lesson.</p>
<div id="efficient-alternatives" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="efficient-alternatives" class="callout-inner">
<h3 class="callout-title">Efficient Alternatives</h3>
<div class="callout-content">
<p>Some common operations have more efficient alternatives. For example,
you can calculate the row-wise or column-wise means with
<code>rowMeans</code> and <code>colMeans</code>, respectively.</p>
</div>
</div>
</div>
<div id="subsetting-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="subsetting-data" class="callout-inner">
<h3 class="callout-title">Subsetting Data</h3>
<div class="callout-content">
<p>We can take subsets of character vectors as well:</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animal</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"o"</span>, <span class="st">"n"</span>, <span class="st">"k"</span>, <span class="st">"e"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="co"># first three characters</span></span>
<span><span class="va">animal</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "m" "o" "n"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># last three characters</span></span>
<span><span class="va">animal</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "k" "e" "y"</code></pre>
</div>
<ol style="list-style-type: decimal">
<li><p>If the first four characters are selected using the subset
<code>animal[1:4]</code>, how can we obtain the first four characters in
reverse order?</p></li>
<li><p>What is <code>animal[-1]</code>? What is <code>animal[-4]</code>?
Given those answers, explain what <code>animal[-1:-4]</code>
does.</p></li>
<li><p>Use a subset of <code>animal</code> to create a new character
vector that spells the word “eon”,
i.e. <code>c("e", "o", "n")</code>.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><p><code>animal[4:1]</code></p></li>
<li><p><code>"o" "n" "k" "e" "y"</code> and
<code>"m" "o" "n" "e" "y"</code>, which means that a single
<code>-</code> removes the element at the given index position.
<code>animal[-1:-4]</code> remove the subset, returning
<code>"e" "y"</code>, which is equivalent to
<code>animal[5:6]</code>.</p></li>
<li><p><code>animal[c(5,2,3)]</code> combines indexing with the
<code>c</code> function.</p></li>
</ol>
</div>
</div>
</div>
</div>
<div id="subsetting-more-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="subsetting-more-data" class="callout-inner">
<h3 class="callout-title">Subsetting More Data</h3>
<div class="callout-content">
<p>Suppose you want to determine the maximum inflammation for patient 5
across days three to seven. To do this you would extract the relevant
subset from the data frame and calculate the maximum value. Which of the
following lines of R code gives the correct answer?</p>
<ol style="list-style-type: decimal">
<li><code>max(dat[5, ])</code></li>
<li><code>max(dat[3:7, 5])</code></li>
<li><code>max(dat[5, 3:7])</code></li>
<li><code>max(dat[5, 3, 7])</code></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>Answer: 3</p>
<p>Explanation: You want to extract the part of the dataframe
representing data for patient 5 from days three to seven. In this
dataframe, patient data is organised in rows and the days are
represented by the columns. Subscripting in R follows the
<code>[i, j]</code> principle, where <code>i = rows</code> and
<code>j = columns</code>. Thus, answer 3 is correct since the patient is
represented by the value for i (5) and the days are represented by the
values in j, which is a subset spanning day 3 to 7.</p>
</div>
</div>
</div>
</div>
<div id="subsetting-and-re-assignment" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="subsetting-and-re-assignment" class="callout-inner">
<h3 class="callout-title">Subsetting and Re-Assignment</h3>
<div class="callout-content">
<p>Using the inflammation data frame <code>dat</code> from above: Let’s
pretend there was something wrong with the instrument on the first five
days for every second patient (#2, 4, 6, etc.), which resulted in the
measurements being twice as large as they should be.</p>
<ol style="list-style-type: decimal">
<li>Write a vector containing each affected patient (hint:
<code>?seq</code>)</li>
<li>Create a new data frame in which you halve the first five days’
values in only those patients</li>
<li>Print out the corrected data frame to check that your code has fixed
the problem</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">whichPatients</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">60</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># i.e., which rows</span></span>
<span><span class="va">whichDays</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>         <span class="co"># i.e., which columns</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">dat</span></span>
<span><span class="co"># check the size of your subset: returns `30 5`, that is 30 [rows=patients] by 5 [columns=days]</span></span>
<span><span class="fu">dim</span><span class="op">(</span><span class="va">dat2</span><span class="op">[</span><span class="va">whichPatients</span>, <span class="va">whichDays</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dat2</span><span class="op">[</span><span class="va">whichPatients</span>, <span class="va">whichDays</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dat2</span><span class="op">[</span><span class="va">whichPatients</span>, <span class="va">whichDays</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">dat2</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="using-the-apply-function-on-patient-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="using-the-apply-function-on-patient-data" class="callout-inner">
<h3 class="callout-title">Using the Apply Function on Patient Data</h3>
<div class="callout-content">
<p>Challenge: the apply function can be used to summarize datasets and
subsets of data across rows and columns using the MARGIN argument.
Suppose you want to calculate the mean inflammation for specific days
and patients in the patient dataset (i.e. 60 patients across 40
days).</p>
<p>Please use a combination of the apply function and indexing to:</p>
<ol style="list-style-type: decimal">
<li>calculate the mean inflammation for patients 1 to 5 over the whole
40 days</li>
<li>calculate the mean inflammation for days 1 to 10 (across all
patients).</li>
<li>calculate the mean inflammation for every second day (across all
patients).</li>
</ol>
<p>Think about the number of rows and columns you would expect as the
result before each apply call and check your intuition by applying the
mean function.</p>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1.</span></span>
<span><span class="fu">apply</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="co"># 2.</span></span>
<span><span class="fu">apply</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="co"># 3.</span></span>
<span><span class="fu">apply</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fu">seq</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">40</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<hr class="half-width">
<p>The mathematician Richard Hamming once said, “The purpose of
computing is insight, not numbers,” and the best way to develop insight
is often to visualize data. Visualization deserves an entire lecture (or
course) of its own, but we can explore a few of R’s plotting
features.</p>
<p>Let’s take a look at the average inflammation over time. Recall that
we already calculated these values above using
<code>apply(dat, 2, mean)</code> and saved them in the variable
<code>avg_day_inflammation</code>. Plotting the values is done with the
function <code>plot</code>.</p>
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">avg_day_inflammation</span><span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="../fig/01-starting-with-data-rendered-plot-avg-inflammation-1.svg" alt="Scatter plot of average inflammation versus time demonstrating the result of using the plot function" class="figure mx-auto d-block"><figcaption>
Scatter plot of average inflammation versus time demonstrating the
result of using the plot function
</figcaption></figure><p>Above, we gave the function <code>plot</code> a vector of numbers
corresponding to the average inflammation per day across all patients.
<code>plot</code> created a scatter plot where the y-axis is the average
inflammation level and the x-axis is the order, or index, of the values
in the vector, which in this case correspond to the 40 days of
treatment. The result is roughly a linear rise and fall, which is
suspicious: based on other studies, we expect a sharper rise and slower
fall. Let’s have a look at two other statistics: the maximum and minimum
inflammation per day.</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">max</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">max_day_inflammation</span><span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="../fig/01-starting-with-data-rendered-plot-max-inflammation-1.svg" alt="Scatter plot of maximum inflammation versus time demonstrating the result of using the plot function" class="figure mx-auto d-block"><figcaption>
Scatter plot of maximum inflammation versus time demonstrating the
result of using the plot function
</figcaption></figure><div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">min_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">min</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">min_day_inflammation</span><span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="../fig/01-starting-with-data-rendered-plot-min-inflammation-1.svg" alt="Scatter plot of minimum inflammation versus time demonstrating the result of using the plot function" class="figure mx-auto d-block"><figcaption>
Scatter plot of minimum inflammation versus time demonstrating the
result of using the plot function
</figcaption></figure><p>The maximum value rises and falls perfectly smoothly, while the
minimum seems to be a step function. Neither result seems particularly
likely, so either there’s a mistake in our calculations or something is
wrong with our data.</p>
<div id="plotting-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="plotting-data" class="callout-inner">
<h3 class="callout-title">Plotting Data</h3>
<div class="callout-content">
<p>Create a plot showing the standard deviation of the inflammation data
for each day across all patients.</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8"> Show me the solution </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb74">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sd_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">sd_day_inflammation</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="generative-ai-help">Generative AI Help<a class="anchor" aria-label="anchor" href="#generative-ai-help"></a>
</h2>
<hr class="half-width">
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Choose how to teach this section </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>The section on generative AI is intended to be concise but
Instructors may choose to devote more time to the topic in a workshop.
Depending on your own level of experience and comfort with talking about
and using these tools, you could choose to do any of the following:</p>
<ul>
<li>Explain how large language models work and are trained, and/or the
difference between generative AI, other forms of AI that currently
exist, and the limits of what LLMs can do (e.g., they can’t
“reason”).</li>
<li>Demonstrate how you recommend that learners use generative AI.</li>
<li>Discuss the ethical concerns listed below, as well as others that
you are aware of, to help learners make an informed choice about whether
or not to use generative AI tools.</li>
</ul>
<p>This is a fast-moving technology. If you are preparing to teach this
section and you feel it has become outdated, please open an issue on the
lesson repository to let the Maintainers know and/or a pull request to
suggest updates and improvements.</p>
</div>
</div>
</div>
</div>
<p>It is increasingly common for people to use <em>generative AI</em>
chatbots such as ChatGPT to get help while coding. You will probably
receive some useful guidance by presenting your error message to the
chatbot and asking it what went wrong. However, the way this help is
provided by the chatbot is different. Answers on StackOverflow have
(probably) been given by a human as a direct response to the question
asked. But generative AI chatbots, which are based on an advanced
statistical model, respond by generating the <em>most likely</em>
sequence of text that would follow the prompt they are given.</p>
<p>While responses from generative AI tools can often be helpful, they
are not always reliable. These tools sometimes generate plausible but
incorrect or misleading information, so (just as with an answer found on
the internet) it is essential to verify their accuracy. You need the
knowledge and skills to be able to understand these responses, to judge
whether or not they are accurate, and to fix any errors in the code it
offers you.</p>
<p>In addition to asking for help, programmers can use generative AI
tools to generate code from scratch; extend, improve and reorganise
existing code; translate code between programming languages; figure out
what terms to use in a search of the internet; and more. However, there
are drawbacks that you should be aware of.</p>
<p>The models used by these tools have been “trained” on very large
volumes of data, much of it taken from the internet, and the responses
they produce reflect that training data, and may recapitulate its
inaccuracies or biases. The environmental costs (energy and water use)
of LLMs are a lot higher than other technologies, both during
development (known as training) and when an individual user uses one
(also called inference). For more information see the <a href="https://huggingface.co/blog/sasha/ai-environment-primer" class="external-link">AI
Environmental Impact Primer</a> developed by researchers at HuggingFace,
an AI hosting platform. Concerns also exist about the way the data for
this training was obtained, with questions raised about whether the
people developing the LLMs had permission to use it. Other ethical
concerns have also been raised, such as reports that workers were
exploited during the training process.</p>
<p><strong>We recommend that you avoid getting help from generative AI
during the workshop</strong> for several reasons:</p>
<ol style="list-style-type: decimal">
<li>For most problems you will encounter at this stage, help and answers
can be found among the first results returned by searching the
internet.</li>
<li>The foundational knowledge and skills you will learn in this lesson
by writing and fixing your own programs are essential to be able to
evaluate the correctness and safety of any code you receive from online
help or a generative AI chatbot. If you choose to use these tools in the
future, the expertise you gain from learning and practising these
fundamentals on your own will help you use them more effectively.</li>
<li>As you start out with programming, the mistakes you make will be the
kinds that have also been made – and overcome! – by everybody else who
learned to program before you. Since these mistakes and the questions
you are likely to have at this stage are common, they are also better
represented than other, more specialised problems and tasks in the data
that was used to train generative AI tools. This means that a generative
AI chatbot is <em>more likely to produce accurate responses</em> to
questions that novices ask, which could give you a false impression of
how reliable they will be when you are ready to do things that are more
advanced.</li>
</ol>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Use <code>variable &lt;- value</code> to assign a value to a
variable in order to record it in memory.</li>
<li>Objects are created on demand whenever a value is assigned to
them.</li>
<li>The function <code>dim</code> gives the dimensions of a data
frame.</li>
<li>Use <code>object[x, y]</code> to select a single element from a data
frame.</li>
<li>Use <code>from:to</code> to specify a sequence that includes the
indices from <code>from</code> to <code>to</code>.</li>
<li>All the indexing and subsetting that works on data frames also works
on vectors.</li>
<li>Use <code>#</code> to add comments to programs.</li>
<li>Use <code>mean</code>, <code>max</code>, <code>min</code> and
<code>sd</code> to calculate simple statistics.</li>
<li>Use <code>apply</code> to calculate statistics across the rows or
columns of a data frame.</li>
<li>Use <code>plot</code> to create simple visualizations.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-02-func-R"><p>Content from <a href="02-func-R.html">Creating Functions</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/02-func-R.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I make a function?</li>
<li>How can I test my functions?</li>
<li>How should I document my code?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Define a function that takes arguments.</li>
<li>Return a value from a function.</li>
<li>Test a function.</li>
<li>Set default values for function arguments.</li>
<li>Explain why we should divide programs into small, single-purpose
functions.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>If we only had one data set to analyze, it would probably be faster
to load the file into a spreadsheet and use that to plot some simple
statistics. But we have twelve files to check, and may have more in the
future. In this lesson, we’ll learn how to write a function so that we
can repeat several operations with a single command.</p>
<div class="section level3">
<h3 id="defining-a-function">Defining a Function<a class="anchor" aria-label="anchor" href="#defining-a-function"></a>
</h3>
<p>You can write your own functions in order to make repetitive
operations using a single command. Let’s start by defining your function
“my_function” and the input parameter(s) that the user will feed to the
function. Afterwards you will define the operation that you desire to
program in the body of the function within curly braces ({}). Finally,
you need to assign the result (or output) of your function in the return
statement.</p>
<p>Now let’s see this process with an example. We are going to define a
function <code>fahrenheit_to_celsius</code> that converts temperatures
from <a href="https://en.wikipedia.org/wiki/Temperature_conversion_formulas#Fahrenheit" class="external-link">Fahrenheit
to Celsius</a>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fahrenheit_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp_F</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">temp_C</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">temp_F</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">temp_C</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>We define <code>fahrenheit_to_celsius</code> by assigning it to the
output of <code>function</code>. The list of argument names are
contained within parentheses. Next, the <a href="reference.html#function-body">body</a> of the function–the
statements that are executed when it runs–is contained within curly
braces (<code>{}</code>). The statements in the body are indented by two
spaces, which makes the code easier to read but does not affect how the
code operates.</p>
<figure><img src="../fig/function-terminology.svg" alt="A screenshot of the function `fahrenheit_to_celsius` defined above with some extra text annotations on specific function elements. Above the text `fahrenheit_to_celsisus`, the text reads 'Function name'. Above the text `temp_F`, the text reads 'Function argument(s)'.' The next two lines, surrounded by curly braces, are labelled 'Function body'." class="figure mx-auto d-block"><div class="figcaption">Vocabulary associated with functions.</div>
</figure><p>When we call the function, the values we pass to it are assigned to
those variables so that we can use them inside the function. Inside the
function, we use a <a href="reference.html#return-statement">return
statement</a> to send a result back to whoever asked for it.</p>
<div id="automatic-returns" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="automatic-returns" class="callout-inner">
<h3 class="callout-title">Automatic Returns</h3>
<div class="callout-content">
<p>In R, it is not necessary to include the return statement. R
automatically returns whichever variable is on the last line of the body
of the function. While in the learning phase, we will explicitly define
the return statement.</p>
</div>
</div>
</div>
<p>Let’s try running our function. Calling our own function is no
different from calling any other function:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># freezing point of water</span></span>
<span><span class="fu">fahrenheit_to_celsius</span><span class="op">(</span><span class="fl">32</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># boiling point of water</span></span>
<span><span class="fu">fahrenheit_to_celsius</span><span class="op">(</span><span class="fl">212</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 100</code></pre>
</div>
<p>We’ve successfully called the function that we defined, and we have
access to the value that we returned.</p>
</div>
<div class="section level3">
<h3 id="composing-functions">Composing Functions<a class="anchor" aria-label="anchor" href="#composing-functions"></a>
</h3>
<p>Now that we’ve seen how to turn Fahrenheit into Celsius, we can also
turn Celsius into Kelvin:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">celsius_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp_C</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">temp_K</span> <span class="op">&lt;-</span> <span class="va">temp_C</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">temp_K</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># freezing point of water in Kelvin</span></span>
<span><span class="fu">celsius_to_kelvin</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 273.15</code></pre>
</div>
<p>What about converting Fahrenheit to Kelvin? We could write out the
formula, but we don’t need to. Instead, we can <a href="reference.html#function-composition">compose</a> the two functions
we have already created:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fahrenheit_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp_F</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">temp_C</span> <span class="op">&lt;-</span> <span class="fu">fahrenheit_to_celsius</span><span class="op">(</span><span class="va">temp_F</span><span class="op">)</span></span>
<span>  <span class="va">temp_K</span> <span class="op">&lt;-</span> <span class="fu">celsius_to_kelvin</span><span class="op">(</span><span class="va">temp_C</span><span class="op">)</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">temp_K</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># freezing point of water in Kelvin</span></span>
<span><span class="fu">fahrenheit_to_kelvin</span><span class="op">(</span><span class="fl">32.0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 273.15</code></pre>
</div>
<p>This is our first taste of how larger programs are built: we define
basic operations, then combine them in ever-larger chunks to get the
effect we want. Real-life functions will usually be larger than the ones
shown here–typically half a dozen to a few dozen lines–but they
shouldn’t ever be much longer than that, or the next person who reads it
won’t be able to understand what’s going on.</p>
<div id="nesting-function-calls" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="nesting-function-calls" class="callout-inner">
<h3 class="callout-title">Nesting Function Calls</h3>
<div class="callout-content">
<p>This example showed the output of <code>fahrenheit_to_celsius</code>
assigned to <code>temp_C</code>, which is then passed to
<code>celsius_to_kelvin</code>to get the final result. It is also
possible to perform this calculation in one line of code, by “nesting”
one function call inside another, like so:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># freezing point of water in Fahrenheit</span></span>
<span><span class="fu">celsius_to_kelvin</span><span class="op">(</span><span class="fu">fahrenheit_to_celsius</span><span class="op">(</span><span class="fl">32.0</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 273.15</code></pre>
</div>
<p>Here, we call <code>fahrenheit_to_celsius</code> to convert
<code>32.0</code> from Fahrenheit to Celsius, and immediately pass the
value returned from <code>fahrenheit_to_celsius</code> to
<code>celsius_to_kelvin</code> to convert from Celsius to Kelvin. Our
conversion from Fahrenheit to Kelvin is done, all in one go!</p>
<p>This is convenient, but you should be careful not to nest too many
function calls at once - it can become confusing and difficult to
read!</p>
</div>
</div>
</div>
<div id="create-a-function" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="create-a-function" class="callout-inner">
<h3 class="callout-title">Create a Function</h3>
<div class="callout-content">
<p>In the last lesson, we learned to <strong>c</strong>ombine elements
into a vector using the <code>c</code> function,
e.g. <code>x &lt;- c("A", "B", "C")</code> creates a vector
<code>x</code> with three elements. Furthermore, we can extend that
vector again using <code>c</code>, e.g. <code>y &lt;- c(x, "D")</code>
creates a vector <code>y</code> with four elements. Write a function
called <code>highlight</code> that takes two vectors as arguments,
called <code>content</code> and <code>wrapper</code>, and returns a new
vector that has the wrapper vector at the beginning and end of the
content:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best_practice</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Write"</span>, <span class="st">"programs"</span>, <span class="st">"for"</span>, <span class="st">"people"</span>, <span class="st">"not"</span>, <span class="st">"computers"</span><span class="op">)</span></span>
<span><span class="va">asterisk</span> <span class="op">&lt;-</span> <span class="st">"***"</span>  <span class="co"># R interprets a variable with a single value as a vector</span></span>
<span>                   <span class="co"># with one element.</span></span>
<span><span class="fu">highlight</span><span class="op">(</span><span class="va">best_practice</span>, <span class="va">asterisk</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "***"       "Write"     "programs"  "for"       "people"    "not"
[7] "computers" "***"      </code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">highlight</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">content</span>, <span class="va">wrapper</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">answer</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">wrapper</span>, <span class="va">content</span>, <span class="va">wrapper</span><span class="op">)</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">answer</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="create-a-function" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="create-a-function" class="callout-inner">
<h3 class="callout-title">Create a Function<em> (continued)</em>
</h3>
<div class="callout-content">
<p>If the variable <code>v</code> refers to a vector, then
<code>v[1]</code> is the vector’s first element and
<code>v[length(v)]</code> is its last (the function <code>length</code>
returns the number of elements in a vector). Write a function called
<code>edges</code> that returns a vector made up of just the first and
last elements of its input:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dry_principle</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Don't"</span>, <span class="st">"repeat"</span>, <span class="st">"yourself"</span>, <span class="st">"or"</span>, <span class="st">"others"</span><span class="op">)</span></span>
<span><span class="fu">edges</span><span class="op">(</span><span class="va">dry_principle</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Don't"  "others"</code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="va">first</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>   <span class="va">last</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="fu">length</span><span class="op">(</span><span class="va">v</span><span class="op">)</span><span class="op">]</span></span>
<span>   <span class="va">answer</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">first</span>, <span class="va">last</span><span class="op">)</span></span>
<span>   <span class="kw">return</span><span class="op">(</span><span class="va">answer</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="the-call-stack" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="the-call-stack" class="callout-inner">
<h3 class="callout-title">The Call Stack</h3>
<div class="callout-content">
<p>For a deeper understanding of how functions work, you’ll need to
learn how they create their own environments and call other functions.
Function calls are managed via the call stack. For more details on the
call stack, have a look at the <a href="14-supp-call-stack.html">supplementary material</a>.</p>
</div>
</div>
</div>
<div id="named-variables-and-the-scope-of-variables" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="named-variables-and-the-scope-of-variables" class="callout-inner">
<h3 class="callout-title">Named Variables and the Scope of
Variables</h3>
<div class="callout-content">
<p>Functions can accept arguments explicitly assigned to a variable name
in the function call <code>functionName(variable = value)</code>, as
well as arguments by order:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_1</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">mySum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input_1</span>, <span class="va">input_2</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="va">input_1</span> <span class="op">+</span> <span class="va">input_2</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<ol style="list-style-type: decimal">
<li>Given the above code was run, which value does
<code>mySum(input_1 = 1, 3)</code> produce?</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>4</li>
<li>11</li>
<li>23</li>
<li>30</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>If <code>mySum(3)</code> returns 13, why does
<code>mySum(input_2 = 3)</code> return an error?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><p>The solution is <code>a.</code>.</p></li>
<li><p>Read the error message:
<code>argument "input_1" is missing, with no default</code> means that
no value for <code>input_1</code> is provided in the function call, and
neither in the function’s definition. Thus, the addition in the function
body can not be completed.</p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="testing-error-handling-and-documenting">Testing, Error Handling, and Documenting<a class="anchor" aria-label="anchor" href="#testing-error-handling-and-documenting"></a>
</h3>
<p>Once we start putting things in functions so that we can re-use them,
we need to start testing that those functions are working correctly. To
see how to do this, let’s write a function to center a dataset around a
particular midpoint:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">center</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">midpoint</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">new_data</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">data</span> <span class="op">-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">midpoint</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">new_data</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>We could test this on our actual data, but since we don’t know what
the values ought to be, it will be hard to tell if the result was
correct. Instead, let’s create a vector of 0s and then center that
around 3. This will make it simple to see if our function is working as
expected:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">z</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0 0 0 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">center</span><span class="op">(</span><span class="va">z</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3 3 3 3</code></pre>
</div>
<p>That looks right, so let’s try center on our real data. We’ll center
the inflammation data from day 4 around 0:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/inflammation-01.csv"</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">centered</span> <span class="op">&lt;-</span> <span class="fu">center</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">centered</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  1.25 -0.75  1.25 -1.75  1.25  0.25</code></pre>
</div>
<p>It’s hard to tell from the default output whether the result is
correct, but there are a few simple tests that will reassure us:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># original mean</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.75</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># centered mean</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">centered</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<p>That seems right: the original mean was about 1.75 and the mean of
the centered data is 0. We can even go further and check that the
standard deviation hasn’t changed:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># original standard deviation</span></span>
<span><span class="fu">sd</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.067628</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># centered standard deviation</span></span>
<span><span class="fu">sd</span><span class="op">(</span><span class="va">centered</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.067628</code></pre>
</div>
<p>Those values look the same, but we probably wouldn’t notice if they
were different in the sixth decimal place. Let’s do this instead:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># difference in standard deviations before and after</span></span>
<span><span class="fu">sd</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">centered</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<p>Sometimes, a very small difference can be detected due to rounding at
very low decimal places. R has a useful function for comparing two
objects allowing for rounding errors, <code>all.equal</code>:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">all.equal</span><span class="op">(</span><span class="fu">sd</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fu">sd</span><span class="op">(</span><span class="va">centered</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<p>It’s still possible that our function is wrong, but it seems unlikely
enough that we should probably get back to doing our analysis. However,
there are two other important tasks to consider: 1) we should ensure our
function can provide informative errors when needed, and 2) we should
write some <a href="reference.html#documentation">documentation</a> for
our function to remind ourselves later what it’s for and how to use
it.</p>
<div class="section level4">
<h4 id="error-handling">Error Handling<a class="anchor" aria-label="anchor" href="#error-handling"></a>
</h4>
<p>What happens if we have missing data (NA values) in the
<code>data</code> argument we provide to <code>center</code>?</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># new data object and set one value in column 4 to NA</span></span>
<span><span class="va">datNA</span> <span class="op">&lt;-</span> <span class="va">dat</span></span>
<span><span class="va">datNA</span><span class="op">[</span><span class="fl">10</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># returns all NA values</span></span>
<span><span class="fu">center</span><span class="op">(</span><span class="va">datNA</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
[26] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
[51] NA NA NA NA NA NA NA NA NA NA</code></pre>
</div>
<p>This is likely not the behavior we want, and is caused by the
<code>mean</code> function returning NA when the <code>na.rm=TRUE</code>
is not provided. We may wish to not consider NA values in our
<code>center</code>function. We can provide the <code>na.rm=TRUE</code>
argument and solve this issue.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">center</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">midpoint</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">new_data</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">data</span> <span class="op">-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">data</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">midpoint</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">new_data</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">center</span><span class="op">(</span><span class="va">datNA</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1.2542373 -0.7457627  1.2542373 -1.7457627  1.2542373  0.2542373
 [7]  0.2542373  0.2542373  1.2542373         NA -1.7457627 -1.7457627
[13] -0.7457627 -1.7457627 -0.7457627 -1.7457627 -1.7457627 -0.7457627
[19] -0.7457627 -1.7457627  1.2542373  1.2542373  1.2542373 -0.7457627
[25] -0.7457627 -0.7457627  0.2542373 -0.7457627  0.2542373 -0.7457627
[31] -1.7457627  1.2542373  0.2542373 -0.7457627  0.2542373  1.2542373
[37]  0.2542373  0.2542373  1.2542373  1.2542373  0.2542373  1.2542373
[43]  1.2542373  1.2542373  1.2542373  0.2542373  1.2542373  1.2542373
[49]  1.2542373  0.2542373 -0.7457627  0.2542373  0.2542373 -0.7457627
[55] -0.7457627  1.2542373  0.2542373 -0.7457627 -0.7457627 -1.7457627</code></pre>
</div>
<p>However, what happens if the user were to accidentally hand this
function a <code>factor</code> or <code>character</code> vector?</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datNA</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">as.factor</span><span class="op">(</span><span class="va">datNA</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">datNA</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">as.character</span><span class="op">(</span><span class="va">datNA</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">center</span><span class="op">(</span><span class="va">datNA</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in mean.default(data, na.rm = TRUE): argument is not numeric or
logical: returning NA</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in Ops.factor(data, mean(data, na.rm = TRUE)): '-' not meaningful for
factors</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
[26] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
[51] NA NA NA NA NA NA NA NA NA NA</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">center</span><span class="op">(</span><span class="va">datNA</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in mean.default(data, na.rm = TRUE): argument is not numeric or
logical: returning NA</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in data - mean(data, na.rm = TRUE): non-numeric argument to binary operator</code></pre>
</div>
<p>Both of these attempts result in errors. Luckily, the errors are
quite informative. In other cases, we may need to add in error handling
using the <code>warning</code> and <code>stop</code> functions.</p>
<p>For instance, the <code>center</code> function only works on numeric
vectors. Recognizing this and adding warnings and errors provides
feedback to the user and makes sure the output of the function is what
the user wanted.</p>
</div>
<div class="section level4">
<h4 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h4>
<p>A common way to put documentation in software is to add <a href="reference.html#comment">comments</a> like this:</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">center</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">midpoint</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># return a new vector containing the original data centered around the</span></span>
<span>  <span class="co"># midpoint.</span></span>
<span>  <span class="co"># Example: center(c(1, 2, 3), 0) =&gt; c(-1, 0, 1)</span></span>
<span>  <span class="va">new_data</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">data</span> <span class="op">-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">midpoint</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">new_data</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div id="writing-documentation" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="writing-documentation" class="callout-inner">
<h3 class="callout-title">Writing Documentation</h3>
<div class="callout-content">
<p>Formal documentation for R functions is written in separate
<code>.Rd</code> using a markup language similar to <a href="https://www.latex-project.org/" class="external-link">LaTeX</a>. You see the result of
this documentation when you look at the help file for a given function,
e.g. <code>?read.csv</code>. The <a href="https://cran.r-project.org/package=roxygen2/vignettes/rd.html" class="external-link">roxygen2</a>
package allows R coders to write documentation alongside the function
code and then process it into the appropriate <code>.Rd</code> files.
You will want to switch to this more formal method of writing
documentation when you start writing more complicated R projects.</p>
</div>
</div>
</div>
<div id="functions-to-create-graphs" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="functions-to-create-graphs" class="callout-inner">
<h3 class="callout-title">Functions to Create Graphs</h3>
<div class="callout-content">
<p>Write a function called <code>analyze</code> that takes a filename as
an argument and displays the three graphs produced in the <a href="01-starting-with-data.html">previous lesson</a> (average, min and
max inflammation over time).
<code>analyze("data/inflammation-01.csv")</code> should produce the
graphs already shown, while
<code>analyze("data/inflammation-02.csv")</code> should produce
corresponding graphs for the second data set. Be sure to document your
function with comments.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyze</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Plots the average, min, and max inflammation over time.</span></span>
<span>  <span class="co"># Input is character string of a csv file.</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">avg_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">avg_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">max_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">max_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">min_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">min</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">min_day_inflammation</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="rescaling" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="rescaling" class="callout-inner">
<h3 class="callout-title">Rescaling</h3>
<div class="callout-content">
<p>Write a function <code>rescale</code> that takes a vector as input
and returns a corresponding vector of values scaled to lie in the range
0 to 1. (If <code>L</code> and <code>H</code> are the lowest and highest
values in the original vector, then the replacement for a value
<code>v</code> should be <code>(v-L) / (H-L)</code>.) Be sure to
document your function with comments.</p>
<p>Test that your <code>rescale</code> function is working properly
using <code>min</code>, <code>max</code>, and <code>plot</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rescale</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Rescales a vector, v, to lie in the range 0 to 1.</span></span>
<span>  <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu">min</span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span>  <span class="va">H</span> <span class="op">&lt;-</span> <span class="fu">max</span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">v</span> <span class="op">-</span> <span class="va">L</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">H</span> <span class="op">-</span> <span class="va">L</span><span class="op">)</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="defining-defaults">Defining Defaults<a class="anchor" aria-label="anchor" href="#defining-defaults"></a>
</h3>
<p>We have passed arguments to functions in two ways: directly, as in
<code>dim(dat)</code>, and by name, as in
<code>read.csv(file = "data/inflammation-01.csv", header = FALSE)</code>.
In fact, we can pass the arguments to <code>read.csv</code> without
naming them:</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/inflammation-01.csv"</span>, <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>However, the position of the arguments matters if they are not
named.</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>header <span class="op">=</span> <span class="cn">FALSE</span>, file <span class="op">=</span> <span class="st">"data/inflammation-01.csv"</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="cn">FALSE</span>, <span class="st">"data/inflammation-01.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in read.table(file = file, header = header, sep = sep, quote = quote, : 'file' must be a character string or connection</code></pre>
</div>
<p>To understand what’s going on, and make our own functions easier to
use, let’s re-define our <code>center</code> function like this:</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">center</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">midpoint</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># return a new vector containing the original data centered around the</span></span>
<span>  <span class="co"># midpoint (0 by default).</span></span>
<span>  <span class="co"># Example: center(c(1, 2, 3), 0) =&gt; c(-1, 0, 1)</span></span>
<span>  <span class="va">new_data</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">data</span> <span class="op">-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">midpoint</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">new_data</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>The key change is that the second argument is now written
<code>midpoint = 0</code> instead of just <code>midpoint</code>. If we
call the function with two arguments, it works as it did before:</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu">center</span><span class="op">(</span><span class="va">test_data</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3 3 3 3</code></pre>
</div>
<p>But we can also now call <code>center()</code> with just one
argument, in which case <code>midpoint</code> is automatically assigned
the default value of <code>0</code>:</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">more_data</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="op">+</span> <span class="va">test_data</span></span>
<span><span class="va">more_data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 5 5 5 5</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">center</span><span class="op">(</span><span class="va">more_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0 0 0 0</code></pre>
</div>
<p>This is handy: if we usually want a function to work one way, but
occasionally need it to do something else, we can allow people to pass
an argument when they need to but provide a default to make the normal
case easier.</p>
<p>The example below shows how R matches values to arguments</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">display</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">b</span> <span class="op">=</span> <span class="fl">2</span>, <span class="va">c</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span><span class="op">)</span></span>
<span>  <span class="fu">names</span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>  <span class="co"># This names each element of the vector</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># no arguments</span></span>
<span><span class="fu">display</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>a b c
1 2 3 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># one argument</span></span>
<span><span class="fu">display</span><span class="op">(</span><span class="fl">55</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> a  b  c
55  2  3 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># two arguments</span></span>
<span><span class="fu">display</span><span class="op">(</span><span class="fl">55</span>, <span class="fl">66</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> a  b  c
55 66  3 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># three arguments</span></span>
<span><span class="fu">display</span><span class="op">(</span><span class="fl">55</span>, <span class="fl">66</span>, <span class="fl">77</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> a  b  c
55 66 77 </code></pre>
</div>
<p>As this example shows, arguments are matched from left to right, and
any that haven’t been given a value explicitly get their default value.
We can override this behavior by naming the value as we pass it in:</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># only setting the value of c</span></span>
<span><span class="fu">display</span><span class="op">(</span>c <span class="op">=</span> <span class="fl">77</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> a  b  c
 1  2 77 </code></pre>
</div>
<div id="matching-arguments" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="matching-arguments" class="callout-inner">
<h3 class="callout-title">Matching Arguments</h3>
<div class="callout-content">
<p>To be precise, R has three ways that arguments supplied by you are
matched to the <em>formal arguments</em> of the function definition:</p>
<ol style="list-style-type: decimal">
<li>by complete name,</li>
<li>by partial name (matching on initial <em>n</em> characters of the
argument name), and</li>
<li>by position.</li>
</ol>
<p>Arguments are matched in the manner outlined above in <em>that
order</em>: by complete name, then by partial matching of names, and
finally by position.</p>
</div>
</div>
</div>
<p>With that in hand, let’s look at the help for
<code>read.csv()</code>:</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">read.csv</span></span></code></pre>
</div>
<p>There’s a lot of information there, but the most important part is
the first couple of lines:</p>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">read.csv</span><span class="op">(</span><span class="va">file</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, quote <span class="op">=</span> <span class="st">"\""</span>,</span>
<span>         dec <span class="op">=</span> <span class="st">"."</span>, fill <span class="op">=</span> <span class="cn">TRUE</span>, comment.char <span class="op">=</span> <span class="st">""</span>, <span class="va">...</span><span class="op">)</span></span></code></pre>
</div>
<p>This tells us that <code>read.csv()</code> has one argument,
<code>file</code>, that doesn’t have a default value, and six others
that do. Now we understand why the following gives an error:</p>
<div class="codewrapper sourceCode" id="cb74">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="cn">FALSE</span>, <span class="st">"data/inflammation-01.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in read.table(file = file, header = header, sep = sep, quote = quote, : 'file' must be a character string or connection</code></pre>
</div>
<p>It fails because <code>FALSE</code> is assigned to <code>file</code>
and the filename is assigned to the argument <code>header</code>.</p>
<div id="a-function-with-default-argument-values" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="a-function-with-default-argument-values" class="callout-inner">
<h3 class="callout-title">A Function with Default Argument Values</h3>
<div class="callout-content">
<p>Rewrite the <code>rescale</code> function so that it scales a vector
to lie between 0 and 1 by default, but will allow the caller to specify
lower and upper bounds if they want. Compare your implementation to your
neighbor’s: Do your two implementations produce the same results when
both are given the same input vector and parameters?</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rescale</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span>, <span class="va">lower</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">upper</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Rescales a vector, v, to lie in the range lower to upper.</span></span>
<span>  <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu">min</span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span>  <span class="va">H</span> <span class="op">&lt;-</span> <span class="fu">max</span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">v</span> <span class="op">-</span> <span class="va">L</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">H</span> <span class="op">-</span> <span class="va">L</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">upper</span> <span class="op">-</span> <span class="va">lower</span><span class="op">)</span> <span class="op">+</span> <span class="va">lower</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Define a function using
<code>name &lt;- function(...args...) {...body...}</code>.</li>
<li>Call a function using <code>name(...values...)</code>.</li>
<li>R looks for variables in the current stack frame before looking for
them at the top level.</li>
<li>Use <code>help(thing)</code> to view help for something.</li>
<li>Put comments at the beginning of functions to provide help for that
function.</li>
<li>Annotate your code!</li>
<li>Specify default values for arguments when defining a function using
<code>name = value</code> in the argument list.</li>
<li>Arguments can be passed by matching based on name, by position, or
by omitting them (in which case the default value is used).</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-03-loops-R"><p>Content from <a href="03-loops-R.html">Analyzing Multiple Data Sets</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/03-loops-R.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I do the same thing to multiple data sets?</li>
<li>How do I write a <code>for</code> loop?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain what a <code>for</code> loop does.</li>
<li>Correctly write <code>for</code> loops to repeat simple
calculations.</li>
<li>Trace changes to a loop variable as the loop runs.</li>
<li>Trace changes to other variables as they are updated by a
<code>for</code> loop.</li>
<li>Use a function to get a list of filenames that match a simple
pattern.</li>
<li>Use a <code>for</code> loop to process multiple files.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We have created a function called <code>analyze</code> that creates
graphs of the minimum, average, and maximum daily inflammation rates for
a single data set:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyze</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Plots the average, min, and max inflammation over time.</span></span>
<span>  <span class="co"># The argument or input is a character string representing the name and location of a CSV file.</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">avg_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">avg_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">max_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">max_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">min_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">min</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">min_day_inflammation</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">analyze</span><span class="op">(</span><span class="st">"data/inflammation-01.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/03-loops-R-rendered-inflammation-01-1.svg" alt="Scatterplot of average daily inflammation over 40 days, increasing in a mostly straight line until day 20, and then decreasing in a mostly straight line to visualize inflammation levels in a single dataset." style="display: block; margin: auto;" class="figure"><img src="../fig/03-loops-R-rendered-inflammation-01-2.svg" alt="A scatterplot of maximum daily inflammation over 40 days, increasing in a straight line until day 20, and then decreasing in a straight line to visualize inflammation levels in a single dataset." style="display: block; margin: auto;" class="figure"><img src="../fig/03-loops-R-rendered-inflammation-01-3.svg" alt="A scatterplot of minimum daily inflammation over 40 days, increasing in a step-wise pattern until day 20, and then decreasing in a step-wise pattern to visualize inflammation levels in a single dataset." style="display: block; margin: auto;" class="figure"></p>
<p>We can use it to analyze other data sets one by one:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">analyze</span><span class="op">(</span><span class="st">"data/inflammation-02.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/03-loops-R-rendered-inflammation-02-1.svg" alt="A scatterplot of average daily inflammation over 40 days, increasing in a mostly straight line until day 20, and then decreasing in a mostly straight line to visualize inflammation levels in a single dataset." style="display: block; margin: auto;" class="figure"><img src="../fig/03-loops-R-rendered-inflammation-02-2.svg" alt="A scatterplot of average daily inflammation over 40 days, increasing in a mostly straight line until day 20, and then decreasing in a mostly straight line to visualize inflammation levels in a single dataset." style="display: block; margin: auto;" class="figure"><img src="../fig/03-loops-R-rendered-inflammation-02-3.svg" alt="A scatterplot of average daily inflammation over 40 days, increasing in a mostly straight line until day 20, and then decreasing in a mostly straight line to visualize inflammation levels in a single dataset." style="display: block; margin: auto;" class="figure"></p>
<p>but we have a dozen data sets right now and more on the way. We want
to create plots for all our data sets with a single statement. To do
that, we’ll have to teach the computer how to repeat things.</p>
<div class="section level3">
<h3 id="for-loops">For Loops<a class="anchor" aria-label="anchor" href="#for-loops"></a>
</h3>
<p>Suppose we want to print each word in a sentence. One way is to use
six <code>print</code> statements:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best_practice</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Let"</span>, <span class="st">"the"</span>, <span class="st">"computer"</span>, <span class="st">"do"</span>, <span class="st">"the"</span>, <span class="st">"work"</span><span class="op">)</span></span>
<span><span class="va">print_words</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sentence</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">sentence</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">sentence</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">sentence</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">sentence</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">sentence</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">sentence</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">print_words</span><span class="op">(</span><span class="va">best_practice</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Let"
[1] "the"
[1] "computer"
[1] "do"
[1] "the"
[1] "work"</code></pre>
</div>
<p>but that’s a bad approach for two reasons:</p>
<ol style="list-style-type: decimal">
<li><p>It doesn’t scale: if we want to print the elements in a vector
that’s hundreds long, we’d be better off just typing them in.</p></li>
<li><p>It’s fragile: if we give it a longer vector, it only prints part
of the data, and if we give it a shorter input, it returns
<code>NA</code> values because we’re asking for elements that don’t
exist!</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best_practice</span><span class="op">[</span><span class="op">-</span><span class="fl">6</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Let"      "the"      "computer" "do"       "the"     </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_words</span><span class="op">(</span><span class="va">best_practice</span><span class="op">[</span><span class="op">-</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Let"
[1] "the"
[1] "computer"
[1] "do"
[1] "the"
[1] NA</code></pre>
</div>
<div id="not-available" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="not-available" class="callout-inner">
<h3 class="callout-title">Not Available</h3>
<div class="callout-content">
<p>R has has a special variable, <code>NA</code>, for designating
missing values that are <strong>N</strong>ot <strong>A</strong>vailable
in a data set. See <code>?NA</code> and <a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.html#Missing-values" class="external-link">An
Introduction to R</a> for more details.</p>
</div>
</div>
</div>
<p>Here’s a better approach:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">print_words</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sentence</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">word</span> <span class="kw">in</span> <span class="va">sentence</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">print</span><span class="op">(</span><span class="va">word</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">print_words</span><span class="op">(</span><span class="va">best_practice</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Let"
[1] "the"
[1] "computer"
[1] "do"
[1] "the"
[1] "work"</code></pre>
</div>
<p>This is shorter - certainly shorter than something that prints every
character in a hundred-letter string - and more robust as well:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_words</span><span class="op">(</span><span class="va">best_practice</span><span class="op">[</span><span class="op">-</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Let"
[1] "the"
[1] "computer"
[1] "do"
[1] "the"</code></pre>
</div>
<p>The improved version of <code>print_words</code> uses a <a href="reference.html#for-loop">for loop</a> to repeat an operation—in
this case, printing—once for each thing in a collection. The general
form of a loop is:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="cf">for</span> (variable <span class="cf">in</span> collection) {</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  do things with variable</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>}</span></code></pre>
</div>
<p>We can name the <a href="reference.html#loop-variable">loop
variable</a> anything we like (with a few <a href="https://cran.r-project.org/doc/manuals/R-intro.html#R-commands_003b-case-sensitivity-etc" class="external-link">restrictions</a>,
e.g. the name of the variable cannot start with a digit).
<code>in</code> is part of the <code>for</code> syntax. Note that the
condition (<code>variable in collection</code>) is enclosed in
parentheses, and the body of the loop is enclosed in curly braces
<code>{ }</code>. For a single-line loop body, as here, the braces
aren’t needed, but it is good practice to include them as we did.</p>
<p>Here’s another loop that repeatedly updates a variable:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">len</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">vowels</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"e"</span>, <span class="st">"i"</span>, <span class="st">"o"</span>, <span class="st">"u"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="va">vowels</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">len</span> <span class="op">&lt;-</span> <span class="va">len</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Number of vowels</span></span>
<span><span class="va">len</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 5</code></pre>
</div>
<p>It’s worth tracing the execution of this little program step by step.
Since there are five elements in the vector <code>vowels</code>, the
statement inside the loop will be executed five times. The first time
around, <code>len</code> is zero (the value assigned to it on line 1)
and <code>v</code> is <code>"a"</code>. The statement adds 1 to the old
value of <code>len</code>, producing 1, and updates <code>len</code> to
refer to that new value. The next time around, <code>v</code> is
<code>"e"</code> and <code>len</code> is 1, so <code>len</code> is
updated to be 2. After three more updates, <code>len</code> is 5; since
there is nothing left in the vector <code>vowels</code> for R to
process, the loop finishes.</p>
<p>Note that a loop variable is just a variable that’s being used to
record progress in a loop. It still exists after the loop is over, and
we can re-use variables previously defined as loop variables as
well:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">letter</span> <span class="op">&lt;-</span> <span class="st">"z"</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">letter</span> <span class="kw">in</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">letter</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a"
[1] "b"
[1] "c"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># after the loop, letter is</span></span>
<span><span class="va">letter</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "c"</code></pre>
</div>
<p>Note also that finding the length of a vector is such a common
operation that R actually has a built-in function to do it called
<code>length</code>:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">vowels</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 5</code></pre>
</div>
<p><code>length</code> is much faster than any R function we could write
ourselves, and much easier to read than a two-line loop; it will also
give us the length of many other things that we haven’t met yet, so we
should always use it when we can (see this <a href="13-supp-data-structures.html">lesson</a> to learn more about the
different ways to store data in R).</p>
<div id="printing-numbers" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="printing-numbers" class="callout-inner">
<h3 class="callout-title">Printing Numbers</h3>
<div class="callout-content">
<p>R has a built-in function called <code>seq</code> that creates a list
of numbers:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">seq</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3</code></pre>
</div>
<p>Using <code>seq</code>, write a function that prints the first
<strong>N</strong> natural numbers, one per line:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_N</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1
[1] 2
[1] 3</code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">print_N</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">nseq</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">num</span> <span class="kw">in</span> <span class="va">nseq</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">print</span><span class="op">(</span><span class="va">num</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="summing-values" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="summing-values" class="callout-inner">
<h3 class="callout-title">Summing Values</h3>
<div class="callout-content">
<p>Write a function called <code>total</code> that calculates the sum of
the values in a vector. (R has a built-in function called
<code>sum</code> that does this for you. Please don’t use it for this
exercise.)</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_vec</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">23</span>, <span class="fl">42</span><span class="op">)</span></span>
<span><span class="fu">total</span><span class="op">(</span><span class="va">ex_vec</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 108</code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">total</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vec</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># calculates the sum of the values in a vector</span></span>
<span>  <span class="va">vec_sum</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">num</span> <span class="kw">in</span> <span class="va">vec</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">vec_sum</span> <span class="op">&lt;-</span> <span class="va">vec_sum</span> <span class="op">+</span> <span class="va">num</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">vec_sum</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exponentiation" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="exponentiation" class="callout-inner">
<h3 class="callout-title">Exponentiation</h3>
<div class="callout-content">
<p>Exponentiation is built into R:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span><span class="op">^</span><span class="fl">4</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 16</code></pre>
</div>
<p>Write a function called <code>expo</code> that uses a loop to
calculate the same result.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">expo</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 16</code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">base</span>, <span class="va">power</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu">seq</span><span class="op">(</span><span class="va">power</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="va">result</span> <span class="op">*</span> <span class="va">base</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="processing-multiple-files">Processing Multiple Files<a class="anchor" aria-label="anchor" href="#processing-multiple-files"></a>
</h3>
<p>We now have almost everything we need to process all our data files.
The only thing that’s missing is a function that finds files whose names
match a pattern. We do not need to write it ourselves because R already
has a function to do this called <code>list.files</code>.</p>
<p>If we run the function without any arguments,
<code>list.files()</code>, it returns every file in the current working
directory. We can understand this result by reading the help file
(<code>?list.files</code>). The first argument, <code>path</code>, is
the path to the directory to be searched, and it has the default value
of <code>"."</code> (recall from the <a href="https://swcarpentry.github.io/shell-novice/02-filedir/" class="external-link">lesson</a>
on the Unix Shell that <code>"."</code> is shorthand for the current
working directory). The second argument, <code>pattern</code>, is the
pattern being searched, and it has the default value of
<code>NULL</code>. Since no pattern is specified to filter the files,
all files are returned.</p>
<p>So to list all the csv files, we could run either of the
following:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">list.files</span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data"</span>, pattern <span class="op">=</span> <span class="st">"csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] "car-speeds-cleaned.csv" "car-speeds.csv"         "inflammation-01.csv"
 [4] "inflammation-02.csv"    "inflammation-03.csv"    "inflammation-04.csv"
 [7] "inflammation-05.csv"    "inflammation-06.csv"    "inflammation-07.csv"
[10] "inflammation-08.csv"    "inflammation-09.csv"    "inflammation-10.csv"
[13] "inflammation-11.csv"    "inflammation-12.csv"    "sample.csv"
[16] "small-01.csv"           "small-02.csv"           "small-03.csv"          </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">list.files</span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data"</span>, pattern <span class="op">=</span> <span class="st">"inflammation"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] "inflammation-01.csv"            "inflammation-02.csv"
 [3] "inflammation-03.csv"            "inflammation-04.csv"
 [5] "inflammation-05.csv"            "inflammation-06.csv"
 [7] "inflammation-07.csv"            "inflammation-08.csv"
 [9] "inflammation-09.csv"            "inflammation-10.csv"
[11] "inflammation-11.csv"            "inflammation-12.csv"
[13] "r-novice-inflammation-data.zip"</code></pre>
</div>
<div id="organizing-larger-projects" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="organizing-larger-projects" class="callout-inner">
<h3 class="callout-title">Organizing Larger Projects</h3>
<div class="callout-content">
<p>For larger projects, it is recommended to organize separate parts of
the analysis into multiple subdirectories, e.g. one subdirectory for the
raw data, one for the code, and one for the results like figures. We
have done that here to some extent, putting all of our data files into
the subdirectory “data”. For more advice on this topic, you can read <a href="https://www.ploscompbiol.org/article/info%3Adoi%2F10.1371%2Fjournal.pcbi.1000424" class="external-link">A
quick guide to organizing computational biology projects</a> by William
Stafford Noble.</p>
</div>
</div>
</div>
<p>As these examples show, <code>list.files</code> result is a vector of
strings, which means we can loop over it to do something with each
filename in turn. In our case, the “something” we want is our
<code>analyze</code> function.</p>
<p>Because we have put our data in a separate subdirectory, if we want
to access these files using the output of <code>list.files</code> we
also need to include the “path” portion of the file name. We can do that
by using the argument <code>full.names = TRUE</code>.</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">list.files</span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data"</span>, pattern <span class="op">=</span> <span class="st">"csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] "data/car-speeds-cleaned.csv" "data/car-speeds.csv"
 [3] "data/inflammation-01.csv"    "data/inflammation-02.csv"
 [5] "data/inflammation-03.csv"    "data/inflammation-04.csv"
 [7] "data/inflammation-05.csv"    "data/inflammation-06.csv"
 [9] "data/inflammation-07.csv"    "data/inflammation-08.csv"
[11] "data/inflammation-09.csv"    "data/inflammation-10.csv"
[13] "data/inflammation-11.csv"    "data/inflammation-12.csv"
[15] "data/sample.csv"             "data/small-01.csv"
[17] "data/small-02.csv"           "data/small-03.csv"          </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">list.files</span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data"</span>, pattern <span class="op">=</span> <span class="st">"inflammation"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] "data/inflammation-01.csv"            "data/inflammation-02.csv"
 [3] "data/inflammation-03.csv"            "data/inflammation-04.csv"
 [5] "data/inflammation-05.csv"            "data/inflammation-06.csv"
 [7] "data/inflammation-07.csv"            "data/inflammation-08.csv"
 [9] "data/inflammation-09.csv"            "data/inflammation-10.csv"
[11] "data/inflammation-11.csv"            "data/inflammation-12.csv"
[13] "data/r-novice-inflammation-data.zip"</code></pre>
</div>
<p>Let’s test out running our <code>analyze</code> function by using it
on the first three files in the vector returned by
<code>list.files</code>:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filenames</span> <span class="op">&lt;-</span> <span class="fu">list.files</span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>                        <span class="co"># Now follows a regular expression that matches:</span></span>
<span>                        pattern <span class="op">=</span> <span class="st">"inflammation-[0-9]{2}.csv"</span>,</span>
<span>                        <span class="co">#          |            |        the standard file extension of comma-separated values</span></span>
<span>                        <span class="co">#          |            the variable parts (two digits, each between 0 and 9)</span></span>
<span>                        <span class="co">#          the static part of the filenames</span></span>
<span>                        full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">filenames</span> <span class="op">&lt;-</span> <span class="va">filenames</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span>  <span class="fu">analyze</span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "data/inflammation-01.csv"</code></pre>
</div>
<p><img src="../fig/03-loops-R-rendered-loop-analyze-1.svg" alt="Scatterplot of average daily inflammation showing a ramp with a peak at 20 days." style="display: block; margin: auto;" class="figure"><img src="../fig/03-loops-R-rendered-loop-analyze-2.svg" alt="Scatterplot of average daily inflammation showing a ramp with a peak at 20 days." style="display: block; margin: auto;" class="figure"><img src="../fig/03-loops-R-rendered-loop-analyze-3.svg" alt="Scatterplot of average daily inflammation showing a ramp with a peak at 20 days." style="display: block; margin: auto;" class="figure"></p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "data/inflammation-02.csv"</code></pre>
</div>
<p><img src="../fig/03-loops-R-rendered-loop-analyze-4.svg" alt="Scatterplot of average daily inflammation showing a ramp with a peak at 20 days." style="display: block; margin: auto;" class="figure"><img src="../fig/03-loops-R-rendered-loop-analyze-5.svg" alt="Scatterplot of average daily inflammation showing a ramp with a peak at 20 days." style="display: block; margin: auto;" class="figure"><img src="../fig/03-loops-R-rendered-loop-analyze-6.svg" alt="Scatterplot of average daily inflammation showing a ramp with a peak at 20 days." style="display: block; margin: auto;" class="figure"></p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "data/inflammation-03.csv"</code></pre>
</div>
<p><img src="../fig/03-loops-R-rendered-loop-analyze-7.svg" alt="Scatterplot of average daily inflammation showing a ramp with a peak at 20 days." style="display: block; margin: auto;" class="figure"><img src="../fig/03-loops-R-rendered-loop-analyze-8.svg" alt="Scatterplot of average daily inflammation showing a ramp with a peak at 20 days." style="display: block; margin: auto;" class="figure"><img src="../fig/03-loops-R-rendered-loop-analyze-9.svg" alt="Scatterplot of average daily inflammation showing a ramp with a peak at 20 days." style="display: block; margin: auto;" class="figure"></p>
<p>Sure enough, the maxima of these data sets show exactly the same ramp
as the first, and their minima show the same staircase structure.</p>
<div id="other-ways-to-do-it" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="other-ways-to-do-it" class="callout-inner">
<h3 class="callout-title">Other Ways to Do It</h3>
<div class="callout-content">
<p>In this lesson we saw how to use a simple <code>for</code> loop to
repeat an operation. As you progress with R, you will learn that there
are multiple ways to accomplish this. Sometimes the choice of one method
over another is more a matter of personal style, but other times it can
have consequences for the speed of your code. For instruction on best
practices, see this supplementary <a href="15-supp-loops-in-depth.html">lesson</a> that demonstrates how to
properly repeat operations in R.</p>
</div>
</div>
</div>
<div id="using-loops-to-analyze-multiple-files" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="using-loops-to-analyze-multiple-files" class="callout-inner">
<h3 class="callout-title">Using Loops to Analyze Multiple Files</h3>
<div class="callout-content">
<p>Write a function called <code>analyze_all</code> that takes a folder
path and a filename pattern as its arguments and runs
<code>analyze</code> for each file whose name matches the pattern.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyze_all</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">folder</span> <span class="op">=</span> <span class="st">"data"</span>, <span class="va">pattern</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Runs the function analyze for each file in the given folder</span></span>
<span>  <span class="co"># that contains the given pattern.</span></span>
<span>  <span class="va">filenames</span> <span class="op">&lt;-</span> <span class="fu">list.files</span><span class="op">(</span>path <span class="op">=</span> <span class="va">folder</span>, pattern <span class="op">=</span> <span class="va">pattern</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">analyze</span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Use <code>for (variable in collection)</code> to process the
elements of a collection one at a time.</li>
<li>The body of a <code>for</code> loop is surrounded by curly braces
(<code>{}</code>).</li>
<li>Use <code>length(thing)</code> to determine the length of something
that contains other values.</li>
<li>Use
<code>list.files(path = "path", pattern = "pattern", full.names = TRUE)</code>
to create a list of files whose names match a pattern.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-04-cond"><p>Content from <a href="04-cond.html">Making Choices</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/04-cond.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I make choices using <code>if</code> and <code>else</code>
statements?</li>
<li>How do I compare values?</li>
<li>How do I save my plots to a PDF file?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Save plot(s) in a PDF file.</li>
<li>Write conditional statements with <code>if</code> and
<code>else</code>.</li>
<li>Correctly evaluate expressions containing <code>&amp;&amp;</code>
(‘and’) and <code>||</code> (‘or’).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Our previous lessons have shown us how to manipulate data, define our
own functions, and repeat things. However, the programs we have written
so far always do the same things, regardless of what data they’re given.
We want programs to make choices based on the values they are
manipulating.</p>
<div class="section level3">
<h3 id="saving-plots-to-a-file">Saving Plots to a File<a class="anchor" aria-label="anchor" href="#saving-plots-to-a-file"></a>
</h3>
<p>So far, we have built a function <code>analyze</code> to plot summary
statistics of the inflammation data:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyze</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Plots the average, min, and max inflammation over time.</span></span>
<span>  <span class="co"># Input is character string of a csv file.</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">avg_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">avg_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">max_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">max_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">min_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">min</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">min_day_inflammation</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>And also built the function <code>analyze_all</code> to automate the
processing of each data file:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyze_all</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">folder</span> <span class="op">=</span> <span class="st">"data"</span>, <span class="va">pattern</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Runs the function analyze for each file in the given folder</span></span>
<span>  <span class="co"># that contains the given pattern.</span></span>
<span>  <span class="va">filenames</span> <span class="op">&lt;-</span> <span class="fu">list.files</span><span class="op">(</span>path <span class="op">=</span> <span class="va">folder</span>, pattern <span class="op">=</span> <span class="va">pattern</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">analyze</span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>While these are useful in an interactive R session, what if we want
to send our results to our collaborators? Since we currently have 12
data sets, running <code>analyze_all(pattern = inflammation.*csv)</code>
creates 36 plots. Saving each of these individually would be tedious and
error-prone. And in the likely situation that we want to change how the
data is processed or the look of the plots, we would have to once again
save all 36 before sharing the updated results with our
collaborators.</p>
<p>Here’s how we can save all three plots of the first inflammation data
set in a pdf file:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pdf</span><span class="op">(</span><span class="st">"inflammation-01.pdf"</span><span class="op">)</span></span>
<span><span class="fu">analyze</span><span class="op">(</span><span class="st">"data/inflammation-01.csv"</span><span class="op">)</span></span>
<span><span class="fu">dev.off</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>The function <code>pdf</code> redirects all the plots generated by R
into a pdf file, which in this case we have named “inflammation-01.pdf”.
After we are done generating the plots to be saved in the pdf file, we
stop R from redirecting plots with the function
<code>dev.off</code>.</p>
<div id="overwriting-plots" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="overwriting-plots" class="callout-inner">
<h3 class="callout-title">Overwriting Plots</h3>
<div class="callout-content">
<p>If you run <code>pdf</code> multiple times without running
<code>dev.off</code>, you will save plots to the most recently opened
file. However, you won’t be able to open the previous pdf files because
the connections were not closed. In order to get out of this situation,
you’ll need to run <code>dev.off</code> until all the pdf connections
are closed. You can check your current status using the function
<code>dev.cur</code>. If it says “pdf”, all your plots are being saved
in the last pdf specified. If it says “null device” or “RStudioGD”, the
plots will be visualized normally.</p>
</div>
</div>
</div>
<p>We can update the <code>analyze</code> function so that it always
saves the plots in a pdf. But that would make it more difficult to
interactively test out new changes. It would be ideal if
<code>analyze</code> would either save or not save the plots based on
its input.</p>
</div>
<div class="section level3">
<h3 id="conditionals">Conditionals<a class="anchor" aria-label="anchor" href="#conditionals"></a>
</h3>
<p>In order to update our function to decide between saving or not, we
need to write code that automatically decides between multiple options.
The computer can make these decisions through logical comparisons.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num</span> <span class="op">&lt;-</span> <span class="fl">37</span></span>
<span><span class="va">num</span> <span class="op">&gt;</span> <span class="fl">100</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE</code></pre>
</div>
<p>As 37 is not greater than 100, this returns a <code>FALSE</code>
object. And as you likely guessed, the opposite of <code>FALSE</code> is
<code>TRUE</code>.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num</span> <span class="op">&lt;</span> <span class="fl">100</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<p>We pair these logical comparison tools with what R calls a <a href="reference.html#conditional-statement">conditional statement</a>,
and it looks like this:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num</span> <span class="op">&lt;-</span> <span class="fl">37</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">num</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"greater"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"not greater"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"done"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "not greater"
[1] "done"</code></pre>
</div>
<p>The second line of this code uses an <code>if</code> statement to
tell R that we want to make a choice. If the following test is
<code>TRUE</code>, the body of the <code>if</code> (i.e., the lines in
the curly braces underneath it) are executed. If the test is
<code>FALSE</code>, the body of the <code>else</code> is executed
instead. Only one or the other is ever executed:</p>
<figure><img src="../fig/python-flowchart-conditional.svg" alt="Executing a Conditional" class="figure mx-auto d-block"></figure><p>In the example above, the test <code>num &gt; 100</code> returns the
value <code>FALSE</code>, which is why the code inside the
<code>if</code> block was skipped and the code inside the
<code>else</code> statement was run instead.</p>
<p>Conditional statements don’t have to include an <code>else</code>. If
there isn’t one, R simply does nothing if the test is false:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num</span> <span class="op">&lt;-</span> <span class="fl">53</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">num</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"num is greater than 100"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>We can also chain several tests together when there are more than two
options. This makes it simple to write a function that returns the sign
of a number:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sign</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">num</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">num</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">return</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">num</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">return</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">return</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">sign</span><span class="op">(</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sign</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sign</span><span class="op">(</span><span class="fl">2</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<p>Note that when combining <code>else</code> and <code>if</code> in an
<code>else if</code> statement, the <code>if</code> portion still
requires a direct input condition. This is never the case for the
<code>else</code> statement alone, which is only executed if all other
conditions go unsatisfied. Note that the test for equality uses two
equal signs, <code>==</code>.</p>
<div id="other-comparisons" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="other-comparisons" class="callout-inner">
<h3 class="callout-title">Other Comparisons</h3>
<div class="callout-content">
<p>Other tests include greater than or equal to (<code>&gt;=</code>),
less than or equal to (<code>&lt;=</code>), and not equal to
(<code>!=</code>).</p>
</div>
</div>
</div>
<p>We can also combine tests. Two ampersands, <code>&amp;&amp;</code>,
symbolize “and”. Two vertical bars, <code>||</code>, symbolize “or”.
<code>&amp;&amp;</code> is only true if both parts are true:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fl">1</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="op">-</span><span class="fl">1</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"both parts are true"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"at least one part is not true"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "at least one part is not true"</code></pre>
</div>
<p>while <code>||</code> is true if either part is true:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fl">1</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">||</span> <span class="op">-</span><span class="fl">1</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"at least one part is true"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"neither part is true"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "at least one part is true"</code></pre>
</div>
<p>In this case, “either” means “either or both”, not “either one or the
other but not both”.</p>
<div id="special-case-of-the-na-variable" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="special-case-of-the-na-variable" class="callout-inner">
<h3 class="callout-title">Special case of the <code>NA</code>
variable</h3>
<div class="callout-content">
<p>You may remember from the previous lesson that R has a special
variable, <code>NA</code>, for designating missing values. Because it
represents the absence of a value, we will not be able to test its
equality or inequality with another value. Such tests always return
<code>NA</code>:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">a</span> <span class="op">==</span> <span class="fl">1</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">==</span> <span class="cn">NA</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
<p>We need to be particularly careful in tests because trying to compare
a <code>NA</code> value will result in an error:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="va">a</span> <span class="op">==</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"Hi!"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in if (a == NA) {: missing value where TRUE/FALSE needed</code></pre>
</div>
<p>To solve this issue, we need to use the dedicated
<code>is.na()</code> function:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">is.na</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">is.na</span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"Hi!"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Hi!"</code></pre>
</div>
</div>
</div>
</div>
<div id="choosing-plots-based-on-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="choosing-plots-based-on-data" class="callout-inner">
<h3 class="callout-title">Choosing Plots Based on Data</h3>
<div class="callout-content">
<p>Write a function <code>plot_dist</code> that plots a boxplot if the
length of the vector is greater than a specified threshold and a
stripchart otherwise. To do this you’ll use the R functions
<code>boxplot</code> and <code>stripchart</code>.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/inflammation-01.csv"</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">plot_dist</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">10</span><span class="op">]</span>, threshold <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>     <span class="co"># day (column) 10</span></span></code></pre>
</div>
<figure><img src="../fig/04-cond-rendered-using-conditions-01-1.svg" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_dist</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">]</span>, threshold <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>  <span class="co"># samples (rows) 1-5 on day (column) 10</span></span></code></pre>
</div>
<figure><img src="../fig/04-cond-rendered-using-conditions-01-2.svg" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_dist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">threshold</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">length</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">threshold</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">boxplot</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu">stripchart</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="histograms-instead" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="histograms-instead" class="callout-inner">
<h3 class="callout-title">Histograms Instead</h3>
<div class="callout-content">
<p>One of your collaborators prefers to see the distributions of the
larger vectors as a histogram instead of as a boxplot. In order to
choose between a histogram and a boxplot we will edit the function
<code>plot_dist</code> and add an additional argument
<code>use_boxplot</code>. By default we will set
<code>use_boxplot</code> to <code>TRUE</code> which will create a
boxplot when the vector is longer than <code>threshold</code>. When
<code>use_boxplot</code> is set to <code>FALSE</code>,
<code>plot_dist</code> will instead plot a histogram for the larger
vectors. As before, if the length of the vector is shorter than
<code>threshold</code>, <code>plot_dist</code> will create a stripchart.
A histogram is made with the <code>hist</code> command in R.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/inflammation-01.csv"</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">plot_dist</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">10</span><span class="op">]</span>, threshold <span class="op">=</span> <span class="fl">10</span>, use_boxplot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>   <span class="co"># day (column) 10 - create boxplot</span></span></code></pre>
</div>
<figure><img src="../fig/04-cond-rendered-conditional-challenge-hist-1.svg" alt="A grey unlabeled boxplot chart showing the distrubution values between 2 and 9 with a mean at 6." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_dist</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">10</span><span class="op">]</span>, threshold <span class="op">=</span> <span class="fl">10</span>, use_boxplot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># day (column) 10 - create histogram</span></span></code></pre>
</div>
<figure><img src="../fig/04-cond-rendered-conditional-challenge-hist-2.svg" alt="A grey unlabeled histogram showing bimodal distribution between 2 and 9 with peaks at 2 and 6." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_dist</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">]</span>, threshold <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>                    <span class="co"># samples (rows) 1-5 on day (column) 10</span></span></code></pre>
</div>
<figure><img src="../fig/04-cond-rendered-conditional-challenge-hist-3.svg" alt="A mostly blank strip chart showing five points at 3, 4, 6, 7, and 9" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_dist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">threshold</span>, <span class="va">use_boxplot</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="kw">if</span> <span class="op">(</span><span class="fu">length</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">threshold</span> <span class="op">&amp;&amp;</span> <span class="va">use_boxplot</span><span class="op">)</span> <span class="op">{</span></span>
<span>       <span class="fu">boxplot</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>   <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu">length</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">threshold</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="va">use_boxplot</span><span class="op">)</span> <span class="op">{</span></span>
<span>       <span class="fu">hist</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>   <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>       <span class="fu">stripchart</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>   <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="find-the-maximum-inflammation-score" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="find-the-maximum-inflammation-score" class="callout-inner">
<h3 class="callout-title">Find the Maximum Inflammation Score</h3>
<div class="callout-content">
<p>Find the file containing the patient with the highest average
inflammation score. Print the file name, the patient number (row number)
and the value of the maximum average inflammation score.</p>
<p>Tips:</p>
<ol style="list-style-type: decimal">
<li>Use variables to store the maximum average and update it as you go
through files and patients.</li>
<li>You can use nested loops (one loop is inside the other) to go
through the files as well as through the patients in each file (every
row).</li>
</ol>
<p>Complete the code below:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filenames</span> <span class="op">&lt;-</span> <span class="fu">list.files</span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data"</span>, pattern <span class="op">=</span> <span class="st">"inflammation-[0-9]{2}.csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">filename_max</span> <span class="op">&lt;-</span> <span class="st">""</span> <span class="co"># filename where the maximum average inflammation patient is found</span></span>
<span><span class="va">patient_max</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># index (row number) for this patient in this file</span></span>
<span><span class="va">average_inf_max</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># value of the average inflammation score for this patient</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">f</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">dat.means</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">patient_index</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span><span class="op">(</span><span class="va">dat.means</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">patient_average_inf</span> <span class="op">&lt;-</span> <span class="va">dat.means</span><span class="op">[</span><span class="va">patient_index</span><span class="op">]</span></span>
<span>    <span class="co"># Add your code here ...</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">filename_max</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">patient_max</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">average_inf_max</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add your code here ...</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">patient_average_inf</span> <span class="op">&gt;</span> <span class="va">average_inf_max</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">average_inf_max</span> <span class="op">&lt;-</span> <span class="va">patient_average_inf</span></span>
<span>  <span class="va">filename_max</span> <span class="op">&lt;-</span> <span class="va">f</span></span>
<span>  <span class="va">patient_max</span> <span class="op">&lt;-</span> <span class="va">patient_index</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="saving-automatically-generated-figures">Saving Automatically Generated Figures<a class="anchor" aria-label="anchor" href="#saving-automatically-generated-figures"></a>
</h3>
<p>Now that we know how to have R make decisions based on input values,
let’s update <code>analyze</code>:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyze</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span>, <span class="va">output</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Plots the average, min, and max inflammation over time.</span></span>
<span>  <span class="co"># Input:</span></span>
<span>  <span class="co">#    filename: character string of a csv file</span></span>
<span>  <span class="co">#    output: character string of pdf file for saving</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">pdf</span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">avg_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">avg_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">max_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">max_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">min_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">min</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">min_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">dev.off</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>We added an argument, <code>output</code>, that by default is set to
<code>NULL</code>. An <code>if</code> statement at the beginning checks
the argument <code>output</code> to decide whether or not to save the
plots to a pdf. Let’s break it down. The function <code>is.null</code>
returns <code>TRUE</code> if a variable is <code>NULL</code> and
<code>FALSE</code> otherwise. The exclamation mark, <code>!</code>,
stands for “not”. Therefore the line in the <code>if</code> block is
only executed if <code>output</code> is “not null”.</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu">is.null</span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE</code></pre>
</div>
<p>Now we can use <code>analyze</code> interactively, as before,</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">analyze</span><span class="op">(</span><span class="st">"data/inflammation-01.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/04-cond-rendered-inflammation-01-1.svg" style="display: block; margin: auto;" class="figure"><img src="../fig/04-cond-rendered-inflammation-01-2.svg" style="display: block; margin: auto;" class="figure"><img src="../fig/04-cond-rendered-inflammation-01-3.svg" style="display: block; margin: auto;" class="figure"></p>
<p>but also use it to save plots,</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">analyze</span><span class="op">(</span><span class="st">"data/inflammation-01.csv"</span>, output <span class="op">=</span> <span class="st">"inflammation-01.pdf"</span><span class="op">)</span></span></code></pre>
</div>
<p>Before going further, we will create a directory <code>results</code>
for saving our plots. It is <a href="https://swcarpentry.github.io/good-enough-practices-in-scientific-computing/" class="external-link">good
practice</a> in data analysis projects to save all output to a directory
separate from the data and analysis code. You can create this directory
using the shell command <a href="https://swcarpentry.github.io/shell-novice/03-create/" class="external-link">mkdir</a>,
or the R function <code>dir.create()</code></p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dir.create</span><span class="op">(</span><span class="st">"results"</span><span class="op">)</span></span></code></pre>
</div>
<p>Now run <code>analyze</code> and save the plot in the
<code>results</code> directory,</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">analyze</span><span class="op">(</span><span class="st">"data/inflammation-01.csv"</span>, output <span class="op">=</span> <span class="st">"results/inflammation-01.pdf"</span><span class="op">)</span></span></code></pre>
</div>
<p>This now works well when we want to process one data file at a time,
but how can we specify the output file in <code>analyze_all</code>? We
need to do two things:</p>
<ol style="list-style-type: decimal">
<li>Substitute the filename ending “csv” with “pdf”.</li>
<li>Save the plot to the <code>results</code> directory.</li>
</ol>
<p>To change the extension to “pdf”, we will use the function
<code>sub</code>,</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="st">"inflammation-01.csv"</span></span>
<span><span class="fu">sub</span><span class="op">(</span><span class="st">"csv"</span>, <span class="st">"pdf"</span>, <span class="va">f</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "inflammation-01.pdf"</code></pre>
</div>
<p>To add the “results” directory to the filename use the function
<code>file.path</code>,</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">file.path</span><span class="op">(</span><span class="st">"results"</span>, <span class="fu">sub</span><span class="op">(</span><span class="st">"csv"</span>, <span class="st">"pdf"</span>, <span class="va">f</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "results/inflammation-01.pdf"</code></pre>
</div>
<p>Now let’s update <code>analyze_all</code>:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyze_all</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pattern</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Directory name containing the data</span></span>
<span>  <span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="st">"data"</span></span>
<span>  <span class="co"># Directory name for results</span></span>
<span>  <span class="va">results_dir</span> <span class="op">&lt;-</span> <span class="st">"results"</span></span>
<span>  <span class="co"># Runs the function analyze for each file in the current working directory</span></span>
<span>  <span class="co"># that contains the given pattern.</span></span>
<span>  <span class="va">filenames</span> <span class="op">&lt;-</span> <span class="fu">list.files</span><span class="op">(</span>path <span class="op">=</span> <span class="va">data_dir</span>, pattern <span class="op">=</span> <span class="va">pattern</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pdf_name</span> <span class="op">&lt;-</span> <span class="fu">file.path</span><span class="op">(</span><span class="va">results_dir</span>, <span class="fu">sub</span><span class="op">(</span><span class="st">"csv"</span>, <span class="st">"pdf"</span>, <span class="va">f</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">analyze</span><span class="op">(</span><span class="fu">file.path</span><span class="op">(</span><span class="va">data_dir</span>, <span class="va">f</span><span class="op">)</span>, output <span class="op">=</span> <span class="va">pdf_name</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>Now we can save all of the results with just one line of code:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">analyze_all</span><span class="op">(</span><span class="st">"inflammation.*csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>Now if we need to make any changes to our analysis, we can edit the
<code>analyze</code> function and quickly regenerate all the figures
with <code>analyze_all</code>.</p>
<div id="changing-the-behavior-of-the-plot-command" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="changing-the-behavior-of-the-plot-command" class="callout-inner">
<h3 class="callout-title">Changing the Behavior of the Plot Command</h3>
<div class="callout-content">
<p>One of your collaborators asks if you can recreate the figures with
lines instead of points. Find the relevant argument to <code>plot</code>
by reading the documentation (<code>?plot</code>), update
<code>analyze</code>, and then recreate all the figures with
<code>analyze_all</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyze</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span>, <span class="va">output</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Plots the average, min, and max inflammation over time.</span></span>
<span>  <span class="co"># Input:</span></span>
<span>  <span class="co">#    filename: character string of a csv file</span></span>
<span>  <span class="co">#    output: character string of pdf file for saving</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">pdf</span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">avg_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">avg_day_inflammation</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span>
<span>  <span class="va">max_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">max_day_inflammation</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span>
<span>  <span class="va">min_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">min</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">min_day_inflammation</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">dev.off</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Save a plot in a pdf file using <code>pdf("name.pdf")</code> and
stop writing to the pdf file with <code>dev.off()</code>.</li>
<li>Use <code>if (condition)</code> to start a conditional statement,
<code>else if (condition)</code> to provide additional tests, and
<code>else</code> to provide a default.</li>
<li>The bodies of conditional statements must be surrounded by curly
braces <code>{ }</code>.</li>
<li>Use <code>==</code> to test for equality.</li>
<li>
<code>X &amp;&amp; Y</code> is only true if both X and Y are
true.</li>
<li>
<code>X || Y</code> is true if either X or Y, or both, are
true.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-05-cmdline"><p>Content from <a href="05-cmdline.html">Command-Line Programs</a></p>
<hr>
<p>Last updated on 2025-08-19 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/05-cmdline.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 80 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I write a command-line script?</li>
<li>How do I read in arguments from the command-line?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use the values of command-line arguments in a program.</li>
<li>Handle flags and files separately in a command-line program.</li>
<li>Read data from standard input in a program so that it can be used in
a pipeline.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The R Console and other interactive tools like RStudio are great for
prototyping code and exploring data, but sooner or later we will want to
use our program in a pipeline or run it in a shell script to process
thousands of data files. In order to do that, we need to make our
programs work like other Unix command-line tools. For example, we may
want a program that reads a data set and prints the average inflammation
per patient:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> Rscript readings.R <span class="at">--mean</span> data/inflammation-01.csv</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">5.45</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="ex">5.425</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="ex">6.1</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="ex">6.4</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="ex">7.05</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="ex">5.9</span></span></code></pre>
</div>
<p>but we might also want to look at the minimum of the first four
lines</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">$</span> head <span class="at">-4</span> data/inflammation-01.csv <span class="kw">|</span> <span class="ex">Rscript</span> readings.R <span class="at">--min</span></span></code></pre>
</div>
<p>or the maximum inflammations in several files one after another:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> Rscript readings.R <span class="at">--max</span> data/inflammation-<span class="pp">*</span>.csv</span></code></pre>
</div>
<p>Our overall requirements are:</p>
<ol style="list-style-type: decimal">
<li>If no filename is given on the command line, read data from <a href="reference.html#standard-input-stdin">standard input</a>.</li>
<li>If one or more filenames are given, read data from them and report
statistics for each file separately.</li>
<li>Use the <code>--min</code>, <code>--mean</code>, or
<code>--max</code> flag to determine what statistic to print.</li>
</ol>
<p>To make this work, we need to know how to handle command-line
arguments in a program, and how to get at standard input. We’ll tackle
these questions in turn below.</p>
<div class="section level3">
<h3 id="command-line-arguments">Command-Line Arguments<a class="anchor" aria-label="anchor" href="#command-line-arguments"></a>
</h3>
<p>Using the text editor of your choice, save the following line of code
in a text file called <code>session-info.R</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">sessionInfo</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>The function, <code>sessionInfo</code>, outputs the version of R you
are running as well as the type of computer you are using (as well as
the versions of the packages that have been loaded). This is very useful
information to include when asking others for help with your R code.</p>
<p>Now we can run the code in the file we created from the Unix Shell
using <code>Rscript</code>:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">Rscript</span> session-info.R</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>R version 4.5.1 (2025-06-13)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

time zone: Etc/UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.5.1</code></pre>
</div>
<div id="the-right-directory" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="the-right-directory" class="callout-inner">
<h3 class="callout-title">The Right Directory</h3>
<div class="callout-content">
<p>If that did not work, you might have seen an error message indicating
that the file <code>session-info.R</code> does not exist. Remember that
you must be in the correct directory, the one in which you created your
script file. You can determine which directory you are currently in
using <code>pwd</code> and change to a different directory using
<code>cd</code>. For a review, see this <a href="https://swcarpentry.github.io/shell-novice/02-filedir/" class="external-link">lesson</a>.</p>
</div>
</div>
</div>
<p>Now let’s create another script that does something more interesting.
Write the following lines in a file named <code>print-args.R</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">cat</span><span class="op">(</span><span class="va">args</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span></code></pre>
</div>
<p>The function <code>commandArgs</code> extracts all the command line
arguments and returns them as a vector. The function <code>cat</code>,
similar to the <code>cat</code> of the Unix Shell, outputs the contents
of the variable. Since we did not specify a filename for writing,
<code>cat</code> sends the output to <a href="reference.html#standard-output-stdout">standard output</a>, which
we can then pipe to other Unix functions. Because we set the argument
<code>sep</code> to <code>"\n"</code>, which is the symbol to start a
new line, each element of the vector is printed on its own line. Let’s
see what happens when we run this program in the Unix Shell:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">Rscript</span> print-args.R</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/usr/local/lib/R/bin/exec/R
--no-save
--no-restore
--no-echo
--no-restore
--file=print-args.R</code></pre>
</div>
<p>From this output, we learn that <code>Rscript</code> is just a
convenience command for running R scripts. The first argument in the
vector is the path to the <code>R</code> executable. The following are
all command-line arguments that affect the behavior of R. From the R
help file:</p>
<ul>
<li>
<code>--no-echo</code>: Make R run as quietly as possible</li>
<li>
<code>--no-restore</code>: Don’t restore anything that was created
during the R session</li>
<li>
<code>--file</code>: Run this file</li>
<li>
<code>--args</code>: Pass these arguments to the file being run</li>
</ul>
<p>Thus running a file with Rscript is an easier way to run the
following:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">R</span> <span class="at">--no-echo</span> <span class="at">--no-restore</span> <span class="at">--file</span><span class="op">=</span>print-args.R <span class="at">--args</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/usr/local/lib/R/bin/exec/R
--no-save
--no-restore
--no-echo
--no-restore
--file=print-args.R
--args</code></pre>
</div>
<p>If we run it with a few arguments, however:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">Rscript</span> print-args.R first second third</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/usr/local/lib/R/bin/exec/R
--no-save
--no-restore
--no-echo
--no-restore
--file=print-args.R
--args
first
second
third</code></pre>
</div>
<p>then <code>commandArgs</code> adds each of those arguments to the
vector it returns. Since the first elements of the vector are always the
same, we can tell <code>commandArgs</code> to only return the arguments
that come after <code>--args</code>. Let’s update
<code>print-args.R</code> and save it as
<code>print-args-trailing.R</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">cat</span><span class="op">(</span><span class="va">args</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span></code></pre>
</div>
<p>And then run <code>print-args-trailing</code> from the Unix
Shell:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">Rscript</span> print-args-trailing.R first second third</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">first</span></span>
<span><span class="va">second</span></span>
<span><span class="va">third</span></span></code></pre>
</div>
<p>Now <code>commandArgs</code> returns only the arguments that we
listed after <code>print-args-trailing.R</code>.</p>
<p>With this in hand, let’s build a version of <code>readings.R</code>
that always prints the per-patient (per-row) mean of a single data file.
The first step is to write a function that outlines our implementation,
and a placeholder for the function that does the actual work. By
convention this function is usually called <code>main</code>, though we
can call it whatever we want. Write the following code in a file called
<code>readings-01.R</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">filename</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">mean_per_patient</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="fu">cat</span><span class="op">(</span><span class="va">mean_per_patient</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>This function gets the name of the file to process from the first
element returned by <code>commandArgs</code>. Here’s a simple test to
run from the Unix Shell:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">Rscript</span> readings-01.R data/inflammation-01.csv</span></code></pre>
</div>
<p>There is no output because we have defined a function, but haven’t
actually called it. Let’s add a call to <code>main</code> and save it as
<code>readings-02.R</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">filename</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">mean_per_patient</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="fu">cat</span><span class="op">(</span><span class="va">mean_per_patient</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">main</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">Rscript</span> readings-02.R data/inflammation-01.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">5.45</span></span>
<span><span class="fl">5.425</span></span>
<span><span class="fl">6.1</span></span>
<span><span class="fl">5.9</span></span>
<span><span class="fl">5.55</span></span>
<span><span class="fl">6.225</span></span>
<span><span class="fl">5.975</span></span>
<span><span class="fl">6.65</span></span>
<span><span class="fl">6.625</span></span>
<span><span class="fl">6.525</span></span>
<span><span class="fl">6.775</span></span>
<span><span class="fl">5.8</span></span>
<span><span class="fl">6.225</span></span>
<span><span class="fl">5.75</span></span>
<span><span class="fl">5.225</span></span>
<span><span class="fl">6.3</span></span>
<span><span class="fl">6.55</span></span>
<span><span class="fl">5.7</span></span>
<span><span class="fl">5.85</span></span>
<span><span class="fl">6.55</span></span>
<span><span class="fl">5.775</span></span>
<span><span class="fl">5.825</span></span>
<span><span class="fl">6.175</span></span>
<span><span class="fl">6.1</span></span>
<span><span class="fl">5.8</span></span>
<span><span class="fl">6.425</span></span>
<span><span class="fl">6.05</span></span>
<span><span class="fl">6.025</span></span>
<span><span class="fl">6.175</span></span>
<span><span class="fl">6.55</span></span>
<span><span class="fl">6.175</span></span>
<span><span class="fl">6.35</span></span>
<span><span class="fl">6.725</span></span>
<span><span class="fl">6.125</span></span>
<span><span class="fl">7.075</span></span>
<span><span class="fl">5.725</span></span>
<span><span class="fl">5.925</span></span>
<span><span class="fl">6.15</span></span>
<span><span class="fl">6.075</span></span>
<span><span class="fl">5.75</span></span>
<span><span class="fl">5.975</span></span>
<span><span class="fl">5.725</span></span>
<span><span class="fl">6.3</span></span>
<span><span class="fl">5.9</span></span>
<span><span class="fl">6.75</span></span>
<span><span class="fl">5.925</span></span>
<span><span class="fl">7.225</span></span>
<span><span class="fl">6.15</span></span>
<span><span class="fl">5.95</span></span>
<span><span class="fl">6.275</span></span>
<span><span class="fl">5.7</span></span>
<span><span class="fl">6.1</span></span>
<span><span class="fl">6.825</span></span>
<span><span class="fl">5.975</span></span>
<span><span class="fl">6.725</span></span>
<span><span class="fl">5.7</span></span>
<span><span class="fl">6.25</span></span>
<span><span class="fl">6.4</span></span>
<span><span class="fl">7.05</span></span>
<span><span class="fl">5.9</span></span></code></pre>
</div>
<div id="a-simple-command-line-program" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="a-simple-command-line-program" class="callout-inner">
<h3 class="callout-title">A Simple Command-Line Program</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Write a command-line program that does addition and subtraction of
two numbers.</li>
</ol>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Give me a hint </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" aria-labelledby="headingHint1" data-bs-parent="#accordionHint1">
<div class="accordion-body">
<p>Everything argument read from the command-line is interpreted as a
character <a href="reference.html#string">string</a>. You can convert
from a string to a number using the function
<code>as.numeric</code>.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">Rscript</span> arith.R 1 + 2</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">3</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">Rscript</span> arith.R 3 <span class="at">-</span> 4</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="op">-</span><span class="fl">1</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">cat</span> arith.R</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Performs addition or subtraction from the command line.</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co"># Takes three arguments:</span></span>
<span>  <span class="co"># The first and third are the numbers.</span></span>
<span>  <span class="co"># The second is either + for addition or - for subtraction.</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co"># Ex. usage:</span></span>
<span>  <span class="co">#   Rscript arith.R 1 + 2</span></span>
<span>  <span class="co">#   Rscript arith.R 3 - 4</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">num1</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">operation</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">num2</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">operation</span> <span class="op">==</span> <span class="st">"+"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">answer</span> <span class="op">&lt;-</span> <span class="va">num1</span> <span class="op">+</span> <span class="va">num2</span></span>
<span>    <span class="fu">cat</span><span class="op">(</span><span class="va">answer</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">operation</span> <span class="op">==</span> <span class="st">"-"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">answer</span> <span class="op">&lt;-</span> <span class="va">num1</span> <span class="op">-</span> <span class="va">num2</span></span>
<span>    <span class="fu">cat</span><span class="op">(</span><span class="va">answer</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">stop</span><span class="op">(</span><span class="st">"Invalid input. Use + for addition or - for subtraction."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">main</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="a-simple-command-line-program" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="a-simple-command-line-program" class="callout-inner">
<h3 class="callout-title">A Simple Command-Line Program<em>
(continued)</em>
</h3>
<div class="callout-content">
<ol start="2" style="list-style-type: decimal">
<li>What goes wrong if you try to add multiplication using
<code>*</code> to the program?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>An error message is returned due to “invalid input.” This is likely
because ‘*’ has a special meaning in the shell, as a wildcard.</p>
</div>
</div>
</div>
</div>
<div id="a-simple-command-line-program" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="a-simple-command-line-program" class="callout-inner">
<h3 class="callout-title">A Simple Command-Line Program<em>
(continued)</em>
</h3>
<div class="callout-content">
<ol start="3" style="list-style-type: decimal">
<li>Using the function <code>list.files</code> introduced in a previous
<a href="03-loops-R.html">lesson</a>, write a command-line program
called <code>find-pattern.R</code> that lists all the files in the
current directory that contain a specific pattern:</li>
</ol>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># For example, searching for the pattern "print-args" returns the two scripts we wrote earlier</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="ex">Rscript</span> find-pattern.R print-args</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">print</span><span class="op">-</span><span class="va">args</span><span class="op">-</span><span class="va">trailing.R</span></span>
<span><span class="va">print</span><span class="op">-</span><span class="va">args.R</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">cat</span> find-pattern.R</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Finds all files in the current directory that contain a given pattern.</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co"># Takes one argument: the pattern to be searched.</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co"># Ex. usage:</span></span>
<span>  <span class="co">#   Rscript find-pattern.R csv</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">pattern</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">files</span> <span class="op">&lt;-</span> <span class="fu">list.files</span><span class="op">(</span>pattern <span class="op">=</span> <span class="va">pattern</span><span class="op">)</span></span>
<span>  <span class="fu">cat</span><span class="op">(</span><span class="va">files</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">main</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="handling-multiple-files">Handling Multiple Files<a class="anchor" aria-label="anchor" href="#handling-multiple-files"></a>
</h3>
<p>The next step is to teach our program how to handle multiple files.
Since 60 lines of output per file is a lot to page through, we’ll start
by using three smaller files, each of which has three days of data for
two patients. Let’s investigate them from the Unix Shell:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">ls</span> data/small-<span class="pp">*</span>.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>data/small-01.csv
data/small-02.csv
data/small-03.csv</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">cat</span> data/small-01.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0,0,1
0,1,2</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="ex">Rscript</span> readings-02.R data/small-01.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">0.3333333</span></span>
<span><span class="fl">1</span></span></code></pre>
</div>
<p>Using small data files as input also allows us to check our results
more easily: here, for example, we can see that our program is
calculating the mean correctly for each line, whereas we were really
taking it on faith before. This is yet another rule of programming: test
the simple things first.</p>
<p>We want our program to process each file separately, so we need a
loop that executes once for each filename. If we specify the files on
the command line, the filenames will be returned by
<code>commandArgs(trailingOnly = TRUE)</code>. We’ll need to handle an
unknown number of filenames, since our program could be run for any
number of files.</p>
<p>The solution is to loop over the vector returned by
<code>commandArgs(trailingOnly = TRUE)</code>. Here’s our changed
program, which we’ll save as <code>readings-03.R</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">filename</span> <span class="kw">in</span> <span class="va">args</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">mean_per_patient</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="fu">cat</span><span class="op">(</span><span class="va">mean_per_patient</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">main</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>and here it is in action:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="ex">Rscript</span> readings-03.R data/small-01.csv data/small-02.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">0.3333333</span></span>
<span><span class="fl">1</span></span>
<span><span class="fl">13.66667</span></span>
<span><span class="fl">11</span></span></code></pre>
</div>
<p><strong>Note</strong>: at this point, we have created three versions
of our script called <code>readings-01.R</code>,
<code>readings-02.R</code>, and <code>readings-03.R</code>. We wouldn’t
do this in real life: instead, we would have one file called
<code>readings.R</code> that we committed to version control every time
we got an enhancement working. For teaching, though, we need all the
successive versions side by side.</p>
<div id="a-command-line-program-with-arguments" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="a-command-line-program-with-arguments" class="callout-inner">
<h3 class="callout-title">A Command Line Program with Arguments</h3>
<div class="callout-content">
<p>Write a program called <code>check.R</code> that takes the names of
one or more inflammation data files as arguments and checks that all the
files have the same number of rows and columns. What is the best way to
test your program?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">cat</span> check.R</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Checks that all csv files have the same number of rows and columns.</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co"># Takes multiple arguments: the names of the files to be checked.</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co"># Ex. usage:</span></span>
<span>  <span class="co">#   Rscript check.R inflammation-*</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">first_file</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">first_dim</span> <span class="op">&lt;-</span> <span class="fu">dim</span><span class="op">(</span><span class="va">first_file</span><span class="op">)</span></span>
<span><span class="co">#   num_rows &lt;- dim(first_file)[1]  # nrow(first_file)</span></span>
<span><span class="co">#   num_cols &lt;- dim(first_file)[2]  # ncol(first_file)</span></span>
<span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">filename</span> <span class="kw">in</span> <span class="va">args</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">new_file</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">new_dim</span> <span class="op">&lt;-</span> <span class="fu">dim</span><span class="op">(</span><span class="va">new_file</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">new_dim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">!=</span> <span class="va">first_dim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">new_dim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">!=</span> <span class="va">first_dim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">cat</span><span class="op">(</span><span class="st">"Not all the data files have the same dimensions."</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">main</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="handling-command-line-flags">Handling Command-Line Flags<a class="anchor" aria-label="anchor" href="#handling-command-line-flags"></a>
</h3>
<p>The next step is to teach our program to pay attention to the
<code>--min</code>, <code>--mean</code>, and <code>--max</code> flags.
These always appear before the names of the files, so let’s save the
following in <code>readings-04.R</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">action</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">filenames</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">f</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--min"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">min</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--mean"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--max"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu">cat</span><span class="op">(</span><span class="va">values</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">main</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>And we can confirm this works by running it from the Unix Shell:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="ex">Rscript</span> readings-04.R <span class="at">--max</span> data/small-01.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1</span></span>
<span><span class="fl">2</span></span></code></pre>
</div>
<p>but there are several things wrong with it:</p>
<ol style="list-style-type: decimal">
<li><p><code>main</code> is too large to read comfortably.</p></li>
<li><p>If <code>action</code> isn’t one of the three recognized flags,
the program loads each file but does nothing with it (because none of
the branches in the conditional match). <a href="reference.html#silent-failure">Silent failures</a> like this are
always hard to debug.</p></li>
</ol>
<p>This version pulls the processing of each file out of the loop into a
function of its own. It also uses <code>stopifnot</code> to check that
<code>action</code> is one of the allowed flags before doing any
processing, so that the program fails fast. We’ll save it as
<code>readings-05.R</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">action</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">filenames</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="fu">stopifnot</span><span class="op">(</span><span class="va">action</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"--min"</span>, <span class="st">"--mean"</span>, <span class="st">"--max"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">process</span><span class="op">(</span><span class="va">f</span>, <span class="va">action</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">process</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span>, <span class="va">action</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--min"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">min</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--mean"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--max"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu">cat</span><span class="op">(</span><span class="va">values</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">main</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>This is four lines longer than its predecessor, but broken into more
digestible chunks of 8 and 12 lines.</p>
<div id="parsing-command-line-flags" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="parsing-command-line-flags" class="callout-inner">
<h3 class="callout-title">Parsing Command-Line Flags</h3>
<div class="callout-content">
<p>R has a package named <a href="https://cran.r-project.org/package=argparse" class="external-link">argparse</a> that
helps handle complex command-line flags (it utilizes a <a href="https://docs.python.org/dev/library/argparse.html" class="external-link">Python
module</a> of the same name). We will not cover this package in this
lesson but when you start writing programs with multiple parameters
you’ll want to read through the package’s <a href="https://cran.r-project.org/package=argparse/vignettes/argparse.html" class="external-link">vignette</a>.</p>
</div>
</div>
</div>
<div id="shorter-command-line-arguments" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="shorter-command-line-arguments" class="callout-inner">
<h3 class="callout-title">Shorter Command Line Arguments</h3>
<div class="callout-content">
<p>Rewrite this program so that it uses <code>-n</code>,
<code>-m</code>, and <code>-x</code> instead of <code>--min</code>,
<code>--mean</code>, and <code>--max</code> respectively. Is the code
easier to read? Is the program easier to understand?</p>
<p>Separately, modify the program so that if no action is specified (or
an incorrect action is given), it prints a message explaining how it
should be used.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">cat</span> readings-short.R</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">action</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">filenames</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="fu">stopifnot</span><span class="op">(</span><span class="va">action</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"-n"</span>, <span class="st">"-m"</span>, <span class="st">"-x"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">process</span><span class="op">(</span><span class="va">f</span>, <span class="va">action</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">process</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span>, <span class="va">action</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"-n"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">min</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"-m"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"-x"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu">cat</span><span class="op">(</span><span class="va">values</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">main</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>The program is neither easier to read nor easier to understand due to
the ambiguity of the argument names.</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">cat</span> readings-usage.R</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">action</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">filenames</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">action</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"--min"</span>, <span class="st">"--mean"</span>, <span class="st">"--max"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">usage</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">process</span><span class="op">(</span><span class="va">f</span>, <span class="va">action</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">process</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span>, <span class="va">action</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--min"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">min</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--mean"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--max"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu">cat</span><span class="op">(</span><span class="va">values</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">usage</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">cat</span><span class="op">(</span><span class="st">"usage: Rscript readings-usage.R [--min, --mean, --max] filenames"</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">main</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="handling-standard-input">Handling Standard Input<a class="anchor" aria-label="anchor" href="#handling-standard-input"></a>
</h3>
<p>The next thing our program has to do is read data from standard input
if no filenames are given so that we can put it in a pipeline, redirect
input to it, and so on. Let’s experiment in another script, which we’ll
save as <code>count-stdin.R</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">lines</span> <span class="op">&lt;-</span> <span class="fu">readLines</span><span class="op">(</span>con <span class="op">=</span> <span class="fu">file</span><span class="op">(</span><span class="st">"stdin"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">lines</span><span class="op">)</span></span>
<span><span class="fu">cat</span><span class="op">(</span><span class="st">"lines in standard input: "</span><span class="op">)</span></span>
<span><span class="fu">cat</span><span class="op">(</span><span class="va">count</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span></code></pre>
</div>
<p>This little program reads lines from the program’s standard input
using <code>file("stdin")</code>. This allows us to do almost anything
with it that we could do to a regular file. In this example, we passed
it as an argument to the function <code>readLines</code>, which stores
each line as an element in a vector. Let’s try running it from the Unix
Shell as if it were a regular command-line program:</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="ex">Rscript</span> count-stdin.R <span class="op">&lt;</span> data/small-01.csv</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>lines in standard input: 2</code></pre>
</div>
<p>Note that because we did not specify <code>sep = "\n"</code> when
calling <code>cat</code>, the output is written on the same line.</p>
<p>A common mistake is to try to run something that reads from standard
input like this:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="ex">Rscript</span> count-stdin.R data/small-01.csv</span></code></pre>
</div>
<p>i.e., to forget the <code>&lt;</code> character that redirect the
file to standard input. In this case, there’s nothing in standard input,
so the program waits at the start of the loop for someone to type
something on the keyboard. We can type some input, but R keeps running
because it doesn’t know when the standard input has ended. If you ran
this, you can pause R by typing <kbd>Ctrl</kbd>+<kbd>Z</kbd>
(technically it is still paused in the background; if you want to fully
kill the process type <code>kill %</code>; see <a href="https://www.gnu.org/software/bash/manual/bash.html#Job-Control-Basics" class="external-link">bash
manual</a> for more information).</p>
<p>We now need to rewrite the program so that it loads data from
<code>file("stdin")</code> if no filenames are provided. Luckily,
<code>read.csv</code> can handle either a filename or an open file as
its first parameter, so we don’t actually need to change
<code>process</code>. That leaves <code>main</code>, which we’ll update
and save as <code>readings-06.R</code>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">action</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">filenames</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="fu">stopifnot</span><span class="op">(</span><span class="va">action</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"--min"</span>, <span class="st">"--mean"</span>, <span class="st">"--max"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">length</span><span class="op">(</span><span class="va">filenames</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">process</span><span class="op">(</span><span class="fu">file</span><span class="op">(</span><span class="st">"stdin"</span><span class="op">)</span>, <span class="va">action</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">process</span><span class="op">(</span><span class="va">f</span>, <span class="va">action</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">process</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span>, <span class="va">action</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--min"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">min</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--mean"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">action</span> <span class="op">==</span> <span class="st">"--max"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu">cat</span><span class="op">(</span><span class="va">values</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">main</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s try it out. Instead of calculating the mean inflammation of
every patient, we’ll only calculate the mean for the first 10 patients
(rows):</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">head</span> data/inflammation-01.csv <span class="kw">|</span> <span class="ex">Rscript</span> readings-06.R <span class="at">--mean</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">5.45</span></span>
<span><span class="fl">5.425</span></span>
<span><span class="fl">6.1</span></span>
<span><span class="fl">5.9</span></span>
<span><span class="fl">5.55</span></span>
<span><span class="fl">6.225</span></span>
<span><span class="fl">5.975</span></span>
<span><span class="fl">6.65</span></span>
<span><span class="fl">6.625</span></span>
<span><span class="fl">6.525</span></span></code></pre>
</div>
<p>And now we’re done: the program now does everything we set out to
do.</p>
<div id="implementing-wc-in-r" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="implementing-wc-in-r" class="callout-inner">
<h3 class="callout-title">Implementing <code>wc</code> in R</h3>
<div class="callout-content">
<p>Write a program called <code>line-count.R</code> that works like the
Unix <code>wc</code> command:</p>
<ul>
<li>If no filenames are given, it reports the number of lines in
standard input.</li>
<li>If one or more filenames are given, it reports the number of lines
in each, followed by the total number of lines.</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">cat</span> line-count.R</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">commandArgs</span><span class="op">(</span>trailingOnly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">length</span><span class="op">(</span><span class="va">args</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">total_lines</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">filename</span> <span class="kw">in</span> <span class="va">args</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">input</span> <span class="op">&lt;-</span> <span class="fu">readLines</span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span>
<span>      <span class="va">num_lines</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">input</span><span class="op">)</span></span>
<span>      <span class="fu">cat</span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span>
<span>      <span class="fu">cat</span><span class="op">(</span><span class="st">" "</span><span class="op">)</span></span>
<span>      <span class="fu">cat</span><span class="op">(</span><span class="va">num_lines</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span>      <span class="va">total_lines</span> <span class="op">&lt;-</span> <span class="va">total_lines</span> <span class="op">+</span> <span class="va">num_lines</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">length</span><span class="op">(</span><span class="va">args</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">cat</span><span class="op">(</span><span class="st">"Total "</span><span class="op">)</span></span>
<span>      <span class="fu">cat</span><span class="op">(</span><span class="va">total_lines</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">input</span> <span class="op">&lt;-</span> <span class="fu">readLines</span><span class="op">(</span><span class="fu">file</span><span class="op">(</span><span class="st">"stdin"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">num_lines</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">input</span><span class="op">)</span></span>
<span>    <span class="fu">cat</span><span class="op">(</span><span class="va">num_lines</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">main</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Use <code>commandArgs(trailingOnly = TRUE)</code> to obtain a vector
of the command-line arguments that a program was run with.</li>
<li>Avoid silent failures.</li>
<li>Use <code>file("stdin")</code> to connect to a program’s standard
input.</li>
<li>Use <code>cat(vec, sep = "\n")</code> to write the elements of
<code>vec</code> to standard output, one per line.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-06-best-practices-R"><p>Content from <a href="06-best-practices-R.html">Best Practices for Writing R Code</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/06-best-practices-R.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I write R code that other people can understand and
use?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe changes made to code for future reference.</li>
<li>Understand the importance about requirements and dependencies for
your code.</li>
<li>Know when to use setwd().</li>
<li>To identify and segregate distinct components in your code using #
or #-.</li>
<li>Additional best practice recommendations.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="keep-track-of-who-wrote-your-code-and-its-intended-purpose">Keep track of who wrote your code and its intended purpose<a class="anchor" aria-label="anchor" href="#keep-track-of-who-wrote-your-code-and-its-intended-purpose"></a>
</h3>
<p>Starting your code with an annotated description of what the code
does when it is run will help you when you have to look at or change it
in the future. Just one or two lines at the beginning of the file can
save you or someone else a lot of time and effort when trying to
understand what a particular script does.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This is code to replicate the analyses and figures from my 2014 Science</span></span>
<span><span class="co"># paper. Code developed by Sarah Supp, Tracy Teal, and Jon Borelli</span></span></code></pre>
</div>
<p>Also consider version-controlling your code as for example taught by
<a href="https://swcarpentry.github.io/git-novice/" class="external-link">Software Carpentry’s
<code>git-novice</code> lessons</a>. Frequent commits with explanatory,
synoptic commit messages are an elegant way to comment code. <a href="https://support.posit.co/hc/en-us/articles/200532077-Version-Control-with-Git-and-SVN" class="external-link">RStudio
enables this with a Git integration</a>.</p>
</div>
<div class="section level3">
<h3 id="be-explicit-about-the-requirements-and-dependencies-of-your-code">Be explicit about the requirements and dependencies of your
code<a class="anchor" aria-label="anchor" href="#be-explicit-about-the-requirements-and-dependencies-of-your-code"></a>
</h3>
<p>Loading all of the packages that will be necessary to run your code
(using <code>library</code>) is a nice way of indicating which packages
are necessary to run your code. It can be frustrating to make it
two-thirds of the way through a long-running script only to find out
that a dependency hasn’t been installed.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">reshape</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">vegan</span><span class="op">)</span></span></code></pre>
</div>
<p>Another way you can be explicit about the requirements of your code
and improve it’s reproducibility is to limit the “hard-coding” of the
input and output files for your script. If your code will read in data
from a file, define a variable early in your code that stores the path
to that file. For example</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_file</span> <span class="op">&lt;-</span> <span class="st">"data/data.csv"</span></span>
<span><span class="va">output_file</span> <span class="op">&lt;-</span> <span class="st">"data/results.csv"</span></span>
<span></span>
<span><span class="co"># read input</span></span>
<span><span class="va">input_data</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="va">input_file</span><span class="op">)</span></span>
<span><span class="co"># get number of samples in data</span></span>
<span><span class="va">sample_number</span> <span class="op">&lt;-</span> <span class="fu">nrow</span><span class="op">(</span><span class="va">input_data</span><span class="op">)</span></span>
<span><span class="co"># generate results</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">some_other_function</span><span class="op">(</span><span class="va">input_file</span>, <span class="va">sample_number</span><span class="op">)</span></span>
<span><span class="co"># write results</span></span>
<span><span class="fu">write.table</span><span class="op">(</span><span class="va">results</span>, <span class="va">output_file</span><span class="op">)</span></span></code></pre>
</div>
<p>is preferable to</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check</span></span>
<span><span class="va">input_data</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/data.csv"</span><span class="op">)</span></span>
<span><span class="co"># get number of samples in data</span></span>
<span><span class="va">sample_number</span> <span class="op">&lt;-</span> <span class="fu">nrow</span><span class="op">(</span><span class="va">input_data</span><span class="op">)</span></span>
<span><span class="co"># generate results</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">some_other_function</span><span class="op">(</span><span class="st">"data/data.csv"</span>, <span class="va">sample_number</span><span class="op">)</span></span>
<span><span class="co"># write results</span></span>
<span><span class="fu">write.table</span><span class="op">(</span><span class="st">"data/results.csv"</span>, <span class="va">output_file</span><span class="op">)</span></span></code></pre>
</div>
<p>It is also worth considering what the working directory is. If the
working directory must change, it is best to do that at the beginning of
the script.</p>
<div id="be-careful-when-using-setwd" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="be-careful-when-using-setwd" class="callout-inner">
<h3 class="callout-title">Be careful when using
<code>setwd()</code>
</h3>
<div class="callout-content">
<p>One should exercise caution when using <code>setwd()</code>. Changing
directories in a script file can limit reproducibility:</p>
<ul>
<li>
<code>setwd()</code> will return an error if the directory to which
you’re trying to change doesn’t exist or if the user doesn’t have the
correct permissions to access that directory. This becomes a problem
when sharing scripts between users who have organized their directories
differently.</li>
<li>If/when your script terminates with an error, you might leave the
user in a different directory than the one they started in, and if they
then call the script again, this will cause further problems. If you
must use <code>setwd()</code>, it is best to put it at the top of the
script to avoid these problems. The following error message indicates
that R has failed to set the working directory you specified:</li>
</ul>
<pre><code>Error in setwd("~/path/to/working/directory") : cannot change working directory</code></pre>
<p>It is best practice to have the user running the script begin in a
consistent directory on their machine and then use relative file paths
from that directory to access files (see below).</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="identify-and-segregate-distinct-components-in-your-code">Identify and segregate distinct components in your code<a class="anchor" aria-label="anchor" href="#identify-and-segregate-distinct-components-in-your-code"></a>
</h3>
<p>It’s easy to annotate and mark your code using <code>#</code> or
<code>#-</code>to set off sections of your code and to make finding
specific parts of your code easier. For example, it’s often helpful when
writing code to separate the function definitions. If you create only
one or a few custom functions in your script, put them toward the top of
your code. If you have written many functions, put them all in their own
. R file and then<code>source</code> those files. <code>source</code>
will define all of these functions so that your code can make use of
them as needed.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">source</span><span class="op">(</span><span class="st">"my_genius_fxns.R"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="other-ideas">Other ideas<a class="anchor" aria-label="anchor" href="#other-ideas"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Use a consistent style within your code. For example, name all
matrices something ending in <code>_mat</code>. Consistency makes code
easier to read and problems easier to spot.</p></li>
<li><p>Keep your code in bite-sized chunks. If a single function or loop
gets too long, consider looking for ways to break it into smaller
pieces.</p></li>
<li><p>Don’t repeat yourself–automate! If you are repeating the same
code over and over, use a loop or a function to repeat that code for
you. Needless repetition doesn’t just waste time–it also increases the
likelihood you’ll make a costly mistake!</p></li>
<li><p>Keep all of your source files for a <a href="https://posit.co/resources/videos/programming-part-1-writing-code-in-rstudio/" class="external-link">project
in the same directory</a>, then use relative paths as necessary to
access them. For example, use</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"files/dataset-2013-01.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>rather than:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"/Users/Karthik/Documents/sannic-project/files/dataset-2013-01.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<ol start="5" style="list-style-type: decimal">
<li>R can run into memory issues. It is a common problem to run out of
memory after running R scripts for a long time. To inspect the objects
in your current R environment, you can list the objects, search current
packages, and remove objects that are currently not in use. A good
practice when running long lines of computationally intensive code is to
remove temporary objects after they have served their purpose. However,
sometimes, R will not clean up unused memory for a while after you
delete objects. You can force R to tidy up its memory by using
<code>gc()</code>.</li>
</ol>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample dataset of 1000 rows</span></span>
<span><span class="va">interim_object</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                             <span class="fu">rep</span><span class="op">(</span><span class="fl">101</span><span class="op">:</span><span class="fl">200</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                             <span class="fu">rep</span><span class="op">(</span><span class="fl">201</span><span class="op">:</span><span class="fl">300</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">object.size</span><span class="op">(</span><span class="va">interim_object</span><span class="op">)</span> <span class="co"># Reports the memory size allocated to the object</span></span>
<span><span class="fu">rm</span><span class="op">(</span><span class="st">"interim_object"</span><span class="op">)</span> <span class="co"># Removes only the object itself and not necessarily the memory allotted to it</span></span>
<span><span class="fu">gc</span><span class="op">(</span><span class="op">)</span> <span class="co"># Force R to release memory it is no longer using</span></span>
<span><span class="fu">ls</span><span class="op">(</span><span class="op">)</span> <span class="co"># Lists all the objects in your current workspace</span></span>
<span><span class="fu">rm</span><span class="op">(</span>list <span class="op">=</span> <span class="fu">ls</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># If you want to delete all the objects in the workspace and start with a clean slate</span></span></code></pre>
</div>
<ol start="6" style="list-style-type: decimal">
<li><p><a href="https://datacarpentry.org/R-ecology-lesson/00-before-we-start.html#getting-set-up" class="external-link">Don’t
save a session history</a> (the default option in R, when it asks if you
want an <code>RData</code> file). Instead, start in a clean environment
so that older objects don’t remain in your environment any longer than
they need to. If that happens, it can lead to unexpected
results.</p></li>
<li><p>Wherever possible, <a href="https://stackoverflow.com/a/21967272/4341322" class="external-link">keep track of
<code>sessionInfo()</code> somewhere</a> in your project folder. Session
information is invaluable because it captures all of the packages used
in the current project. If a newer version of a package changes the way
a function behaves, you can always go back and reinstall the version
that worked (Note: At least on CRAN, all older versions of packages are
permanently archived).</p></li>
<li><p>Collaborate. Grab a buddy and practice “code review”. Review is
used for preparing experiments and manuscripts; why not use it for code
as well? Our code is also a major scientific achievement and the product
of lots of hard work! Reviews are built into <a href="https://github.com/skills/review-pull-requests" class="external-link">GitHub’s Pull
request feature</a></p></li>
</ol>
<div id="best-practice" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="best-practice" class="callout-inner">
<h3 class="callout-title">Best Practice</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What other suggestions do you have for coding best practices?</li>
<li>What are some specific ways we could restructure the code we worked
on today to make it easier for a new user to read? Discuss with your
neighbor.</li>
<li>Make two new R scripts called <code>inflammation.R</code> and
<code>inflammation_fxns.R</code>. Copy and paste code into each script
so that <code>inflammation.R</code> “does stuff” and
<code>inflammation_fxns.R</code> holds all of your functions.
<strong>Hint</strong>: you will need to add <code>source</code> to one
of the files.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">cat</span> inflammation.R</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co"># This code runs the inflammation data analysis.</span></span>
<span></span>
<span><span class="kw">source</span><span class="op">(</span><span class="st">"inflammation_fxns.R"</span><span class="op">)</span></span>
<span><span class="fu">analyze_all</span><span class="op">(</span><span class="st">"inflammation.*csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">cat</span> inflammation_fxns.R</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co"># This is code for functions used in our inflammation data analysis.</span></span>
<span></span>
<span><span class="va">analyze</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span>, <span class="va">output</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Plots the average, min, and max inflammation over time.</span></span>
<span>  <span class="co"># Input:</span></span>
<span>  <span class="co">#    filename: character string of a csv file</span></span>
<span>  <span class="co">#    output: character string of pdf file for saving</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">pdf</span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">avg_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">avg_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">max_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">max_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">min_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">min</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">min_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is.null</span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">dev.off</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">analyze_all</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pattern</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Directory name containing the data</span></span>
<span>  <span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="st">"data"</span></span>
<span>  <span class="co"># Directory name for results</span></span>
<span>  <span class="va">results_dir</span> <span class="op">&lt;-</span> <span class="st">"results"</span></span>
<span>  <span class="co"># Runs the function analyze for each file in the current working directory</span></span>
<span>  <span class="co"># that contains the given pattern.</span></span>
<span>  <span class="va">filenames</span> <span class="op">&lt;-</span> <span class="fu">list.files</span><span class="op">(</span>path <span class="op">=</span> <span class="va">data_dir</span>, pattern <span class="op">=</span> <span class="va">pattern</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pdf_name</span> <span class="op">&lt;-</span> <span class="fu">file.path</span><span class="op">(</span><span class="va">results_dir</span>, <span class="fu">sub</span><span class="op">(</span><span class="st">"csv"</span>, <span class="st">"pdf"</span>, <span class="va">f</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">analyze</span><span class="op">(</span><span class="fu">file.path</span><span class="op">(</span><span class="va">data_dir</span>, <span class="va">f</span><span class="op">)</span>, output <span class="op">=</span> <span class="va">pdf_name</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Start each program with a description of what it does.</li>
<li>Then load all required packages.</li>
<li>Consider what working directory you are in when sourcing a
script.</li>
<li>Use comments to mark off sections of code.</li>
<li>Put function definitions at the top of your file, or in a separate
file if there are many.</li>
<li>Name and style code consistently.</li>
<li>Break code into small, discrete pieces.</li>
<li>Factor out common operations rather than repeating them.</li>
<li>Keep all of the source files for a project in one directory and use
relative paths to access them.</li>
<li>Keep track of the memory used by your program.</li>
<li>Always start with a clean environment instead of saving the
workspace.</li>
<li>Keep track of session information in your project folder.</li>
<li>Have someone else review your code.</li>
<li>Use version control.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-07-knitr-R"><p>Content from <a href="07-knitr-R.html">Dynamic Reports with knitr</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/07-knitr-R.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I put my text, code, and results all in one document?</li>
<li>How do I use <code>knitr</code>?</li>
<li>How do I write in Markdown?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the value of <code>knitr</code> for generating dynamic
documents that include text, code, and results.</li>
<li>Control basic formatting using markdown syntax.</li>
<li>Be able to create, edit, and compile an .Rmd document including code
chunks and inline code.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p><code>knitr</code> is an R package that allows you to organize your
notes, code, and results in a single document. It’s a great tool for
“literate programming” – the idea that your code should be readable by
humans as well as computers! It also keeps your writing and results
together, so if you collect some new data or change how you clean the
data, you just have to re-compile the document and you’re up to
date!</p>
<p>You write <code>knitr</code> documents in a simple plain text-like
format called markdown, which allows you to format text using intuitive
notation, so that you can focus on the content you’re writing and
generating a well-formatted document when needed. In fact, you can turn
your plain text (and R code and results) into an HTML file or, if you
have an installation of LaTeX and <a href="https://pandoc.org/" class="external-link">Pandoc</a> on your machine, a PDF, or even a
Word document (if you must!).</p>
<p>To get started, install the <code>knitr</code> package.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"knitr"</span><span class="op">)</span></span></code></pre>
</div>
<p>To create a new <code>knitr</code> document in RStudio, click on File
-&gt; New File, and then select “R Markdown…” from the dropdown list.
Accept the default options in the dialog box that follows (but note the
other document formats to choose from, including presentations). Save
the file and click on the dropdown arrow next to the “Knit” button at
the top of the script window. This will bring up another dropdown menu,
this time with a number of options for controlling <code>knitr</code>
output. Select the “Knit to HTML” option to create an HTML document
based on the markdown file. Compare the output to the source.</p>
<div id="formatting-text-in-markdown" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="formatting-text-in-markdown" class="callout-inner">
<h3 class="callout-title">Formatting Text in Markdown</h3>
<div class="callout-content">
<p>Visit <a href="https://rmarkdown.rstudio.com/authoring_basics.html" class="external-link uri">https://rmarkdown.rstudio.com/authoring_basics.html</a> and
briefly check out some of the formatting options.</p>
<p>In the example document add</p>
<ul>
<li>Headers using <code>#</code>
</li>
<li>Emphasis using asterisk: *italics* and **bold**</li>
<li>Lists using <code>*</code> and numbered lists using <code>1.</code>,
<code>2.</code>, etc.</li>
<li>
<strong>Bonus:</strong> Create a table</li>
</ul>
</div>
</div>
</div>
<p>Markdown also supports LaTeX equation editing. We can display pretty
equations by enclosing them in <code>$</code>, e.g.,
<code>$\alpha = \dfrac{1}{(1 - \beta)^2}$</code> renders as: <span class="math inline">\(\alpha = \dfrac{1}{(1 - \beta)^2}\)</span></p>
<p>The top of the source (<code>.Rmd</code>) file has some header
material in YAML format (enclosed by triple dashes). Some of this gets
displayed in the output header, other of it provides formatting
information to the conversion engine.</p>
<p>To distinguish R code from text, RMarkdown uses three back-ticks
followed by <code>{r}</code> to distinguish a “code chunk”. In RStudio,
the keyboard shortcut to create a code chunk is
<kbd>Command</kbd>+<kbd>Option</kbd>+<kbd>I</kbd> or
<kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>I</kbd>.</p>
<p>A code chunk will set off the code and its results in the output
document, but you can also print the results of code within a text block
by enclosing code like so: <code>r code-here</code>.</p>
<div id="use-knitr-to-produce-a-report" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="use-knitr-to-produce-a-report" class="callout-inner">
<h3 class="callout-title">Use knitr to Produce a Report</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Open a new .Rmd script and save it as inflammation_report.Rmd</li>
<li>Copy code from earlier into code chunks to read the inflammation
data and plot average inflammation.</li>
<li>Add a few notes describing what the code does and what the main
findings are. Include an in-line calculation of the median inflammation
level.</li>
<li>
<code>knit</code> the document and view the html result.</li>
</ol>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Use knitr to generate reports that combine text, code, and
results.</li>
<li>Use Markdown to format text.</li>
<li>Put code in blocks delimited by triple back quotes followed by
<code>{r}</code>.</li>
</ul>
</div>
</div>
</div></section><section id="aio-08-making-packages-R"><p>Content from <a href="08-making-packages-R.html">Making Packages in R</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/08-making-packages-R.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 35 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I collect my code together so I can reuse it and share
it?</li>
<li>How do I make my own packages?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the required structure of R packages.</li>
<li>Create the required structure of a simple R package.</li>
<li>Write documentation comments that can be automatically compiled to
R’s native help and documentation format.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Why should you make your own R packages?</p>
<p><strong>Reproducible research!</strong></p>
<p>An R package is the <strong>basic unit of reusable code</strong>. If
you want to reuse code later or want others to be able to use your code,
you should put it in a package.</p>
<p>An R package requires four components, visualized in the folder tree
below:</p>
<pre><code>package_name/
├── DESCRIPTION              # metadata about the package
├── man/                     # function documentation (can be generated automatically)
├── NAMESPACE                # list of user-level functions in the package (can be generated automatically)
├── R/                       # R source code
└── &lt;other_components&gt;</code></pre>
<p><em>There are other optional components. <a href="https://devguide.ropensci.org/building.html" class="external-link">rOpenSci
community</a> has written a science-focused guidebook for package
development, while <a href="https://r-pkgs.org/description.html" class="external-link">the “R
packages” book</a> contains all the fundamental information.</em></p>
<div class="section level3">
<h3 id="description-file">DESCRIPTION file<a class="anchor" aria-label="anchor" href="#description-file"></a>
</h3>
<pre class="source"><code>Package: package_name
Title: Brief package description
Description: Longer package description
Version: Version number(major.minor.patch)
Author: Name and email of package creator
Maintainer: Name and email of package maintainer (who to contact with issues)
License: Abbreviation for an open source license</code></pre>
<p>The package name can only contain letters and numbers and has to
start with a letter.</p>
</div>
<div class="section level3">
<h3 id="r-files">.R files<a class="anchor" aria-label="anchor" href="#r-files"></a>
</h3>
<p>Functions don’t all have to be in one file or each in separate files.
How you organize them is up to you. Suggestion: organize in a logical
manner so that you know which file holds which functions.</p>
</div>
<div class="section level3">
<h3 id="making-your-first-r-package">Making your first R package<a class="anchor" aria-label="anchor" href="#making-your-first-r-package"></a>
</h3>
<p>Let’s turn our temperature conversion functions into an R
package.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fahrenheit_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp_F</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Converts Fahrenheit to Celsius</span></span>
<span>  <span class="va">temp_C</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">temp_F</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">temp_C</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">celsius_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp_C</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Converts Celsius to Kelvin</span></span>
<span>  <span class="va">temp_K</span> <span class="op">&lt;-</span> <span class="va">temp_C</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">temp_K</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fahrenheit_to_kelvin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp_F</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Converts Fahrenheit to Kelvin using fahrenheit_to_celsius() and celsius_to_kelvin()</span></span>
<span>  <span class="va">temp_C</span> <span class="op">&lt;-</span> <span class="fu">fahrenheit_to_celsius</span><span class="op">(</span><span class="va">temp_F</span><span class="op">)</span></span>
<span>  <span class="va">temp_K</span> <span class="op">&lt;-</span> <span class="fu">celsius_to_kelvin</span><span class="op">(</span><span class="va">temp_C</span><span class="op">)</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">temp_K</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>We will use the <a href="https://cran.r-project.org/package=devtools" class="external-link">devtools</a> and <a href="https://cran.r-project.org/package=roxygen2" class="external-link">roxygen2</a>
packages, which make creating packages in R relatively simple. Both can
be installed from CRAN like this:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"devtools"</span>, <span class="st">"roxygen2"</span><span class="op">)</span><span class="op">)</span>  <span class="co"># installations can be `c`ombined</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="st">"roxygen2"</span><span class="op">)</span></span></code></pre>
</div>
<p>Set your working directory, and then use the <code>create</code>
function to start making your package. Keep the name simple and
unique.</p>
<ul>
<li>package_to_convert_temperatures_between_kelvin_fahrenheit_and_celsius
(BAD)</li>
<li>tempConvert (GOOD)</li>
</ul>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">setwd</span><span class="op">(</span><span class="va">parentDirectory</span><span class="op">)</span></span>
<span><span class="fu">create_package</span><span class="op">(</span><span class="st">"tempConvert"</span><span class="op">)</span></span></code></pre>
</div>
<p>Add our functions to the R directory. Place each function into a
separate R script and add documentation like this:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Converts Fahrenheit to Celsius</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This function converts input temperatures in Fahrenheit to Celsius.</span></span>
<span><span class="co">#' @param temp_F The temperature in Fahrenheit.</span></span>
<span><span class="co">#' @return The temperature in Celsius.</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' fahrenheit_to_celsius(32)</span></span>
<span></span>
<span><span class="va">fahrenheit_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp_F</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">temp_C</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">temp_F</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">temp_C</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>The <code>roxygen2</code> package reads lines that begin with
<code>#'</code> as comments to create the documentation for your
package. Descriptive tags are preceded with the <code>@</code> symbol.
For example, <code>@param</code> has information about the input
parameters for the function. Now, we will use <code>roxygen2</code> to
convert our documentation to the standard R format.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">setwd</span><span class="op">(</span><span class="st">"./tempConvert"</span><span class="op">)</span></span>
<span><span class="fu">document</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Take a look at the package directory now. The /man directory has a .
Rd file for each . R file with properly formatted documentation.</p>
<p>Overall, your package directory should look something like this:</p>
<figure><img src="../fig/R-package-structure.svg" alt="tempConvert directory containing 4 items: Namespace file, Description file, man directory with documentation in .Rd files, R directory with functions in .R files" width="500" class="figure mx-auto d-block"></figure><p>In the diagram above, your package is a folder (the same as it would
exist on your computer!). This folder contains several files and
sub-folders. For example, the folder ‘R’ contains all of the R scripts
you just wrote above. Now, let’s load the package and take a look at the
documentation.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">setwd</span><span class="op">(</span><span class="st">".."</span><span class="op">)</span></span>
<span><span class="fu">install</span><span class="op">(</span><span class="st">"tempConvert"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">?</span><span class="va">fahrenheit_to_kelvin</span></span></code></pre>
</div>
<p>Notice there is now a tempConvert environment that is the parent
environment to the global environment.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">search</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Now that our package is loaded, let’s try out some of the
functions.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fahrenheit_to_celsius</span><span class="op">(</span><span class="fl">32</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">celsius_to_kelvin</span><span class="op">(</span><span class="op">-</span><span class="fl">273.15</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fahrenheit_to_kelvin</span><span class="op">(</span><span class="op">-</span><span class="fl">459.67</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<div id="creating-a-package-for-distribution" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="creating-a-package-for-distribution" class="callout-inner">
<h3 class="callout-title">Creating a Package for Distribution</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create some new functions for your tempConvert package to convert
from Celsius to Fahrenheit or from Kelvin to Celsius or Fahrenheit.</li>
<li>Create a package for our <code>analyze</code> function so that it
will be easy to load when more data arrives.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Converts Kelvin to Celsius</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This function converts input temperatures in Kelvin to Celsius.</span></span>
<span><span class="co">#' @param temp_K The temperature in Kelvin.</span></span>
<span><span class="co">#' @return The temperature in Celsius.</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' kelvin_to_celsius(273.15)</span></span>
<span></span>
<span><span class="va">kelvin_to_celsius</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp_K</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">temp_C</span> <span class="op">&lt;-</span> <span class="va">temp_K</span> <span class="op">-</span> <span class="fl">273.15</span></span>
<span>  <span class="va">temp_C</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Converts Celsius to Fahrenheit</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This function converts input temperatures in Celsius to Fahrenheit.</span></span>
<span><span class="co">#' @param temp_C The temperature in Celsius.</span></span>
<span><span class="co">#' @return The temperature in Fahrenheit.</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' celsius_to_fahrenheit(0)</span></span>
<span></span>
<span><span class="va">celsius_to_fahrenheit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp_C</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">temp_F</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">temp_C</span> <span class="op">*</span> <span class="fl">9</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">32</span></span>
<span>  <span class="va">temp_F</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Converts Kelvin to Fahrenheit</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This function converts input temperatures in Kelvin to Fahrenheit.</span></span>
<span><span class="co">#' @param temp_K The temperature in Kelvin.</span></span>
<span><span class="co">#' @return The temperature in Fahrenheit.</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' kelvin_to_fahrenheit(273.15)</span></span>
<span></span>
<span><span class="va">kelvin_to_fahrenheit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp_K</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">temp_C</span> <span class="op">&lt;-</span> <span class="fu">kelvin_to_celsius</span><span class="op">(</span><span class="va">temp_K</span><span class="op">)</span></span>
<span>  <span class="va">temp_F</span> <span class="op">&lt;-</span> <span class="fu">celsius_to_fahrenheit</span><span class="op">(</span><span class="va">temp_C</span><span class="op">)</span></span>
<span>  <span class="va">temp_F</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>A package is the basic unit of reusability in R.</li>
<li>Every package must have a DESCRIPTION file and an R directory
containing code. These are created by us.</li>
<li>A NAMESPACE file is needed as well, and a man directory containing
documentation, but both can be autogenerated.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-09-supp-intro-rstudio"><p>Content from <a href="09-supp-intro-rstudio.html">Introduction to RStudio</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/09-supp-intro-rstudio.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I use the RStudio graphical user interface?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Get familiar with RStudio interface.</li>
<li>Understand the difference between script file and console.</li>
<li>Demonstrate useful shortcuts.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Let’s start by learning about our tool.</p>
<ul>
<li>Point to the different panels: Console, Scripts, Environments,
Plots.</li>
<li>Code and workflow are more reproducible if we can document
everything that we do.</li>
<li>Our end goal is not just to “do stuff” but to do it in a way that
anyone can easily and exactly replicate our workflow and results.</li>
<li>The best way to achieve this is to write scripts. RStudio provides
an environment that allows you to do that.</li>
</ul>
<section><h2 class="section-heading" id="interacting-with-r">Interacting with R<a class="anchor" aria-label="anchor" href="#interacting-with-r"></a>
</h2>
<hr class="half-width">
<p>There are two main ways of interacting with R: using the console or
by using script files (plain text files that contain your code).</p>
<p>The console window (in RStudio, the bottom left panel) is the place
where R is waiting for you to tell it what to do, and where it will show
the results of a command. You can type commands directly into the
console, but they will be forgotten when you close the session. It is
better to enter the commands in the script editor, and save the script.
This way, you have a complete record of what you did, you can easily
show others how you did it and you can do it again later on if needed.
You can copy-paste into the R console, but the Rstudio script editor
allows you to ‘send’ the current line or the currently selected text to
the R console using the <kbd>Ctrl</kbd>+<kbd>Return</kbd> shortcut.</p>
<p>At some point in your analysis you may want to check the content of
variable or the structure of an object, without necessarily keep a
record of it in your script. You can type these commands directly in the
console. RStudio provides the <kbd>Ctrl</kbd>+<kbd>1</kbd> and
<kbd>Ctrl</kbd>+<kbd>2</kbd> shortcuts allow you to jump between the
script and the console windows.</p>
<p>If R is ready to accept commands, the R console shows a
<code>&gt;</code> prompt. If it receives a command (by typing,
copy-pasting or sent from the script editor using
<kbd>Ctrl</kbd>+<kbd>Return</kbd>), R will try to execute it, and when
ready, show the results and come back with a new
<code>&gt;</code>-prompt to wait for new commands.</p>
<p>If R is still waiting for you to enter more data because it isn’t
complete yet, the console will show a <code>+</code> prompt. It means
that you haven’t finished entering a complete command. This is because
you have not ‘closed’ a parenthesis or quotation. If you’re in RStudio
and this happens, click inside the console window and press
<kbd>Esc</kbd>; this should help you out of trouble.</p>
</section><section><h2 class="section-heading" id="commenting">Commenting<a class="anchor" aria-label="anchor" href="#commenting"></a>
</h2>
<hr class="half-width">
<p>Use <code>#</code> signs to comment. Comment liberally in your R
scripts. Anything to the right of a <code>#</code> is ignored by R.
Comments remind yourself of what certain functions you write do, and it
helps others understand their purpose without having to read the code.
Start your comments with a <code>#</code> signs, which R takes as the
sign to ignore anything to the right of it when running the code. To
comment multiple lines in RStudio, you can select the lines you want to
comment and use <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>C</kbd> to
comment/uncomment.</p>
<p>Also remember that expressive naming of functions, arguments and
variables, as well as <a href="08-making-packages-R.html"><code>#'</code>-prefixed roxygen
documentation</a>, document your code. Consider free-form, #-comments as
a last resort.</p>
</section><section><h2 class="section-heading" id="assignment-operator">Assignment Operator<a class="anchor" aria-label="anchor" href="#assignment-operator"></a>
</h2>
<hr class="half-width">
<p><code>&lt;-</code> is the assignment operator. It assigns values on
the right to objects on the left. So, after executing
<code>x &lt;- 3</code>, the value of <code>x</code> is <code>3</code>.
The arrow can be read as 3 <strong>goes into</strong> <code>x</code>.
You can also use <code>=</code> for assignments but not in all contexts
so it is good practice to use <code>&lt;-</code> for assignments.
<code>=</code> should only be used to specify the values of arguments in
functions, see below.</p>
<p>In RStudio, typing <kbd>Alt</kbd>+<kbd>-</kbd> (push <kbd>Alt</kbd>,
the key next to your space bar at the same time as the <kbd>-</kbd> key)
will write <code>&lt;-</code> in a single keystroke.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Using RStudio can make programming in R much more productive.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-10-supp-addressing-data"><p>Content from <a href="10-supp-addressing-data.html">Addressing Data</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/10-supp-addressing-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the different methods for accessing parts of a data
frame?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the three different ways R can address data inside a data
frame.</li>
<li>Combine different methods for addressing data with the assignment
operator to update subsets of data.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>R is a powerful language for data manipulation. There are three main
ways for addressing data inside R objects.</p>
<ul>
<li>By index (subsetting)</li>
<li>By logical vector</li>
<li>By name</li>
</ul>
<p>Lets start by loading some sample data:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'data/sample.csv'</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div id="interpreting-rows-as-headers" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="interpreting-rows-as-headers" class="callout-inner">
<h3 class="callout-title">Interpreting Rows as Headers</h3>
<div class="callout-content">
<p>The first row of this csv file is a list of column names. We used the
<em>header = TRUE</em> argument to <code>read.csv</code> so that R can
interpret the file correctly. We are using the <em>stringsAsFactors =
FALSE</em> argument to override the default behaviour for R. Using
factors in R is covered in a separate lesson.</p>
</div>
</div>
</div>
<p>Lets take a look at this data.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "data.frame"</code></pre>
</div>
<p>R has loaded the contents of the .csv file into a variable called
<code>dat</code> which is a <code>data frame</code>.</p>
<p>We can compactly display the internal structure of a data frame using
the structure function <code>str</code>.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	100 obs. of  9 variables:
 $ ID           : chr  "Sub001" "Sub002" "Sub003" "Sub004" ...
 $ Gender       : chr  "m" "m" "m" "f" ...
 $ Group        : chr  "Control" "Treatment2" "Treatment2" "Treatment1" ...
 $ BloodPressure: int  132 139 130 105 125 112 173 108 131 129 ...
 $ Age          : num  16 17.2 19.5 15.7 19.9 14.3 17.7 19.8 19.4 18.8 ...
 $ Aneurisms_q1 : int  114 148 196 199 188 260 135 216 117 188 ...
 $ Aneurisms_q2 : int  140 209 251 140 120 266 98 238 215 144 ...
 $ Aneurisms_q3 : int  202 248 122 233 222 320 154 279 181 192 ...
 $ Aneurisms_q4 : int  237 248 177 220 228 294 245 251 272 185 ...</code></pre>
</div>
<p>The <code>str</code> function tell us that the data has 100 rows and
9 columns. It is also tell us that the data frame is made up of
character <code>chr</code>, integer <code>int</code> and
<code>numeric</code> vectors.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      ID Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
1 Sub001      m    Control           132 16.0          114          140
2 Sub002      m Treatment2           139 17.2          148          209
3 Sub003      m Treatment2           130 19.5          196          251
4 Sub004      f Treatment1           105 15.7          199          140
5 Sub005      m Treatment1           125 19.9          188          120
6 Sub006      M Treatment2           112 14.3          260          266
  Aneurisms_q3 Aneurisms_q4
1          202          237
2          248          248
3          122          177
4          233          220
5          222          228
6          320          294</code></pre>
</div>
<p>The data is the results of an (not real) experiment, looking at the
number of aneurysms that formed in the eyes of patients who undertook 3
different treatments.</p>
<div class="section level3">
<h3 id="addressing-by-index">Addressing by Index<a class="anchor" aria-label="anchor" href="#addressing-by-index"></a>
</h3>
<p>Data can be accessed by index. We have already seen how square
brackets <code>[</code> can be used to subset data (sometimes also
called “slicing”). The generic format is
<code>dat[row_numbers,column_numbers]</code>.</p>
<div id="selecting-values" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="selecting-values" class="callout-inner">
<h3 class="callout-title">Selecting Values</h3>
<div class="callout-content">
<p>What will be returned by <code>dat[1, 1]</code>? Think about the
number of rows and columns you would expect as the result.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Sub001"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>If we leave out a dimension R will interpret this as a request for
all values in that dimension.</p>
<div id="selecting-more-values" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="selecting-more-values" class="callout-inner">
<h3 class="callout-title">Selecting More Values</h3>
<div class="callout-content">
<p>What will be returned by <code>dat[, 2]</code>?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] "m" "m" "m" "f" "m" "M" "f" "m" "m" "f" "m" "f" "f" "m" "m" "m" "f" "m"
 [19] "m" "F" "f" "m" "f" "f" "m" "M" "M" "f" "m" "f" "f" "m" "m" "m" "m" "f"
 [37] "f" "m" "M" "m" "f" "m" "m" "m" "f" "f" "M" "M" "m" "m" "m" "f" "f" "f"
 [55] "m" "f" "m" "m" "m" "f" "f" "f" "f" "M" "f" "m" "f" "f" "M" "m" "m" "m"
 [73] "F" "m" "m" "f" "M" "M" "M" "f" "m" "M" "M" "m" "m" "f" "f" "f" "m" "m"
 [91] "f" "m" "F" "f" "m" "m" "F" "m" "M" "M"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The colon <code>:</code> can be used to create a sequence of
integers.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">6</span><span class="op">:</span><span class="fl">9</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6 7 8 9</code></pre>
</div>
<p>Creates a vector of numbers from 6 to 9.</p>
<p>This can be very useful for addressing data.</p>
<div id="subsetting-with-sequences" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="subsetting-with-sequences" class="callout-inner">
<h3 class="callout-title">Subsetting with Sequences</h3>
<div class="callout-content">
<p>Use the colon operator to index just the aneurism count data (columns
6 to 9).</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">[</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    Aneurisms_q1 Aneurisms_q2 Aneurisms_q3 Aneurisms_q4
1            114          140          202          237
2            148          209          248          248
3            196          251          122          177
4            199          140          233          220
5            188          120          222          228
6            260          266          320          294
7            135           98          154          245
8            216          238          279          251
9            117          215          181          272
10           188          144          192          185
11           134          155          247          223
12           152          177          323          245
13           112          220          225          195
14           109          150          177          189
15           146          140          239          223
16            97          172          203          207
17           165          157          200          193
18           158          265          243          187
19           178          109          206          182
20           107          188          167          218
21           174          160          203          183
22            97          110          194          133
23           187          239          281          214
24           188          191          256          265
25           114          199          242          195
26           115          160          158          228
27           128          249          294          315
28           112          230          281          126
29           136          109          105          155
30           103          148          219          228
31           132          151          234          162
32           118          154          260          160
33           166          176          253          233
34           152          105          197          299
35           191          148          166          185
36           152          178          158          170
37           161          270          232          284
38           239          184          317          269
39           132          137          193          206
40           168          255          273          274
41           140          184          239          202
42           166           85          179          196
43           141          160          179          239
44           161          168          212          181
45           103          111          254          126
46           231          240          260          310
47           192          141          180          225
48           178          180          169          183
49           167          123          236          224
50           135          150          208          279
51           150          166          153          204
52           192           80          138          222
53           153          153          236          216
54           205          264          269          207
55           117          194          216          211
56           199          119          183          251
57           182          129          226          218
58           180          196          250          294
59           111          111          244          201
60           101           98          178          116
61           166          167          232          241
62           158          171          237          212
63           189          178          177          238
64           189          101          193          172
65           239          189          297          300
66           185          224          151          182
67           224          112          304          288
68           104          139          211          204
69           222          199          280          196
70           107           98          204          138
71           153          255          218          234
72           118          165          220          227
73           102          184          246          222
74           188          125          191          157
75           180          283          204          298
76           178          214          291          240
77           168          184          184          229
78           118          170          249          249
79           169          114          248          233
80           156          138          218          258
81           232          211          219          246
82           188          108          180          136
83           169          168          180          211
84           241          233          292          182
85            65          207          234          235
86           225          185          195          235
87           104          116          173          221
88           179          158          216          244
89           103          140          209          186
90           112          130          175          191
91           226          170          307          244
92           228          221          316          259
93           209          142          199          184
94           153          104          194          214
95           111          118          173          191
96           148          132          200          194
97           141          196          322          273
98           193          112          123          181
99           130          226          286          281
100          126          157          129          160</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Finally we can use the <code>c()</code> (combine) function to address
non-sequential rows and columns.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      ID Gender      Group BloodPressure  Age
1 Sub001      m    Control           132 16.0
5 Sub005      m Treatment1           125 19.9
7 Sub007      f    Control           173 17.7
9 Sub009      m Treatment2           131 19.4</code></pre>
</div>
<p>Returns the first 5 columns for patients in rows 1,5,7 and 9</p>
<div id="subsetting-non-sequential-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="subsetting-non-sequential-data" class="callout-inner">
<h3 class="callout-title">Subsetting Non-Sequential Data</h3>
<div class="callout-content">
<p>Write code to return the age and gender values for the first 5
patients.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Age Gender
1 16.0      m
2 17.2      m
3 19.5      m
4 15.7      f
5 19.9      m</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="addressing-by-name">Addressing by Name<a class="anchor" aria-label="anchor" href="#addressing-by-name"></a>
</h3>
<p>Columns in an R data frame are named.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colnames</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "ID"            "Gender"        "Group"         "BloodPressure"
[5] "Age"           "Aneurisms_q1"  "Aneurisms_q2"  "Aneurisms_q3"
[9] "Aneurisms_q4" </code></pre>
</div>
<div id="default-names" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="default-names" class="callout-inner">
<h3 class="callout-title">Default Names</h3>
<div class="callout-content">
<p>If column names are not specified e.g. using
<code>header = FALSE</code> in a <code>read.csv()</code> function, R
assigns default names <code>V1, V2, ..., Vn</code></p>
</div>
</div>
</div>
<p>We usually use the <code>$</code> operator to address a column by
name</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">$</span><span class="va">Gender</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] "m" "m" "m" "f" "m" "M" "f" "m" "m" "f" "m" "f" "f" "m" "m" "m" "f" "m"
 [19] "m" "F" "f" "m" "f" "f" "m" "M" "M" "f" "m" "f" "f" "m" "m" "m" "m" "f"
 [37] "f" "m" "M" "m" "f" "m" "m" "m" "f" "f" "M" "M" "m" "m" "m" "f" "f" "f"
 [55] "m" "f" "m" "m" "m" "f" "f" "f" "f" "M" "f" "m" "f" "f" "M" "m" "m" "m"
 [73] "F" "m" "m" "f" "M" "M" "M" "f" "m" "M" "M" "m" "m" "f" "f" "f" "m" "m"
 [91] "f" "m" "F" "f" "m" "m" "F" "m" "M" "M"</code></pre>
</div>
<p>When we extract a single column from a data frame using the
<code>$</code> operator, R will return a vector of that column class and
not a data frame.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Gender</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">BloodPressure</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "integer"</code></pre>
</div>
<p>Named addressing can also be used in square brackets.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fu">c</span><span class="op">(</span><span class="st">'Age'</span>, <span class="st">'Gender'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   Age Gender
1 16.0      m
2 17.2      m
3 19.5      m
4 15.7      f
5 19.9      m
6 14.3      M</code></pre>
</div>
<div id="best-practice" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="best-practice" class="callout-inner">
<h3 class="callout-title">Best Practice</h3>
<div class="callout-content">
<p>Best practice is to address columns by name. Often, you will create
or delete columns and the column position will change.</p>
</div>
</div>
</div>
<p><br></p>
<p>Rows in an R data frame can also be named, and rows can also be
addressed by their names. <br> By default, row names are indices
(i.e. position of each row in the data frame):</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rownames</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] "1"   "2"   "3"   "4"   "5"   "6"   "7"   "8"   "9"   "10"  "11"  "12"
 [13] "13"  "14"  "15"  "16"  "17"  "18"  "19"  "20"  "21"  "22"  "23"  "24"
 [25] "25"  "26"  "27"  "28"  "29"  "30"  "31"  "32"  "33"  "34"  "35"  "36"
 [37] "37"  "38"  "39"  "40"  "41"  "42"  "43"  "44"  "45"  "46"  "47"  "48"
 [49] "49"  "50"  "51"  "52"  "53"  "54"  "55"  "56"  "57"  "58"  "59"  "60"
 [61] "61"  "62"  "63"  "64"  "65"  "66"  "67"  "68"  "69"  "70"  "71"  "72"
 [73] "73"  "74"  "75"  "76"  "77"  "78"  "79"  "80"  "81"  "82"  "83"  "84"
 [85] "85"  "86"  "87"  "88"  "89"  "90"  "91"  "92"  "93"  "94"  "95"  "96"
 [97] "97"  "98"  "99"  "100"</code></pre>
</div>
<p>We can add row names as we read in the file with the
<code>row.names</code> parameter in <code>read.csv</code>.</p>
<p>In the following example, we choose the first column <em>ID</em> to
become the vector of row names of the data frame, with
<code>row.names = 1</code>.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'data/sample.csv'</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>, row.names<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">rownames</span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] "Sub001" "Sub002" "Sub003" "Sub004" "Sub005" "Sub006" "Sub007" "Sub008"
  [9] "Sub009" "Sub010" "Sub011" "Sub012" "Sub013" "Sub014" "Sub015" "Sub016"
 [17] "Sub017" "Sub018" "Sub019" "Sub020" "Sub021" "Sub022" "Sub023" "Sub024"
 [25] "Sub025" "Sub026" "Sub027" "Sub028" "Sub029" "Sub030" "Sub031" "Sub032"
 [33] "Sub033" "Sub034" "Sub035" "Sub036" "Sub037" "Sub038" "Sub039" "Sub040"
 [41] "Sub041" "Sub042" "Sub043" "Sub044" "Sub045" "Sub046" "Sub047" "Sub048"
 [49] "Sub049" "Sub050" "Sub051" "Sub052" "Sub053" "Sub054" "Sub055" "Sub056"
 [57] "Sub057" "Sub058" "Sub059" "Sub060" "Sub061" "Sub062" "Sub063" "Sub064"
 [65] "Sub065" "Sub066" "Sub067" "Sub068" "Sub069" "Sub070" "Sub071" "Sub072"
 [73] "Sub073" "Sub074" "Sub075" "Sub076" "Sub077" "Sub078" "Sub079" "Sub080"
 [81] "Sub081" "Sub082" "Sub083" "Sub084" "Sub085" "Sub086" "Sub087" "Sub088"
 [89] "Sub089" "Sub090" "Sub091" "Sub092" "Sub093" "Sub094" "Sub095" "Sub096"
 [97] "Sub097" "Sub098" "Sub099" "Sub100"</code></pre>
</div>
<p>We can now extract one or more rows using those row names:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat2</span><span class="op">[</span><span class="st">"Sub072"</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       Gender   Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2 Aneurisms_q3
Sub072      m Control           116 17.4          118          165          220
       Aneurisms_q4
Sub072          227</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat2</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="st">"Sub009"</span>, <span class="st">"Sub072"</span><span class="op">)</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       Gender      Group BloodPressure  Age Aneurisms_q1 Aneurisms_q2
Sub009      m Treatment2           131 19.4          117          215
Sub072      m    Control           116 17.4          118          165
       Aneurisms_q3 Aneurisms_q4
Sub009          181          272
Sub072          220          227</code></pre>
</div>
<p>Note that row names must be <strong>unique</strong>!</p>
<p>For example, if we try and read in the data setting the
<em>Group</em> column as row names, R will throw an error because values
in that column are duplicated:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'data/sample.csv'</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>, row.names<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in read.table(file = file, header = header, sep = sep, quote = quote, : duplicate 'row.names' are not allowed</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="addressing-by-logical-vector">Addressing by Logical Vector<a class="anchor" aria-label="anchor" href="#addressing-by-logical-vector"></a>
</h3>
<p>A logical vector contains only the special values <code>TRUE</code>
and <code>FALSE</code>.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  TRUE  TRUE FALSE FALSE  TRUE</code></pre>
</div>
<div id="truth-and-its-opposite" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="truth-and-its-opposite" class="callout-inner">
<h3 class="callout-title">Truth and Its Opposite</h3>
<div class="callout-content">
<p>Note the values <code>TRUE</code> and <code>FALSE</code> are all
capital letters and are not quoted.</p>
</div>
</div>
</div>
<p>Logical vectors can be created using
<code>relational operators</code>
e.g. <code>&lt;, &gt;, ==, !=, %in%</code>.</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">10</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  TRUE  TRUE  TRUE FALSE FALSE FALSE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">%in%</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  TRUE  TRUE  TRUE FALSE FALSE FALSE</code></pre>
</div>
<p>We can use logical vectors to select data from a data frame. This is
often referred to as <em>logical indexing</em>.</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">index</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Control'</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="va">index</span>,<span class="op">]</span><span class="op">$</span><span class="va">BloodPressure</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 132 173 129  77 158  81 137 111 135 108 133 139 126 125  99 122 155 133  94
[20]  98  74 116  97 104 117  90 150 116 108 102</code></pre>
</div>
<p>Often this operation is written as one line of code:</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Control'</span>, <span class="op">]</span><span class="op">$</span><span class="va">BloodPressure</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/10-supp-addressing-data-rendered-logical_vectors_indexing2-1.svg" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="using-logical-indexes" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="using-logical-indexes" class="callout-inner">
<h3 class="callout-title">Using Logical Indexes</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create a scatterplot showing BloodPressure for subjects not in the
control group.</li>
<li>How many ways are there to index this set of subjects?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>The code for such a plot:</li>
</ol>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Group</span> <span class="op">!=</span> <span class="st">'Control'</span>, <span class="op">]</span><span class="op">$</span><span class="va">BloodPressure</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/10-supp-addressing-data-rendered-plot-logical-1.svg" style="display: block; margin: auto;" class="figure">
2. In addition to <code>dat$Group != 'Control'</code>, one could use
<code>dat$Group %in% c("Treatment1", "Treatment2")</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="combining-addressing-and-assignment">Combining Addressing and Assignment<a class="anchor" aria-label="anchor" href="#combining-addressing-and-assignment"></a>
</h3>
<p>The assignment operator <code>&lt;-</code> can be combined with
addressing.</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">x</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  0  0  0 11 12 13</code></pre>
</div>
<div id="updating-a-subset-of-values" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="updating-a-subset-of-values" class="callout-inner">
<h3 class="callout-title">Updating a Subset of Values</h3>
<div class="callout-content">
<p>In this dataset, values for Gender have been recorded as both
uppercase <code>M, F</code> and lowercase <code>m, f</code>. Combine the
addressing and assignment operations to convert all values to
lowercase.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Gender</span> <span class="op">==</span> <span class="st">'M'</span>, <span class="op">]</span><span class="op">$</span><span class="va">Gender</span> <span class="op">&lt;-</span> <span class="st">'m'</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Gender</span> <span class="op">==</span> <span class="st">'F'</span>, <span class="op">]</span><span class="op">$</span><span class="va">Gender</span> <span class="op">&lt;-</span> <span class="st">'f'</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Data in data frames can be addressed by index (subsetting), by
logical vector, or by name (columns only).</li>
<li>Use the <code>$</code> operator to address a column by name.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-11-supp-read-write-csv"><p>Content from <a href="11-supp-read-write-csv.html">Reading and Writing CSV Files</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/11-supp-read-write-csv.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 35 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I read data from a CSV file into R?</li>
<li>How do I write data to a CSV file?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Read in a .csv, and explore the arguments of the csv reader.</li>
<li>Write the altered data set to a new .csv, and explore the
arguments.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The most common way that scientists store data is in Excel
spreadsheets. While there are R packages designed to access data from
Excel spreadsheets (e.g., gdata, RODBC, XLConnect, xlsx, RExcel), users
often find it easier to save their spreadsheets in <a href="reference.html#comma-separated-values-csv">comma-separated
values</a> files (CSV) and then use R’s built in functionality to read
and manipulate the data. In this short lesson, we’ll learn how to read
data from a .csv and write to a new .csv, and explore the <a href="reference.html#argument">arguments</a> that allow you read and
write the data correctly for your needs.</p>
<div class="section level3">
<h3 id="read-a--csv-and-explore-the-arguments">Read a .csv and Explore the Arguments<a class="anchor" aria-label="anchor" href="#read-a--csv-and-explore-the-arguments"></a>
</h3>
<p>Let’s start by opening a .csv file containing information on the
speeds at which cars of different colors were clocked in 45 mph zones in
the four-corners states (<code>car-speeds.csv</code>). We will use the
built in <code>read.csv(...)</code> <a href="reference.html#function-call">function call</a>, which reads the
data in as a data frame, and assign the data frame to a variable (using
<code>&lt;-</code>) so that it is stored in R’s memory. Then we will
explore some of the basic arguments that can be supplied to the
function. First, open the RStudio project containing the scripts and
data you were working on in episode ‘Analyzing Patient Data’.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import the data and look at the first six rows</span></span>
<span><span class="va">carSpeeds</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'data/car-speeds.csv'</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Color Speed     State
1  Blue    32 NewMexico
2   Red    45   Arizona
3  Blue    35  Colorado
4 White    34   Arizona
5   Red    25   Arizona
6  Blue    41   Arizona</code></pre>
</div>
<div id="changing-delimiters" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="changing-delimiters" class="callout-inner">
<h3 class="callout-title">Changing Delimiters</h3>
<div class="callout-content">
<p>The default delimiter of the <code>read.csv()</code> function is a
comma, but you can use other delimiters by supplying the ‘sep’ argument
to the function (e.g., typing <code>sep = ';'</code> allows a semi-colon
separated file to be correctly imported - see <code>?read.csv()</code>
for more information on this and other options for working with
different file types).</p>
</div>
</div>
</div>
<p>The call above will import the data, but we have not taken advantage
of several handy arguments that can be helpful in loading the data in
the format we want. Let’s explore some of these arguments.</p>
</div>
<div class="section level3">
<h3 id="the-header-argument">The <code>header</code> Argument<a class="anchor" aria-label="anchor" href="#the-header-argument"></a>
</h3>
<p>The default for <code>read.csv(...)</code> is to set the
<code>header</code> argument to <code>TRUE</code>. This means that the
first row of values in the .csv is set as header information (column
names). If your data set does not have a header, set the
<code>header</code> argument to <code>FALSE</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The first row of the data without setting the header argument:</span></span>
<span><span class="va">carSpeeds</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Color Speed     State
1  Blue    32 NewMexico</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The first row of the data if the header argument is set to FALSE:</span></span>
<span><span class="va">carSpeeds</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'data/car-speeds.csv'</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">carSpeeds</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     V1    V2    V3
1 Color Speed State</code></pre>
</div>
<p>Clearly this is not the desired behavior for this data set, but it
may be useful if you have a dataset without headers.</p>
</div>
<div class="section level3">
<h3 id="the-stringsasfactors-argument">The <code>stringsAsFactors</code> Argument<a class="anchor" aria-label="anchor" href="#the-stringsasfactors-argument"></a>
</h3>
<p>In older versions of R (prior to 4.0) this was perhaps the most
important argument in <code>read.csv()</code>, particularly if you were
working with categorical data. This is because the default behavior of R
was to convert character <a href="reference.html#string">string</a>s
into <a href="12-supp-factors.html">factors</a>, which may make it
difficult to do such things as replace values. It is important to be
aware of this behaviour, which we will demonstrate. For example, let’s
say we find out that the data collector was color blind, and
accidentally recorded green cars as being blue. In order to correct the
data set, let’s replace ‘Blue’ with ‘Green’ in the <code>$Color</code>
column:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Here we will use R's `ifelse` function, in which we provide the test phrase,</span></span>
<span><span class="co"># the outcome if the result of the test is 'TRUE', and the outcome if the</span></span>
<span><span class="co"># result is 'FALSE'. We will also assign the results to the Color column,</span></span>
<span><span class="co"># using '&lt;-'</span></span>
<span></span>
<span><span class="co"># First - reload the data with a header</span></span>
<span><span class="va">carSpeeds</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'data/car-speeds.csv'</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span> <span class="op">==</span> <span class="st">'Blue'</span>, <span class="st">'Green'</span>, <span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span><span class="op">)</span></span>
<span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] "Green" "1"     "Green" "5"     "4"     "Green" "Green" "2"     "5"
 [10] "4"     "4"     "5"     "Green" "Green" "2"     "4"     "Green" "Green"
 [19] "5"     "Green" "Green" "Green" "4"     "Green" "4"     "4"     "4"
 [28] "4"     "5"     "Green" "4"     "5"     "2"     "4"     "2"     "2"
 [37] "Green" "4"     "2"     "4"     "2"     "2"     "4"     "4"     "5"
 [46] "2"     "Green" "4"     "4"     "2"     "2"     "4"     "5"     "4"
 [55] "Green" "Green" "2"     "Green" "5"     "2"     "4"     "Green" "Green"
 [64] "5"     "2"     "4"     "4"     "2"     "Green" "5"     "Green" "4"
 [73] "5"     "5"     "Green" "Green" "Green" "Green" "Green" "5"     "2"
 [82] "Green" "5"     "2"     "2"     "4"     "4"     "5"     "5"     "5"
 [91] "5"     "4"     "4"     "4"     "5"     "2"     "5"     "2"     "2"
[100] "5"    </code></pre>
</div>
<p>What happened?!? It looks like ‘Blue’ was replaced with ‘Green’, but
every other color was turned into a number (as a character string, given
the quote marks before and after). This is because the colors of the
cars were loaded as factors, and the factor level was reported following
replacement.</p>
<p>To see the internal structure, we can use another function,
<code>str()</code>. In this case, the dataframe’s internal structure
includes the format of each column, which is what we are interested in.
<code>str()</code> will be reviewed a little more in the lesson <a href="13-supp-data-structures.html">Data Types and Structures</a>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reload the data with a header (the previous ifelse call modifies attributes)</span></span>
<span><span class="va">carSpeeds</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'data/car-speeds.csv'</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">str</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	100 obs. of  3 variables:
 $ Color: Factor w/ 5 levels " Red","Black",..: 3 1 3 5 4 3 3 2 5 4 ...
 $ Speed: int  32 45 35 34 25 41 34 29 31 26 ...
 $ State: Factor w/ 4 levels "Arizona","Colorado",..: 3 1 2 1 1 1 3 2 1 2 ...</code></pre>
</div>
<p>We can see that the <code>$Color</code> and <code>$State</code>
columns are factors and <code>$Speed</code> is a numeric column.</p>
<p>Now, let’s load the dataset using
<code>stringsAsFactors=FALSE</code>, and see what happens when we try to
replace ‘Blue’ with ‘Green’ in the <code>$Color</code> column:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">carSpeeds</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'data/car-speeds.csv'</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">str</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	100 obs. of  3 variables:
 $ Color: chr  "Blue" " Red" "Blue" "White" ...
 $ Speed: int  32 45 35 34 25 41 34 29 31 26 ...
 $ State: chr  "NewMexico" "Arizona" "Colorado" "Arizona" ...</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span> <span class="op">==</span> <span class="st">'Blue'</span>, <span class="st">'Green'</span>, <span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span><span class="op">)</span></span>
<span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] "Green" " Red"  "Green" "White" "Red"   "Green" "Green" "Black" "White"
 [10] "Red"   "Red"   "White" "Green" "Green" "Black" "Red"   "Green" "Green"
 [19] "White" "Green" "Green" "Green" "Red"   "Green" "Red"   "Red"   "Red"
 [28] "Red"   "White" "Green" "Red"   "White" "Black" "Red"   "Black" "Black"
 [37] "Green" "Red"   "Black" "Red"   "Black" "Black" "Red"   "Red"   "White"
 [46] "Black" "Green" "Red"   "Red"   "Black" "Black" "Red"   "White" "Red"
 [55] "Green" "Green" "Black" "Green" "White" "Black" "Red"   "Green" "Green"
 [64] "White" "Black" "Red"   "Red"   "Black" "Green" "White" "Green" "Red"
 [73] "White" "White" "Green" "Green" "Green" "Green" "Green" "White" "Black"
 [82] "Green" "White" "Black" "Black" "Red"   "Red"   "White" "White" "White"
 [91] "White" "Red"   "Red"   "Red"   "White" "Black" "White" "Black" "Black"
[100] "White"</code></pre>
</div>
<p>That’s better! And we can see how the data now is read as character
instead of factor. From R version 4.0 onwards we do not have to specify
<code>stringsAsFactors=FALSE</code>, this is the default behavior.</p>
</div>
<div class="section level3">
<h3 id="the-as-is-argument">The <code>as.is</code> Argument<a class="anchor" aria-label="anchor" href="#the-as-is-argument"></a>
</h3>
<p>This is an extension of the <code>stringsAsFactors</code> argument,
but gives you control over individual columns. For example, if we want
the colors of cars imported as strings, but we want the names of the
states imported as factors, we would load the data set as:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">carSpeeds</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'data/car-speeds.csv'</span>, as.is <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Note, the 1 applies as.is to the first column only</span></span></code></pre>
</div>
<p>Now we can see that if we try to replace ‘Blue’ with ‘Green’ in the
<code>$Color</code> column everything looks fine, while trying to
replace ‘Arizona’ with ‘Ohio’ in the <code>$State</code> column returns
the factor numbers for the names of states that we haven’t replaced:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	100 obs. of  3 variables:
 $ Color: chr  "Blue" " Red" "Blue" "White" ...
 $ Speed: int  32 45 35 34 25 41 34 29 31 26 ...
 $ State: Factor w/ 4 levels "Arizona","Colorado",..: 3 1 2 1 1 1 3 2 1 2 ...</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span> <span class="op">==</span> <span class="st">'Blue'</span>, <span class="st">'Green'</span>, <span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span><span class="op">)</span></span>
<span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] "Green" " Red"  "Green" "White" "Red"   "Green" "Green" "Black" "White"
 [10] "Red"   "Red"   "White" "Green" "Green" "Black" "Red"   "Green" "Green"
 [19] "White" "Green" "Green" "Green" "Red"   "Green" "Red"   "Red"   "Red"
 [28] "Red"   "White" "Green" "Red"   "White" "Black" "Red"   "Black" "Black"
 [37] "Green" "Red"   "Black" "Red"   "Black" "Black" "Red"   "Red"   "White"
 [46] "Black" "Green" "Red"   "Red"   "Black" "Black" "Red"   "White" "Red"
 [55] "Green" "Green" "Black" "Green" "White" "Black" "Red"   "Green" "Green"
 [64] "White" "Black" "Red"   "Red"   "Black" "Green" "White" "Green" "Red"
 [73] "White" "White" "Green" "Green" "Green" "Green" "Green" "White" "Black"
 [82] "Green" "White" "Black" "Black" "Red"   "Red"   "White" "White" "White"
 [91] "White" "Red"   "Red"   "Red"   "White" "Black" "White" "Black" "Black"
[100] "White"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">State</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">State</span> <span class="op">==</span> <span class="st">'Arizona'</span>, <span class="st">'Ohio'</span>, <span class="va">carSpeeds</span><span class="op">$</span><span class="va">State</span><span class="op">)</span></span>
<span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">State</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] "3"    "Ohio" "2"    "Ohio" "Ohio" "Ohio" "3"    "2"    "Ohio" "2"
 [11] "4"    "4"    "4"    "4"    "4"    "3"    "Ohio" "3"    "Ohio" "4"
 [21] "4"    "4"    "3"    "2"    "2"    "3"    "2"    "4"    "2"    "4"
 [31] "3"    "2"    "2"    "4"    "2"    "2"    "3"    "Ohio" "4"    "2"
 [41] "2"    "3"    "Ohio" "4"    "Ohio" "2"    "3"    "3"    "3"    "2"
 [51] "Ohio" "4"    "4"    "Ohio" "3"    "2"    "4"    "2"    "4"    "4"
 [61] "4"    "2"    "3"    "2"    "3"    "2"    "3"    "Ohio" "3"    "4"
 [71] "4"    "2"    "Ohio" "4"    "2"    "2"    "2"    "Ohio" "3"    "Ohio"
 [81] "4"    "2"    "2"    "Ohio" "Ohio" "Ohio" "4"    "Ohio" "4"    "4"
 [91] "4"    "Ohio" "Ohio" "3"    "2"    "2"    "4"    "3"    "Ohio" "4"   </code></pre>
</div>
<p>We can see that <code>$Color</code> column is a character while
<code>$State</code> is a factor.</p>
<div id="updating-values-in-a-factor" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="updating-values-in-a-factor" class="callout-inner">
<h3 class="callout-title">Updating Values in a Factor</h3>
<div class="callout-content">
<p>Suppose we want to keep the colors of cars as factors for some other
operations we want to perform. Write code for replacing ‘Blue’ with
‘Green’ in the <code>$Color</code> column of the cars dataset without
importing the data with <code>stringsAsFactors=FALSE</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">carSpeeds</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'data/car-speeds.csv'</span><span class="op">)</span></span>
<span><span class="co"># Replace 'Blue' with 'Green' in cars$Color without using the stringsAsFactors</span></span>
<span><span class="co"># or as.is arguments</span></span>
<span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span> <span class="op">&lt;-</span> <span class="fu">ifelse</span><span class="op">(</span><span class="fu">as.character</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span><span class="op">)</span> <span class="op">==</span> <span class="st">'Blue'</span>,</span>
<span>                          <span class="st">'Green'</span>,</span>
<span>                          <span class="fu">as.character</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Convert colors back to factors</span></span>
<span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span> <span class="op">&lt;-</span> <span class="fu">as.factor</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="the-strip-white-argument">The <code>strip.white</code> Argument<a class="anchor" aria-label="anchor" href="#the-strip-white-argument"></a>
</h3>
<p>It is not uncommon for mistakes to have been made when the data were
recorded, for example a space (whitespace) may have been inserted before
a data value. By default this whitespace will be kept in the R
environment, such that ‘\ Red’ will be recognized as a different value
than ‘Red’. In order to avoid this type of error, use the
<code>strip.white</code> argument. Let’s see how this works by checking
for the unique values in the <code>$Color</code> column of our
dataset:</p>
<p>Here, the data recorder added a space before the color of the car in
one of the cells:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We use the built-in unique() function to extract the unique colors in our dataset</span></span>
<span><span class="fu">unique</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] Green  Red  White Red   Black
Levels:  Red Black Green Red White</code></pre>
</div>
<p>Oops, we see two values for red cars.</p>
<p>Let’s try again, this time importing the data using the
<code>strip.white</code> argument. NOTE - this argument must be
accompanied by the <code>sep</code> argument, by which we indicate the
type of delimiter in the file (the comma for most .csv files)</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">carSpeeds</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">'data/car-speeds.csv'</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  strip.white <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">','</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">unique</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Color</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Blue"  "Red"   "White" "Black"</code></pre>
</div>
<p>That’s better!</p>
<div id="specify-missing-data-when-loading" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="specify-missing-data-when-loading" class="callout-inner">
<h3 class="callout-title">Specify Missing Data When Loading</h3>
<div class="callout-content">
<p>It is common for data sets to have missing values, or mistakes. The
convention for recording missing values often depends on the individual
who collected the data and can be recorded as <code>n.a.</code>,
<code>--</code>, or empty cells ” “. R recognises the reserved character
string <code>NA</code> as a missing value, but not some of the examples
above. Let’s say the inflammation scale in the data set we used earlier
<code>inflammation-01.csv</code> actually starts at <code>1</code> for
no inflammation and the zero values (<code>0</code>) were a missed
observation. Looking at the <code>?read.csv</code> help page is there an
argument we could use to ensure all zeros (<code>0</code>) are read in
as <code>NA</code>? Perhaps, in the <code>car-speeds.csv</code> data
contains mistakes and the person measuring the car speeds could not
accurately distinguish between”Black or “Blue” cars. Is there a way to
specify more than one ‘string’, such as “Black” and “Blue”, to be
replaced by <code>NA</code></p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/inflammation-01.csv"</span>, na.strings <span class="op">=</span> <span class="st">"0"</span><span class="op">)</span></span></code></pre>
</div>
<p>or , in <code>car-speeds.csv</code> use a character vector for
multiple values.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">read.csv</span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">'data/car-speeds.csv'</span>,</span>
<span>  na.strings <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Black"</span>, <span class="st">"Blue"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="write-a-new--csv-and-explore-the-arguments">Write a New .csv and Explore the Arguments<a class="anchor" aria-label="anchor" href="#write-a-new--csv-and-explore-the-arguments"></a>
</h3>
<p>After altering our cars dataset by replacing ‘Blue’ with ‘Green’ in
the <code>$Color</code> column, we now want to save the output. There
are several arguments for the <code>write.csv(...)</code> <a href="reference.html#function-call">function call</a>, a few of which
are particularly important for how the data are exported. Let’s explore
these now.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Export the first rows of data. The write.csv() function requires a minimum of</span></span>
<span><span class="co"># two arguments, the data to be saved and the name of the output file.</span></span>
<span></span>
<span><span class="fu">write.csv</span><span class="op">(</span><span class="fu">head</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">)</span>, file <span class="op">=</span> <span class="st">'data/car-speeds-cleaned.csv'</span><span class="op">)</span></span></code></pre>
</div>
<p>If you open the file, you’ll see that it has header names, because
the data had headers within R, but that there are numbers in the first
column.</p>
<pre class="csv"><code>"","Color","Speed","State"
"1","Blue",32,"NewMexico"
"2","Red",45,"Arizona"
"3","Blue",35,"Colorado"
"4","White",34,"Arizona"
"5","Red",25,"Arizona"
"6","Blue",41,"Arizona"</code></pre>
</div>
<div class="section level3">
<h3 id="the-row-names-argument">The <code>row.names</code> Argument<a class="anchor" aria-label="anchor" href="#the-row-names-argument"></a>
</h3>
<p>This argument allows us to set the names of the rows in the output
data file. R’s default for this argument is <code>TRUE</code>, and since
it does not know what else to name the rows for the cars data set, it
resorts to using row numbers. To correct this, we can set
<code>row.names</code> to <code>FALSE</code>:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write.csv</span><span class="op">(</span><span class="fu">head</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">)</span>, file <span class="op">=</span> <span class="st">'data/car-speeds-cleaned.csv'</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we see:</p>
<pre class="csv"><code>"Color","Speed","State"
"Blue",32,"NewMexico"
"Red",45,"Arizona"
"Blue",35,"Colorado"
"White",34,"Arizona"
"Red",25,"Arizona"
"Blue",41,"Arizona"</code></pre>
<div id="setting-column-names" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="setting-column-names" class="callout-inner">
<h3 class="callout-title">Setting Column Names</h3>
<div class="callout-content">
<p>There is also a <code>col.names</code> argument, which can be used to
set the column names for a data set without headers. If the data set
already has headers (e.g., we used the <code>headers = TRUE</code>
argument when importing the data) then a <code>col.names</code> argument
will be ignored.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="the-na-argument">The <code>na</code> Argument<a class="anchor" aria-label="anchor" href="#the-na-argument"></a>
</h3>
<p>There are times when we want to specify certain values for
<code>NA</code>s in the data set (e.g., we are going to pass the data to
a program that only accepts -9999 as a nodata value). In this case, we
want to set the <code>NA</code> value of our output file to the desired
value, using the na argument. Let’s see how this works:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, replace the speed in the 3rd row with NA, by using an index (square</span></span>
<span><span class="co"># brackets to indicate the position of the value we want to replace)</span></span>
<span><span class="va">carSpeeds</span><span class="op">$</span><span class="va">Speed</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Color Speed     State
1  Blue    32 NewMexico
2   Red    45   Arizona
3  Blue    NA  Colorado
4 White    34   Arizona
5   Red    25   Arizona
6  Blue    41   Arizona</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">write.csv</span><span class="op">(</span><span class="va">carSpeeds</span>, file <span class="op">=</span> <span class="st">'data/car-speeds-cleaned.csv'</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we’ll set <code>NA</code> to -9999 when we write the new .csv
file:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note - the na argument requires a string input</span></span>
<span><span class="fu">write.csv</span><span class="op">(</span><span class="fu">head</span><span class="op">(</span><span class="va">carSpeeds</span><span class="op">)</span>,</span>
<span>          file <span class="op">=</span> <span class="st">'data/car-speeds-cleaned.csv'</span>,</span>
<span>          row.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          na <span class="op">=</span> <span class="st">'-9999'</span><span class="op">)</span></span></code></pre>
</div>
<p>And we see:</p>
<pre class="csv"><code>"Color","Speed","State"
"Blue",32,"NewMexico"
"Red",45,"Arizona"
"Blue",-9999,"Colorado"
"White",34,"Arizona"
"Red",25,"Arizona"
"Blue",41,"Arizona"</code></pre>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Import data from a .csv file using the <code>read.csv(...)</code>
function.</li>
<li>Understand some of the key arguments available for importing the
data properly, including <code>header</code>,
<code>stringsAsFactors</code>, <code>as.is</code>, and
<code>strip.white</code>.</li>
<li>Write data to a new .csv file using the <code>write.csv(...)</code>
function</li>
<li>Understand some of the key arguments available for exporting the
data properly, such as <code>row.names</code>, <code>col.names</code>,
and <code>na</code>.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-12-supp-factors"><p>Content from <a href="12-supp-factors.html">Understanding Factors</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/12-supp-factors.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How is categorical data represented in R?</li>
<li>How do I work with factors?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to represent categorical data in R.</li>
<li>Know the difference between ordered and unordered factors.</li>
<li>Be aware of some of the problems encountered when using
factors.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Factors are used to represent categorical data. Factors can be
ordered or unordered and are an important class for statistical analysis
and for plotting.</p>
<p>Factors are stored as integers, and have labels associated with these
unique integers. While factors look (and often behave) like character
vectors, they are actually integers under the hood, and you need to be
careful when treating them like strings.</p>
<p>Once created, factors can only contain a pre-defined set values,
known as <em>levels</em>. By default, R always sorts<em>levels</em>in
alphabetical order. For instance, if you have a factor with 2
levels:</p>
<div id="the-factor-command" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="the-factor-command" class="callout-inner">
<h3 class="callout-title">The <code>factor()</code> Command</h3>
<div class="callout-content">
<p>The <code>factor()</code> command is used to create and modify
factors in R:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>R will assign <code>1</code> to the level <code>"female"</code> and
<code>2</code> to the level <code>"male"</code> (because <code>f</code>
comes before <code>m</code>, even though the first element in this
vector is <code>"male"</code>). You can check this by using the function
<code>levels()</code>, and check the number of levels using
<code>nlevels()</code>:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">levels</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "female" "male"  </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nlevels</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2</code></pre>
</div>
<p>Sometimes, the order of the factors does not matter, other times you
might want to specify the order because it is meaningful (e.g., “low”,
“medium”, “high”) or it is required by particular type of analysis.
Additionally, specifying the order of the levels allows us to compare
levels:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">food</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"high"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>, <span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">levels</span><span class="op">(</span><span class="va">food</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "high"   "low"    "medium"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">food</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">food</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">levels</span><span class="op">(</span><span class="va">food</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "low"    "medium" "high"  </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">min</span><span class="op">(</span><span class="va">food</span><span class="op">)</span> <span class="co"># doesn't work</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in Summary.factor(structure(c(1L, 3L, 2L, 3L, 1L, 2L, 3L), levels = c("low", : 'min' not meaningful for factors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">food</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">food</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">levels</span><span class="op">(</span><span class="va">food</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "low"    "medium" "high"  </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">min</span><span class="op">(</span><span class="va">food</span><span class="op">)</span> <span class="co"># works!</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] low
Levels: low &lt; medium &lt; high</code></pre>
</div>
<p>In R’s memory, these factors are represented by numbers (1, 2, 3).
They are better than using simple integer labels because factors are
self describing: <code>"low"</code>, <code>"medium"</code>, and
<code>"high"</code>” is more descriptive than <code>1</code>,
<code>2</code>, <code>3</code>. Which is low? You wouldn’t be able to
tell with just integer data. Factors have this information built in. It
is particularly helpful when there are many levels (like the subjects in
our example data set).</p>
<div id="representing-data-in-r" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="representing-data-in-r" class="callout-inner">
<h3 class="callout-title">Representing Data in R</h3>
<div class="callout-content">
<p>You have a vector representing levels of exercise undertaken by 5
subjects</p>
<p><strong>“L”, “N”, “N”, “I”, “L”</strong> ; N=none, L=light,
I=intense</p>
<p>What is the best way to represent this in R?</p>
<ol style="list-style-type: lower-alpha">
<li><p><code>exercise &lt;- c("L", "N", "N", "I", "L")</code></p></li>
<li><p><code>exercise &lt;- factor(c("L", "N", "N", "I", "L"), ordered = TRUE)</code></p></li>
<li><p><code>exercise &lt; -factor(c("L", "N", "N", "I", "L"), levels = c("N", "L", "I"), ordered = FALSE)</code></p></li>
<li><p><code>exercise &lt;- factor(c("L", "N", "N", "I", "L"), levels = c("N", "L", "I"), ordered = TRUE)</code></p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Correct solution is <strong>d.</strong></p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exercise</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"L"</span>, <span class="st">"N"</span>, <span class="st">"N"</span>, <span class="st">"I"</span>, <span class="st">"L"</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"L"</span>, <span class="st">"I"</span><span class="op">)</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>We only expect three categories (“N”, “L”, “I”). We can order these
from least intense to most intense, so let’s use
<code>ordered</code>.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="converting-factors">Converting Factors<a class="anchor" aria-label="anchor" href="#converting-factors"></a>
</h3>
<p>Converting from a factor to a number can cause problems:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">3.4</span>, <span class="fl">1.2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 1 3</code></pre>
</div>
<p>This does not behave as expected (and there is no warning).</p>
<p>The recommended way is to use the integer vector to index the factor
levels:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">levels</span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">[</span><span class="va">f</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "3.4" "1.2" "5"  </code></pre>
</div>
<p>This returns a character vector, the <code>as.numeric()</code>
function is still required to convert the values to the proper type
(numeric).</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">levels</span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">[</span><span class="va">f</span><span class="op">]</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="using-factors">Using Factors<a class="anchor" aria-label="anchor" href="#using-factors"></a>
</h3>
<p>Lets load our example data to see the use of factors:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'data/sample.csv'</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div id="default-behavior" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="default-behavior" class="callout-inner">
<h3 class="callout-title">Default Behavior</h3>
<div class="callout-content">
<p><code>stringsAsFactors = TRUE</code> was the default behavior for R
prior to version 4.0. We are using it here to override the default
behaviour for R version 4.0 which is
<code>stringsAsFactors = FALSE</code>. It is included here for
clarity.</p>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	100 obs. of  9 variables:
 $ ID           : Factor w/ 100 levels "Sub001","Sub002",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ Gender       : Factor w/ 4 levels "f","F","m","M": 3 3 3 1 3 4 1 3 3 1 ...
 $ Group        : Factor w/ 3 levels "Control","Treatment1",..: 1 3 3 2 2 3 1 3 3 1 ...
 $ BloodPressure: int  132 139 130 105 125 112 173 108 131 129 ...
 $ Age          : num  16 17.2 19.5 15.7 19.9 14.3 17.7 19.8 19.4 18.8 ...
 $ Aneurisms_q1 : int  114 148 196 199 188 260 135 216 117 188 ...
 $ Aneurisms_q2 : int  140 209 251 140 120 266 98 238 215 144 ...
 $ Aneurisms_q3 : int  202 248 122 233 222 320 154 279 181 192 ...
 $ Aneurisms_q4 : int  237 248 177 220 228 294 245 251 272 185 ...</code></pre>
</div>
<p>Notice the first 3 columns have been converted to factors. These
values were text in the data file so R automatically interpreted them as
categorical variables.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       ID     Gender        Group    BloodPressure        Age
 Sub001 : 1   f:35   Control   :30   Min.   : 62.0   Min.   :12.10
 Sub002 : 1   F: 4   Treatment1:35   1st Qu.:107.5   1st Qu.:14.78
 Sub003 : 1   m:46   Treatment2:35   Median :117.5   Median :16.65
 Sub004 : 1   M:15                   Mean   :118.6   Mean   :16.42
 Sub005 : 1                          3rd Qu.:133.0   3rd Qu.:18.30
 Sub006 : 1                          Max.   :173.0   Max.   :20.00
 (Other):94
  Aneurisms_q1    Aneurisms_q2    Aneurisms_q3    Aneurisms_q4
 Min.   : 65.0   Min.   : 80.0   Min.   :105.0   Min.   :116.0
 1st Qu.:118.0   1st Qu.:131.5   1st Qu.:182.5   1st Qu.:186.8
 Median :158.0   Median :162.5   Median :217.0   Median :219.0
 Mean   :158.8   Mean   :168.0   Mean   :219.8   Mean   :217.9
 3rd Qu.:188.0   3rd Qu.:196.8   3rd Qu.:248.2   3rd Qu.:244.2
 Max.   :260.0   Max.   :283.0   Max.   :323.0   Max.   :315.0
                                                                </code></pre>
</div>
<p>Notice the <code>summary()</code> function handles factors
differently to numbers (and strings), the occurrence counts for each
value is often more useful information.</p>
<div id="the-summary-function" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="the-summary-function" class="callout-inner">
<h3 class="callout-title">The <code>summary()</code> Function</h3>
<div class="callout-content">
<p>The <code>summary()</code> function is a great way of spotting errors
in your data (look at the <code>dat$Gender</code> column). It’s also a
great way for spotting missing data.</p>
</div>
</div>
</div>
<div id="reordering-factors" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="reordering-factors" class="callout-inner">
<h3 class="callout-title">Reordering Factors</h3>
<div class="callout-content">
<p>The function <code>table()</code> tabulates observations and can be
used to create bar plots quickly. For instance:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
   Control Treatment1 Treatment2
        30         35         35 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">barplot</span><span class="op">(</span><span class="fu">table</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/12-supp-factors-rendered-reordering-factors-1.svg" alt="Bar chart showing control and treatment to emphasise how the function table() tabulates observations." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Use the <code>factor()</code> command to modify the column
<code>dat$Group</code> so that the <em>control</em> group is plotted
last.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">$</span><span class="va">Group</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Group</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Treatment1"</span>, <span class="st">"Treatment2"</span>, <span class="st">"Control"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">barplot</span><span class="op">(</span><span class="fu">table</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Group</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/12-supp-factors-rendered-reordering-factors-2-1.svg" alt="Bar chart showing control and treatment to emphasise how the function factor() moves the control group to the last coulumn." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="removing-levels-from-a-factor">Removing Levels from a Factor<a class="anchor" aria-label="anchor" href="#removing-levels-from-a-factor"></a>
</h3>
<p>Some of the Gender values in our dataset have been coded incorrectly.
Let’s remove levels from this factor.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">barplot</span><span class="op">(</span><span class="fu">table</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Gender</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/12-supp-factors-rendered-gender-counts-1.svg" alt="Bar chart showing gender values in the dataset have been coded incorrectly." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Values should have been recorded as lowercase ‘m’ and ‘f’. We should
correct this.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">$</span><span class="va">Gender</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Gender</span> <span class="op">==</span> <span class="st">'M'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'m'</span></span></code></pre>
</div>
<div id="updating-factors" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="updating-factors" class="callout-inner">
<h3 class="callout-title">Updating Factors</h3>
<div class="callout-content">
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">Gender</span>, y <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">BloodPressure</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/12-supp-factors-rendered-updating-factors-1.svg" alt="Barplot graph showing blood pressure in males and females." style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Why does this plot show 4 levels?</p>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Give me a hint </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" aria-labelledby="headingHint1" data-bs-parent="#accordionHint1">
<div class="accordion-body">
<p>How many levels does <code>dat$Gender</code> have?</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p><code>dat$Gender</code> has 4 levels, so the plot shows 4 levels.</p>
</div>
</div>
</div>
</div>
<p>We need to tell R that “M” is no longer a valid value for this
column. We use the <code>droplevels()</code> function to remove extra
levels.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">$</span><span class="va">Gender</span> <span class="op">&lt;-</span> <span class="fu">droplevels</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Gender</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">Gender</span>, y <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">BloodPressure</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/12-supp-factors-rendered-dropping-levels-1.svg" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="adjusting-factor-levels" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="adjusting-factor-levels" class="callout-inner">
<h3 class="callout-title">Adjusting Factor Levels</h3>
<div class="callout-content">
<p>Adjusting the <code>levels()</code> of a factor provides a useful
shortcut for reassigning values in this case.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">levels</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Gender</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'f'</span></span>
<span><span class="fu">plot</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">Gender</span>, y <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">BloodPressure</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/12-supp-factors-rendered-adjusting-levels-1.svg" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Factors are used to represent categorical data.</li>
<li>Factors can be <em>ordered</em> or <em>unordered</em>.</li>
<li>Some R functions have special methods for handling factors.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-13-supp-data-structures"><p>Content from <a href="13-supp-data-structures.html">Data Types and Structures</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/13-supp-data-structures.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 55 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the different data types in R?</li>
<li>What are the different data structures in R?</li>
<li>How do I access data within the various data structures?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Expose learners to the different data types in R and show how these
data types are used in data structures.</li>
<li>Learn how to create vectors of different types.</li>
<li>Be able to check the type of vector.</li>
<li>Learn about missing data and other special values.</li>
<li>Get familiar with the different data structures (lists, matrices,
data frames).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="understanding-basic-data-types-and-data-structures-in-r">Understanding Basic Data Types and Data Structures in R<a class="anchor" aria-label="anchor" href="#understanding-basic-data-types-and-data-structures-in-r"></a>
</h3>
<p>To make the best of the R language, you’ll need a strong
understanding of the basic data types and data structures and how to
operate on them.</p>
<p>Data structures are very important to understand because these are
the objects you will manipulate on a day-to-day basis in R. Dealing with
object conversions is one of the most common sources of frustration for
beginners.</p>
<p><strong>Everything</strong> in R is an object.</p>
<p>R has 6 basic data types. (In addition to the five listed below,
there is also <em>raw</em> which will not be discussed in this
workshop.)</p>
<ul>
<li>character</li>
<li>numeric (real or decimal)</li>
<li>integer</li>
<li>logical</li>
<li>complex</li>
</ul>
<p>Elements of these data types may be combined to form data structures,
such as atomic vectors. When we call a vector <em>atomic</em>, we mean
that the vector only holds data of a single data type. Below are
examples of atomic character vectors, numeric vectors, integer vectors,
etc.</p>
<ul>
<li>
<strong>character</strong>: <code>"a"</code>,
<code>"swc"</code>
</li>
<li>
<strong>numeric</strong>: <code>2</code>, <code>15.5</code>
</li>
<li>
<strong>integer</strong>: <code>2L</code> (the <code>L</code> tells
R to store this as an integer)</li>
<li>
<strong>logical</strong>: <code>TRUE</code>, <code>FALSE</code>
</li>
<li>
<strong>complex</strong>: <code>1+4i</code> (complex numbers with
real and imaginary parts)</li>
</ul>
<p>R provides many functions to examine features of vectors and other
objects, for example</p>
<ul>
<li>
<code>class()</code> - what kind of object is it (high-level)?</li>
<li>
<code>typeof()</code> - what is the object’s data type
(low-level)?</li>
<li>
<code>length()</code> - how long is it? What about two dimensional
objects?</li>
<li>
<code>attributes()</code> - does it have any metadata?</li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"dataset"</span></span>
<span><span class="fu">typeof</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">attributes</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="cn">NULL</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">y</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "integer"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 10</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">z</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "double"</code></pre>
</div>
<p>R has many <strong>data structures</strong>. These include</p>
<ul>
<li>atomic vector</li>
<li>list</li>
<li>matrix</li>
<li>data frame</li>
<li>factors</li>
</ul>
</div>
<div class="section level3">
<h3 id="vectors">Vectors<a class="anchor" aria-label="anchor" href="#vectors"></a>
</h3>
<p>A vector is the most common and basic data structure in R and is
pretty much the workhorse of R. Technically, vectors can be one of two
types:</p>
<ul>
<li>atomic vectors</li>
<li>lists</li>
</ul>
<p>although the term “vector” most commonly refers to the atomic types
not to lists.</p>
</div>
<div class="section level3">
<h3 id="the-different-vector-modes">The Different Vector Modes<a class="anchor" aria-label="anchor" href="#the-different-vector-modes"></a>
</h3>
<p>A vector is a collection of elements that are most commonly of mode
<code>character</code>, <code>logical</code>, <code>integer</code> or
<code>numeric</code>.</p>
<p>You can create an empty vector with <code>vector()</code>. (By
default the mode is <code>logical</code>. You can be more explicit as
shown in the examples below.)It is more common to use direct
constructors such as <code>character()</code>, <code>numeric()</code>,
etc.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vector</span><span class="op">(</span><span class="op">)</span> <span class="co"># an empty 'logical' (the default) vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">logical</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vector</span><span class="op">(</span><span class="st">"character"</span>, length <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># a vector of mode 'character' with 5 elements</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "" "" "" "" ""</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">character</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="co"># the same thing, but using the constructor directly</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "" "" "" "" ""</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">numeric</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>   <span class="co"># a numeric vector with 5 elements</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0 0 0 0 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">logical</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>   <span class="co"># a logical vector with 5 elements</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
<p>You can also create vectors by directly specifying their content. R
will then guess the appropriate mode of storage for the vector. For
instance:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p>will create a vector <code>x</code> of mode <code>numeric</code>.
These are the most common kind, and are treated as double precision real
numbers. If you wanted to explicitly create integers, you need to add an
<code>L</code> to each element (or <em>coerce</em> to the integer type
using <code>as.integer()</code>).</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span><span class="op">)</span></span></code></pre>
</div>
<p>Using <code>TRUE</code> and <code>FALSE</code> will create a vector
of mode <code>logical</code>:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<p>While using quoted text will create a vector of mode
<code>character</code>:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Sarah"</span>, <span class="st">"Tracy"</span>, <span class="st">"Jon"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="examining-vectors">Examining Vectors<a class="anchor" aria-label="anchor" href="#examining-vectors"></a>
</h3>
<p>The functions <code>typeof()</code>, <code>length()</code>,
<code>class()</code> and <code>str()</code> provide useful information
about your vectors and R objects in general.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "character"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> chr [1:3] "Sarah" "Tracy" "Jon"</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="adding-elements">Adding Elements<a class="anchor" aria-label="anchor" href="#adding-elements"></a>
</h3>
<p>The function <code>c()</code> (for combine) can also be used to add
elements to a vector.</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">z</span>, <span class="st">"Annette"</span><span class="op">)</span></span>
<span><span class="va">z</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Sarah"   "Tracy"   "Jon"     "Annette"</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Greg"</span>, <span class="va">z</span><span class="op">)</span></span>
<span><span class="va">z</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "Greg"    "Sarah"   "Tracy"   "Jon"     "Annette"</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="vectors-from-a-sequence-of-numbers">Vectors from a Sequence of Numbers<a class="anchor" aria-label="anchor" href="#vectors-from-a-sequence-of-numbers"></a>
</h3>
<p>You can create vectors as a sequence of numbers.</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">series</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="fu">seq</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">seq</span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1.0  1.1  1.2  1.3  1.4  1.5  1.6  1.7  1.8  1.9  2.0  2.1  2.2  2.3  2.4
[16]  2.5  2.6  2.7  2.8  2.9  3.0  3.1  3.2  3.3  3.4  3.5  3.6  3.7  3.8  3.9
[31]  4.0  4.1  4.2  4.3  4.4  4.5  4.6  4.7  4.8  4.9  5.0  5.1  5.2  5.3  5.4
[46]  5.5  5.6  5.7  5.8  5.9  6.0  6.1  6.2  6.3  6.4  6.5  6.6  6.7  6.8  6.9
[61]  7.0  7.1  7.2  7.3  7.4  7.5  7.6  7.7  7.8  7.9  8.0  8.1  8.2  8.3  8.4
[76]  8.5  8.6  8.7  8.8  8.9  9.0  9.1  9.2  9.3  9.4  9.5  9.6  9.7  9.8  9.9
[91] 10.0</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="missing-data">Missing Data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h3>
<p>R supports missing data in vectors. They are represented as
<code>NA</code> (Not Available) and can be used for all the vector types
covered in this lesson:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span>, <span class="cn">NA</span>, <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="cn">NA</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">5i</span>, <span class="fl">2</span><span class="op">-</span><span class="fl">3i</span>, <span class="cn">NA</span><span class="op">)</span></span></code></pre>
</div>
<p>The function <code>is.na()</code> indicates the elements of the
vectors that represent missing data, and the function
<code>anyNA()</code> returns <code>TRUE</code> if the vector contains
any missing values:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="cn">NA</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span><span class="op">)</span></span>
<span><span class="fu">is.na</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE  TRUE FALSE FALSE  TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">is.na</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">anyNA</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">anyNA</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="other-special-values">Other Special Values<a class="anchor" aria-label="anchor" href="#other-special-values"></a>
</h3>
<p><code>Inf</code> is infinity. You can have either positive or
negative infinity.</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span><span class="op">/</span><span class="fl">0</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] Inf</code></pre>
</div>
<p><code>NaN</code> means Not a Number. It’s an undefined value.</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0</span><span class="op">/</span><span class="fl">0</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NaN</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="what-happens-when-you-mix-types-inside-a-vector">What Happens When You Mix Types Inside a Vector?<a class="anchor" aria-label="anchor" href="#what-happens-when-you-mix-types-inside-a-vector"></a>
</h3>
<p>R will create a resulting vector with a mode that can most easily
accommodate all the elements it contains. This conversion between modes
of storage is called “coercion”. When R converts the mode of storage
based on its content, it is referred to as “implicit coercion”. For
instance, can you guess what the following do (without running them
first)?</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1.7</span>, <span class="st">"a"</span><span class="op">)</span></span>
<span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"a"</span>, <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<p>You can also control how vectors are coerced explicitly using the
<code>as.&lt;class_name&gt;()</code> functions:</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as.numeric</span><span class="op">(</span><span class="st">"1"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as.character</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "1" "2"</code></pre>
</div>
<div id="finding-commonalities" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="finding-commonalities" class="callout-inner">
<h3 class="callout-title">Finding Commonalities</h3>
<div class="callout-content">
<p>Do you see a property that’s common to all these vectors above?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>All vectors are one-dimensional and each element is of the same
type.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="objects-attributes">Objects Attributes<a class="anchor" aria-label="anchor" href="#objects-attributes"></a>
</h3>
<p>Objects can have <strong>attributes</strong>. Attributes are part of
the object. These include:</p>
<ul>
<li>names</li>
<li>dimnames</li>
<li>dim</li>
<li>class</li>
<li>attributes (contain metadata)</li>
</ul>
<p>You can also glean other attribute-like information such as length
(works on vectors and lists) or number of characters (for character
strings).</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 10</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nchar</span><span class="op">(</span><span class="st">"Software Carpentry"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 18</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="matrix">Matrix<a class="anchor" aria-label="anchor" href="#matrix"></a>
</h3>
<p>In R matrices are an extension of the numeric or character vectors.
They are not a separate type of object but simply an atomic vector with
dimensions; the number of rows and columns. As with atomic vectors, the
elements of a matrix must be of the same data type.</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">m</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2]
[1,]   NA   NA
[2,]   NA   NA</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dim</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2 2</code></pre>
</div>
<p>You can check that matrices are vectors with a class attribute of
<code>matrix</code> by using <code>class()</code> and
<code>typeof()</code>.</p>
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">class</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "matrix" "array" </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">typeof</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "integer"</code></pre>
</div>
<p>While <code>class()</code> shows that m is a matrix,
<code>typeof()</code> shows that fundamentally the matrix is an integer
vector.</p>
<div id="data-types-of-matrix-elements" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="data-types-of-matrix-elements" class="callout-inner">
<h3 class="callout-title">Data types of matrix elements</h3>
<div class="callout-content">
<p>Consider the following matrix:</p>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FOURS</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>  <span class="fu">c</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Given that <code>typeof(FOURS[1])</code> returns
<code>"double"</code>, what would you expect
<code>typeof(FOURS)</code>to return? How do you know this is the case
even without running this code?</p>
<p><em>Hint</em> Can matrices be composed of elements of different data
types?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>We know that <code>typeof(FOURS)</code> will also return
<code>"double"</code> since matrices are made of elements of the same
data type. Note that you could do something like
<code>as.character(FOURS)</code> if you needed the elements of
<code>FOURS</code> <em>as characters</em>.</p>
</div>
</div>
</div>
</div>
<p>Matrices in R are filled column-wise.</p>
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
<p>Other ways to construct a matrix</p>
<div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span>      <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="fu">dim</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<p>This takes a vector and transforms it into a matrix with 2 rows and 5
columns.</p>
<p>Another way is to bind columns or rows using <code>rbind()</code> and
<code>cbind()</code> (“row bind” and “column bind”, respectively).</p>
<div class="codewrapper sourceCode" id="cb78">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">:</span><span class="fl">12</span></span>
<span><span class="fu">cbind</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     x  y
[1,] 1 10
[2,] 2 11
[3,] 3 12</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb80">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rbind</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [,1] [,2] [,3]
x    1    2    3
y   10   11   12</code></pre>
</div>
<p>You can also use the <code>byrow</code> argument to specify how the
matrix is filled. From R’s own documentation:</p>
<div class="codewrapper sourceCode" id="cb82">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mdat</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>               nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mdat</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2] [,3]
[1,]    1    2    3
[2,]   11   12   13</code></pre>
</div>
<p>Elements of a matrix can be referenced by specifying the index along
each dimension (e.g. “row” and “column”) in single square brackets.</p>
<div class="codewrapper sourceCode" id="cb84">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mdat</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 13</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="list">List<a class="anchor" aria-label="anchor" href="#list"></a>
</h3>
<p>In R lists act as containers. Unlike atomic vectors, the contents of
a list are not restricted to a single mode and can encompass any mixture
of data types. Lists are sometimes called generic vectors, because the
elements of a list can by of any type of R object, even lists containing
further lists. This property makes them fundamentally different from
atomic vectors.</p>
<p>A list is a special type of vector. Each element can be a different
type.</p>
<p>Create lists using <code>list()</code> or coerce other objects using
<code>as.list()</code>. An empty list of the required length can be
created using <code>vector()</code></p>
<div class="codewrapper sourceCode" id="cb86">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"a"</span>, <span class="cn">TRUE</span>, <span class="fl">1</span><span class="op">+</span><span class="fl">4i</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1]]
[1] 1

[[2]]
[1] "a"

[[3]]
[1] TRUE

[[4]]
[1] 1+4i</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb88">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">vector</span><span class="op">(</span><span class="st">"list"</span>, length <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># empty list</span></span>
<span><span class="fu">length</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 5</code></pre>
</div>
<p>The content of elements of a list can be retrieved by using double
square brackets.</p>
<div class="codewrapper sourceCode" id="cb90">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="cn">NULL</span></span></code></pre>
</div>
<p>Vectors can be coerced to lists as follows:</p>
<div class="codewrapper sourceCode" id="cb92">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">as.list</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu">length</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 10</code></pre>
</div>
<div id="examining-lists" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="examining-lists" class="callout-inner">
<h3 class="callout-title">Examining Lists</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What is the class of <code>x[1]</code>?</li>
<li>What is the class of <code>x[[1]]</code>?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<div class="codewrapper sourceCode" id="cb94">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "list"</code></pre>
</div>
</li>
<li>
<div class="codewrapper sourceCode" id="cb96">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "integer"</code></pre>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<p>Elements of a list can be named (i.e. lists can have the
<code>names</code> attribute)</p>
<div class="codewrapper sourceCode" id="cb98">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlist</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>a <span class="op">=</span> <span class="st">"Karthik Ram"</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, data <span class="op">=</span> <span class="fu">head</span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xlist</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$a
[1] "Karthik Ram"

$b
 [1]  1  2  3  4  5  6  7  8  9 10

$data
                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb100">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">names</span><span class="op">(</span><span class="va">xlist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a"    "b"    "data"</code></pre>
</div>
<div id="examining-named-lists" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="examining-named-lists" class="callout-inner">
<h3 class="callout-title">Examining Named Lists</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What is the length of this object?</li>
<li>What is its structure?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<div class="codewrapper sourceCode" id="cb102">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">xlist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3</code></pre>
</div>
</li>
<li>
<div class="codewrapper sourceCode" id="cb104">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">xlist</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>List of 3
 $ a   : chr "Karthik Ram"
 $ b   : int [1:10] 1 2 3 4 5 6 7 8 9 10
 $ data:'data.frame':	6 obs. of  11 variables:
  ..$ mpg : num [1:6] 21 21 22.8 21.4 18.7 18.1
  ..$ cyl : num [1:6] 6 6 4 6 8 6
  ..$ disp: num [1:6] 160 160 108 258 360 225
  ..$ hp  : num [1:6] 110 110 93 110 175 105
  ..$ drat: num [1:6] 3.9 3.9 3.85 3.08 3.15 2.76
  ..$ wt  : num [1:6] 2.62 2.88 2.32 3.21 3.44 ...
  ..$ qsec: num [1:6] 16.5 17 18.6 19.4 17 ...
  ..$ vs  : num [1:6] 0 0 1 1 0 1
  ..$ am  : num [1:6] 1 1 1 0 0 0
  ..$ gear: num [1:6] 4 4 4 3 3 3
  ..$ carb: num [1:6] 4 4 1 1 2 1</code></pre>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<p>Lists can be extremely useful inside functions. Because the functions
in R are able to return only a single object, you can “staple” together
lots of different kinds of results into a single object that a function
can return.</p>
<p>A list does not print to the console like a vector. Instead, each
element of the list starts on a new line.</p>
<p>Elements are indexed by double brackets. Single brackets will still
return a(nother) list. If the elements of a list are named, they can be
referenced by the <code>$</code> notation
(i.e. <code>xlist$data</code>).</p>
</div>
<div class="section level3">
<h3 id="data-frame">Data Frame<a class="anchor" aria-label="anchor" href="#data-frame"></a>
</h3>
<p>A data frame is a very important data type in R. It’s pretty much the
<em>de facto</em> data structure for most tabular data and what we use
for statistics.</p>
<p>A data frame is a <em>special type of list</em> where every element
of the list has same length (i.e. data frame is a “rectangular”
list).</p>
<p>Data frames can have additional attributes such as
<code>rownames()</code>, which can be useful for annotating data, like
<code>subject_id</code> or <code>sample_id</code>. But most of the time
they are not used.</p>
<p>Some additional information on data frames:</p>
<ul>
<li>Usually created by <code>read.csv()</code> and
<code>read.table()</code>, i.e. when importing the data into R.</li>
<li>Assuming all columns in a data frame are of same type, data frame
can be converted to a matrix with data.matrix() (preferred) or
as.matrix(). Otherwise type coercion will be enforced and the results
may not always be what you expect.</li>
<li>Can also create a new data frame with <code>data.frame()</code>
function.</li>
<li>Find the number of rows and columns with <code>nrow(dat)</code> and
<code>ncol(dat)</code>, respectively.</li>
<li>Rownames are often automatically generated and look like 1, 2, …,
n. Consistency in numbering of rownames may not be honored when rows are
reshuffled or subset.</li>
</ul>
</div>
<div class="section level3">
<h3 id="creating-data-frames-by-hand">Creating Data Frames by Hand<a class="anchor" aria-label="anchor" href="#creating-data-frames-by-hand"></a>
</h3>
<p>To create data frames by hand:</p>
<div class="codewrapper sourceCode" id="cb106">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span>id <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, y <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">dat</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   id  x  y
1   a  1 11
2   b  2 12
3   c  3 13
4   d  4 14
5   e  5 15
6   f  6 16
7   g  7 17
8   h  8 18
9   i  9 19
10  j 10 20</code></pre>
</div>
<div id="useful-data-frame-functions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="useful-data-frame-functions" class="callout-inner">
<h3 class="callout-title">Useful Data Frame Functions</h3>
<div class="callout-content">
<ul>
<li>
<code>head()</code> - shows first 6 rows</li>
<li>
<code>tail()</code> - shows last 6 rows</li>
<li>
<code>dim()</code> - returns the dimensions of data frame
(i.e. number of rows and number of columns)</li>
<li>
<code>nrow()</code> - number of rows</li>
<li>
<code>ncol()</code> - number of columns</li>
<li>
<code>str()</code> - structure of data frame - name, type and
preview of data in each column</li>
<li>
<code>names()</code> or <code>colnames()</code> - both show the
<code>names</code> attribute for a data frame</li>
<li>
<code>sapply(dataframe, class)</code> - shows the class of each
column in the data frame</li>
</ul>
</div>
</div>
</div>
<p>See that it is actually a special list:</p>
<div class="codewrapper sourceCode" id="cb108">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">is.list</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb110">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">class</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "data.frame"</code></pre>
</div>
<p>Because data frames are rectangular, elements of data frame can be
referenced by specifying the row and the column index in single square
brackets (similar to matrix).</p>
<div class="codewrapper sourceCode" id="cb112">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 11</code></pre>
</div>
<p>As data frames are also lists, it is possible to refer to columns
(which are elements of such list) using the list notation, i.e. either
double square brackets or a <code>$</code>.</p>
<div class="codewrapper sourceCode" id="cb114">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 11 12 13 14 15 16 17 18 19 20</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb116">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">$</span><span class="va">y</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 11 12 13 14 15 16 17 18 19 20</code></pre>
</div>
<p>The following table summarizes the one-dimensional and
two-dimensional data structures in R in relation to diversity of data
types they can contain.</p>
<table class="table">
<thead><tr>
<th>Dimensions</th>
<th>Homogenous</th>
<th>Heterogeneous</th>
</tr></thead>
<tbody>
<tr>
<td>1-D</td>
<td>atomic vector</td>
<td>list</td>
</tr>
<tr>
<td>2-D</td>
<td>matrix</td>
<td>data frame</td>
</tr>
</tbody>
</table>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>Lists can contain elements that are themselves muti-dimensional
(e.g. a lists can contain data frames or another type of objects). Lists
can also contain elements of any length, therefore list do not
necessarily have to be “rectangular”. However in order for the list to
qualify as a data frame, the length of each element has to be the
same.</p>
</div>
</div>
</div>
<div id="column-types-in-data-frames" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="column-types-in-data-frames" class="callout-inner">
<h3 class="callout-title">Column Types in Data Frames</h3>
<div class="callout-content">
<p>Knowing that data frames are lists, can columns be of different
type?</p>
<p>What type of structure do you expect to see when you explore the
structure of the <code>PlantGrowth</code> data frame? Hint: Use
<code>str()</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>The weight column is numeric while group is a factor. Lists can have
elements of different types. Since a Data Frame is just a special type
of list, it can have columns of differing type (although, remember that
type must be consistent within each column!).</p>
<div class="codewrapper sourceCode" id="cb118">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">PlantGrowth</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>'data.frame':	30 obs. of  2 variables:
 $ weight: num  4.17 5.58 5.18 6.11 4.5 4.61 5.17 4.53 5.33 5.14 ...
 $ group : Factor w/ 3 levels "ctrl","trt1",..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>R’s basic data types are character, numeric, integer, complex, and
logical.</li>
<li>R’s basic data structures include the vector, list, matrix, data
frame, and factors. Some of these structures require that all members be
of the same data type (e.g. vectors, matrices) while others permit
multiple data types (e.g. lists, data frames).</li>
<li>Objects may have attributes, such as name, dimension, and
class.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-14-supp-call-stack"><p>Content from <a href="14-supp-call-stack.html">The Call Stack</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/14-supp-call-stack.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the call stack, and how does R know what order to do things
in?</li>
<li>How does scope work in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how stack frames are created and destroyed as functions are
called.</li>
<li>Correctly identify the scope of a function’s local variables.</li>
<li>Explain variable scope in terms of the call stack.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="the-call-stack">The Call Stack<a class="anchor" aria-label="anchor" href="#the-call-stack"></a>
</h3>
<p>Let’s take a closer look at what happens when we call
<code>fahrenheit_to_kelvin(32)</code>. To make things clearer, we’ll
start by putting the initial value 32 in a variable and store the final
result in one as well:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">original</span> <span class="op">&lt;-</span> <span class="fl">32</span></span>
<span><span class="va">final</span> <span class="op">&lt;-</span> <span class="fu">fahrenheit_to_kelvin</span><span class="op">(</span><span class="va">original</span><span class="op">)</span></span></code></pre>
</div>
<p>The diagram below shows what memory looks like after the first line
has been executed:</p>
<figure><img src="../fig/python-call-stack-01.svg" alt="Call Stack (Initial State)" class="figure mx-auto d-block"></figure><p>When we call <code>fahrenheit_to_kelvin</code>, R <em>doesn’t</em>
create the variable <code>temp_F</code> right away. Instead, it creates
something called a <a href="reference.html#stack-frame">stack frame</a>
to keep track of the variables defined by
<code>fahrenheit_to_kelvin</code>. Initially, this stack frame only
holds the value of <code>temp_F</code>:</p>
<figure><img src="../fig/python-call-stack-02.svg" alt="Call Stack Immediately After First Function Call" class="figure mx-auto d-block"></figure><p>When we call <code>fahrenheit_to_celsius</code> inside
<code>fahrenheit_to_kelvin</code>, R creates another stack frame to hold
<code>fahrenheit_to_celsius</code>’s variables:</p>
<figure><img src="../fig/python-call-stack-03.svg" alt="Call Stack During First Nested Function Call" class="figure mx-auto d-block"></figure><p>It does this because there are now two variables in play called
<code>temp_F</code>: the argument to <code>fahrenheit_to_celsius</code>,
and the argument to <code>fahrenheit_to_kelvin</code>. Having two
variables with the same name in the same part of the program would be
ambiguous, so R (and every other modern programming language) creates a
new stack frame for each function call to keep that function’s variables
separate from those defined by other functions.</p>
<p>When the call to <code>fahrenheit_to_celsius</code> returns a value,
R throws away <code>fahrenheit_to_celsius</code>’s stack frame and
creates a new variable in the stack frame for
<code>fahrenheit_to_kelvin</code> to hold the temperature in
Celsius:</p>
<figure><img src="../fig/python-call-stack-04.svg" alt="Call Stack After Return From First Nested Function Call" class="figure mx-auto d-block"></figure><p>It then calls <code>celsius_to_kelvin</code>, which means it creates
a stack frame to hold that function’s variables:</p>
<figure><img src="../fig/python-call-stack-05.svg" alt="Call Stack During Call to Second Nested Function" class="figure mx-auto d-block"></figure><p>Once again, R throws away that stack frame when
<code>celsius_to_kelvin</code> is done and creates the variable
<code>temp_K</code> in the stack frame for
<code>fahrenheit_to_kelvin</code>:</p>
<figure><img src="../fig/python-call-stack-06.svg" alt="Call Stack After Second Nested Function Returns" class="figure mx-auto d-block"></figure><p>Finally, when <code>fahrenheit_to_kelvin</code> is done, R throws
away <em>its</em> stack frame and puts its result in a new variable
called <code>final</code> that lives in the stack frame we started
with:</p>
<figure><img src="../fig/python-call-stack-07.svg" alt="Call Stack After All Functions Have Finished" class="figure mx-auto d-block"></figure><p>This final stack frame is always there; it holds the variables we
defined outside the functions in our code. What it <em>doesn’t</em> hold
is the variables that were in the various stack frames. If we try to get
the value of <code>temp_F</code> after our functions have finished
running, R tells us that there’s no such thing:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_F</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: object 'temp_F' not found</code></pre>
</div>
<div id="where-to-learn-more" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="where-to-learn-more" class="callout-inner">
<h3 class="callout-title">Where to Learn More</h3>
<div class="callout-content">
<p>The explanation of the stack frame above was very general and the
basic concept will help you understand most languages you try to program
with. However, R has some unique aspects that can be exploited when
performing more complicated operations. We will not be writing anything
that requires knowledge of these more advanced concepts. In the future
when you are comfortable writing functions in R, you can learn more by
reading the <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Environment-objects" class="external-link">R
Language Manual</a> or this <a href="https://adv-r.hadley.nz/environments.html" class="external-link">chapter</a> from <a href="https://adv-r.hadley.nz/index.html" class="external-link">Advanced R Programming</a>by
Hadley Wickham. For context, R uses the terminology “environments”
instead of frames.</p>
</div>
</div>
</div>
<p>Why go to all this trouble? Well, here’s a function called
<code>span</code> that calculates the difference between the minimum and
maximum values in an array:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">span</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu">max</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">-</span> <span class="fu">min</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">diff</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/inflammation-01.csv"</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># span of inflammation data</span></span>
<span><span class="fu">span</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 20</code></pre>
</div>
<p>Notice <code>span</code> assigns a value to variable called
<code>diff</code>. We might very well use a variable with the same name
(<code>diff</code>) to hold the inflammation data:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/inflammation-01.csv"</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># span of inflammation data</span></span>
<span><span class="fu">span</span><span class="op">(</span><span class="va">diff</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 20</code></pre>
</div>
<p>We don’t expect the variable <code>diff</code> to have the value 20
after this function call, so the name <code>diff</code> cannot refer to
the same variable defined inside <code>span</code> as it does in the
main body of our program (which R refers to as the global environment).
And yes, we could probably choose a different name than
<code>diff</code> for our variable in this case, but we don’t want to
have to read every line of code of the R functions we call to see what
variable names they use, just in case they change the values of our
variables.</p>
<p>The big idea here is <a href="reference.html#encapsulation">encapsulation</a>, and it’s the key
to writing correct, comprehensible programs. A function’s job is to turn
several operations into one so that we can think about a single function
call instead of a dozen or a hundred statements each time we want to do
something. That only works if functions don’t interfere with each other;
if they do, we have to pay attention to the details once again, which
quickly overloads our short-term memory.</p>
<div id="following-the-call-stack" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="following-the-call-stack" class="callout-inner">
<h3 class="callout-title">Following the Call Stack</h3>
<div class="callout-content">
<p>We previously wrote functions called <code>highlight</code> and
<code>edges</code>. Draw a diagram showing how the call stack changes
when we run the following:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inner_vec</span> <span class="op">&lt;-</span> <span class="st">"carbon"</span></span>
<span><span class="va">outer_vec</span> <span class="op">&lt;-</span> <span class="st">"+"</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">edges</span><span class="op">(</span><span class="fu">highlight</span><span class="op">(</span><span class="va">inner_vec</span>, <span class="va">outer_vec</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>R keeps track of active function calls using a call stack comprised
of stack frames.</li>
<li>Only global variables and variables in the current stack frame can
be accessed directly.</li>
</ul>
</div>
</div>
</div>
</div></section><section id="aio-15-supp-loops-in-depth"><p>Content from <a href="15-supp-loops-in-depth.html">Loops in R</a></p>
<hr>
<p>Last updated on 2025-08-13 |

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/episodes/15-supp-loops-in-depth.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I do the same thing multiple times more efficiently in
R?</li>
<li>What is vectorization?</li>
<li>Should I use a loop or an <code>apply</code> statement?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Compare loops and vectorized operations.</li>
<li>Use the apply family of functions.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In R you have multiple options when repeating calculations:
vectorized operations, <code>for</code> loops, and <code>apply</code>
functions.</p>
<p>This lesson is an extension of <a href="03-loops-R.html">Analyzing
Multiple Data Sets</a>. In that lesson, we introduced how to run a
custom function, <code>analyze</code>, over multiple data files:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyze</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filename</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Plots the average, min, and max inflammation over time.</span></span>
<span>  <span class="co"># Input is character string of a csv file.</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span>file <span class="op">=</span> <span class="va">filename</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">avg_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">avg_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">max_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">max</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">max_day_inflammation</span><span class="op">)</span></span>
<span>  <span class="va">min_day_inflammation</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">min</span><span class="op">)</span></span>
<span>  <span class="fu">plot</span><span class="op">(</span><span class="va">min_day_inflammation</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filenames</span> <span class="op">&lt;-</span> <span class="fu">list.files</span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data"</span>, pattern <span class="op">=</span> <span class="st">"inflammation-[0-9]{2}.csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<section><h2 class="section-heading" id="vectorized-operations">Vectorized Operations<a class="anchor" aria-label="anchor" href="#vectorized-operations"></a>
</h2>
<hr class="half-width">
<p>A key difference between R and many other languages is a topic known
as vectorization. When you wrote the <code>total</code> function, we
mentioned that R already has <code>sum</code> to do this;
<code>sum</code> is <em>much</em> faster than the interpreted
<code>for</code> loop because <code>sum</code> is coded in C to work
with a vector of numbers. Many of R’s functions work this way; the loop
is hidden from you in C. Learning to use vectorized operations is a key
skill in R.</p>
<p>For example, to add pairs of numbers contained in two vectors</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span></code></pre>
</div>
<p>You could loop over the pairs adding each in turn, but that would be
very inefficient in R.</p>
<p>Instead of using <code>i in a</code> to make our loop variable, we
use the function <code>seq_along</code> to generate indices for each
element <code>a</code> contains.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">numeric</span><span class="op">(</span>length <span class="op">=</span> <span class="fu">length</span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu">seq_along</span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="va">res</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  2  4  6  8 10 12 14 16 18 20</code></pre>
</div>
<p>Instead, <code>+</code> is a <em>vectorized</em> function which can
operate on entire vectors at once</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">+</span> <span class="va">b</span></span>
<span><span class="fu">all.equal</span><span class="op">(</span><span class="va">res</span>, <span class="va">res2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
</section><section><h2 class="section-heading" id="vector-recycling">Vector Recycling<a class="anchor" aria-label="anchor" href="#vector-recycling"></a>
</h2>
<hr class="half-width">
<p>When performing vector operations in R, it is important to know about
recycling. If you perform an operation on two or more vectors of unequal
length, R will recycle elements of the shorter vector(s) to match the
longest vector. For example:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  2  4  6  8 10  7  9 11 13 15</code></pre>
</div>
<p>The elements of <code>a</code> and <code>b</code>are added together
starting from the first element of both vectors. When R reaches the end
of the shorter vector<code>b</code>, it starts again at the first
element of <code>b</code> and continues until it reaches the last
element of the longest vector <code>a</code>. This behaviour may seem
crazy at first glance, but it is very useful when you want to perform
the same operation on every element of a vector. For example, say we
want to multiply every element of our vector <code>a</code> by 5:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">a</span> <span class="op">*</span> <span class="va">b</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  5 10 15 20 25 30 35 40 45 50</code></pre>
</div>
<p>Remember there are no scalars in R, so <code>b</code> is actually a
vector of length 1; in order to add its value to every element of
<code>a</code>, it is <em>recycled</em> to match the length of
<code>a</code>.</p>
<p>When the length of the longer object is a multiple of the shorter
object length (as in our example above), the recycling occurs silently.
When the longer object length is not a multiple of the shorter object
length, a warning is given:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span></span>
<span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in a + b: longer object length is not a multiple of shorter object
length</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  2  4  6  8 10 12 14  9 11 13</code></pre>
</div>
</section><section><h2 class="section-heading" id="for-or-apply">
<code>for</code> or <code>apply</code>?<a class="anchor" aria-label="anchor" href="#for-or-apply"></a>
</h2>
<hr class="half-width">
<p>A <code>for</code> loop is used to apply the same function calls to a
collection of objects. R has a family of functions, the
<code>apply</code> family, which can be used in much the same way.
You’ve already used one of the family, <code>apply</code> in the first
<a href="01-starting-with-data.html">lesson</a>. The <code>apply</code>
family members include</p>
<ul>
<li>
<code>apply</code> - apply over the margins of an array (e.g. the
rows or columns of a matrix)</li>
<li>
<code>lapply</code> - apply over an object and return list</li>
<li>
<code>sapply</code> - apply over an object and return a simplified
object (an array) if possible</li>
<li>
<code>vapply</code> - similar to <code>sapply</code> but you specify
the type of object returned by the iterations</li>
</ul>
<p>Each of these has an argument <code>FUN</code> which takes a function
to apply to each element of the object. Instead of looping over
<code>filenames</code> and calling <code>analyze</code>, as you did
earlier, you could <code>sapply</code> over <code>filenames</code> with
<code>FUN = analyze</code>:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sapply</span><span class="op">(</span><span class="va">filenames</span>, FUN <span class="op">=</span> <span class="va">analyze</span><span class="op">)</span></span></code></pre>
</div>
<p>Deciding whether to use <code>for</code> or one of the
<code>apply</code> family is really personal preference. Using an
<code>apply</code> family function forces to you encapsulate your
operations as a function rather than separate calls with
<code>for</code>. <code>for</code> loops are often more natural in some
circumstances; for several related operations, a <code>for</code> loop
will avoid you having to pass in a lot of extra arguments to your
function.</p>
</section><section><h2 class="section-heading" id="loops-in-r-are-slow">Loops in R Are Slow<a class="anchor" aria-label="anchor" href="#loops-in-r-are-slow"></a>
</h2>
<hr class="half-width">
<p>No, they are not! <em>If</em> you follow some golden rules:</p>
<ol style="list-style-type: decimal">
<li>Don’t use a loop when a vectorized alternative exists</li>
<li>Don’t grow objects (via <code>c</code>, <code>cbind</code>, etc)
during the loop - R has to create a new object and copy across the
information just to add a new element or row/column</li>
<li>Allocate an object to hold the results and fill it in during the
loop</li>
</ol>
<p>As an example, we’ll create a new version of <code>analyze</code>
that will return the mean inflammation per day (column) of each
file.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyze2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="fu">seq_along</span><span class="op">(</span><span class="va">filenames</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">fdata</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="va">filenames</span><span class="op">[</span><span class="va">f</span><span class="op">]</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">fdata</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">f</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">res</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="co"># The loop is slowed by this call to cbind that grows the object</span></span>
<span>      <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">out</span>, <span class="va">res</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">system.time</span><span class="op">(</span><span class="va">avg2</span> <span class="op">&lt;-</span> <span class="fu">analyze2</span><span class="op">(</span><span class="va">filenames</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   user  system elapsed
  0.023   0.000   0.024 </code></pre>
</div>
<p>Note how we add a new column to <code>out</code> at each iteration?
This is a cardinal sin of writing a <code>for</code> loop in R.</p>
<p>Instead, we can create an empty matrix with the right dimensions
(rows/columns) to hold the results. Then we loop over the files but this
time we fill in the <code>f</code>th column of our results matrix
<code>out</code>. This time there is no copying/growing for R to deal
with.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyze3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filenames</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span>ncol <span class="op">=</span> <span class="fu">length</span><span class="op">(</span><span class="va">filenames</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">40</span><span class="op">)</span> <span class="co"># assuming 40 here from files</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="fu">seq_along</span><span class="op">(</span><span class="va">filenames</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">fdata</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="va">filenames</span><span class="op">[</span><span class="va">f</span><span class="op">]</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">out</span><span class="op">[</span>, <span class="va">f</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">apply</span><span class="op">(</span><span class="va">fdata</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">system.time</span><span class="op">(</span><span class="va">avg3</span> <span class="op">&lt;-</span> <span class="fu">analyze3</span><span class="op">(</span><span class="va">filenames</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   user  system elapsed
  0.023   0.000   0.024 </code></pre>
</div>
<p>In this simple example there is little difference in the compute time
of <code>analyze2</code> and <code>analyze3</code>. This is because we
are only iterating over 12 files and hence we only incur 12 copy/grow
operations. If we were doing this over more files or the data objects we
were growing were larger, the penalty for copying/growing would be much
larger.</p>
<p>Note that <code>apply</code> handles these memory allocation issues
for you, but then you have to write the loop part as a function to pass
to <code>apply</code>. At its heart, <code>apply</code> is just a
<code>for</code> loop with extra convenience.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Where possible, use vectorized operations instead of
<code>for</code> loops to make code faster and more concise.</li>
<li>Use functions such as <code>apply</code> instead of <code>for</code>
loops to operate on the values in a data structure.</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/swcarpentry/r-novice-inflammation/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/swcarpentry/r-novice-inflammation/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/swcarpentry/r-novice-inflammation/" class="external-link">Source</a></p>
				<p><a href="https://github.com/swcarpentry/r-novice-inflammation/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.17.1" class="external-link">sandpaper (0.17.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.7" class="external-link">varnish (1.0.7)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://swcarpentry.github.io/r-novice-inflammation/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://swcarpentry.github.io/r-novice-inflammation/instructor/aio.html",
  "identifier": "https://swcarpentry.github.io/r-novice-inflammation/instructor/aio.html",
  "dateCreated": "2014-12-18",
  "dateModified": "2025-08-26",
  "datePublished": "2025-08-26"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

